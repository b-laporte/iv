!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};function t(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function a(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var s="ΔTrackable",c="ΔChangeVersion",d="ΔFactory",l="ΔDefFactories",u="ΔIsFactory",p="ΔΔProxy",f="ΔIsProxy",h="ΔDefault",v="ΔCreateProxy",m="ΔnewItem",g="Δdispose",b="Δjson",y=!1;function x(e){return e&&e.ΔTrackable?e.ΔMd?e.ΔMd:e.ΔMd={parents:void 0,refreshCtxt:void 0,watchers:void 0}:null}var N=Array.isArray;function w(e,t){e&&(N(e)&&!e[f]?e.forEach(t):t(e))}function k(e,t){if(e&&t){if(e===t)return;if(N(e)){var n=e;if(1===n.length){if(n[0]===t)return}else{var r=n.indexOf(t);if(r>-1)return n.splice(r,1),1===n.length?n[0]:n}}}return e}function I(e,t){return e?N(e)&&!e[f]?(e.push(t),e):[e,t]:t}function C(e){return e&&!0===e[s]?e[c]:0}function P(e,t){if(void 0===t&&(t=!1),j(e)){e[g]?e[g](t):V(e,(function(n,r){Y(e,r),e["ΔΔ"+n]=void 0,t&&P(r,!0)}));var n=e.ΔMd;if(n){var r=[];w(n.parents,(function(e){r.push(e)}));for(var i=function(t){V(t,(function(n,r){r===e&&(Y(t,e),t["ΔΔ"+n]=void 0)})),q(t)},o=0,a=r;o<a.length;o++){i(a[o])}}}}function V(e,t){if(j(e)){var n=e.constructor.prototype["ΔDefFactories"];for(var r in n)n.hasOwnProperty(r)&&t(r,e["ΔΔ"+r],n[r])}}function $(e,t){return!(!e||"object"!=typeof e)&&"ΔΔ"+t in e}function j(e){return!(!e||!0!==e[s])}function D(e){return C(e)%2==1}function O(e,t){var n=x(e);return n&&t?(n.watchers=I(n.watchers,t),D(e)&&ne.register(e),t):null}function E(e,t){var n=e?e.ΔMd:void 0;n&&t&&(n.watchers=k(n.watchers,t))}function A(e,t){if(e&&void 0!==t){if(e[m])return e[m](t);y=!0;var n=e[t];return y=!1,n}}function S(e,t){if(e&&t){var n=e[h];if(n){var r=n(t);if(r!==T)return e[t]=r}var i=e[l],o=i?i[t]:null;if(o)return e[t]=o()}}var F=function(){var e,t,n=[],r=[],i={getDefaultConversion:function(){return o(e,i)},getPreviousConversion:function(){return e.ΔtoJsResult}};function o(e,n){var r=n.getPreviousConversion();if(r)return r;var i=void 0;if(e.Δconvert)i=e.Δconvert(t);else{if(e["Δjson"])return e["Δjson"];i={},V(e,(function(e,n){j(n)&&(n=a(n,t)),void 0!==n&&(i[e]=n)}))}return i}function a(a,s){var c=0===n.length,d=a;if(a&&j(a)&&(n.push(a),d=void 0,r.push(a),e=a,s?(t=s,d=s(a,i)):d=o(a,i),a.ΔtoJsResult=d,r.pop(),e=r[r.length-1]),c){for(var l=n.length;l--;)n[l]["ΔtoJsResult"]=void 0;e=null,n=[],t=void 0}return d}return a}();function R(e){var t=e.prototype;t[s]=!0,t[c]=0}function L(e,t){return e||(e=K,t=3),function(n,r){var i="ΔΔ"+r,o=n[l];o||(o=n[l]={}),o[r]=t?1===t?K:U:e,n[i]=void 0,function(e,t,n,r){r&&delete e[t]&&Object.defineProperty(e,t,r)}(n,r,0,{get:function(){return function(e,t,n,r,i){e.ΔComputeDependencies&&(e.ΔComputeDependencies[n]=!0);!y&&e[b]&&function(e,t){var n,r;t&&V(e,(function(i,o,a){var s=a===W;if(n=t[i],r="ΔΔ"+i,void 0===n)s&&(e[r]=void 0);else{var c=typeof n;if(null===n)(s||a===J)&&(e[r]=null);else if("object"===c){var d=A(e,i);d?d[b]=n:s&&(e[r]=n)}else"string"===c?(s||a===M)&&(e[r]=n):"number"===c?(s||a===H)&&(e[r]=n):"boolean"===c?(s||a===z)&&(e[r]=n):s&&(e[r]=n)}})),e[b]=void 0}(e,e[b]);var o=e[t];(void 0===o||y&&null===o)&&(o=e[t]=!y&&i?i>1?void 0:null:r(),G(e,o));return o}(this,i,r,e,t)},set:function(t){Z(this,r,i,t,e,this)},enumerable:!0,configurable:!0})}}var T={};function _(){return""}_[u]=!0;var M=_;function B(){return 0}B[u]=!0;var H=B;function X(){return!1}X[u]=!0;var z=X;function K(){return null}K[u]=!0;var J=K;function U(){}U[u]=!0;var W=U;function Z(e,t,n,r,i,o){var a=j(r),s=i===W;if(!e.ΔComputeDependencies){r&&!a&&i.ΔCreateProxy&&(a=j(r=i.ΔCreateProxy(r)||r));var c=!1,d=o[n];return D(e)?c=d!==r:d!==r&&(q(e),c=!0),c&&(a&&void 0===r&&(r=null),(a||d&&j(d))&&function(e,t,n,r){Y(e,t),r||G(e,n)}(e,d,r,s),o[n]=r,function(e,t,n,r,i){var o=e?e.ΔMd:void 0;if(o&&o.trackers){var a=e[p]||e;w(o.trackers,(function(e){e(a,t,n,r,i)}))}}(e,"set",t,d,r)),r}console.error("[Trax] @computed properties must not mutate the Data object when calculated")}function q(e){if(j(e)){var t=!0;if(D(e)?t=!1:e.ΔChangeVersion+=1,ne.register(e),t){var n=e.ΔMd;n&&n.parents&&w(n.parents,(function(e){q(e)}))}}}function Y(e,t){if(t){var n=t.ΔMd;n&&n.parents&&(n.parents=k(n.parents,e))}}function G(e,t){if(t){var n=x(t);n&&(n.parents=I(n.parents,e))}}var Q=0,ee=function(){function e(){this.id=++Q}return e.prototype.register=function(e){var t=this,n=x(e);n&&!n.refreshCtxt&&(this.objects?this.objects.push(e):(this.objects=[e],Promise.resolve().then((function(){t.refresh()}))),n.refreshCtxt=this)},e.prototype.refresh=function(e){void 0===e&&(e=!0);var t=this.objects,n=t?t.length:0;if(n){re();for(var r,i,o=[],a=0;n>a;a++)(i=(r=t[a]).ΔMd).refreshCtxt&&(r.ΔChangeVersion%2&&(r.ΔChangeVersion+=1),i.refreshCtxt&&i.watchers&&o.push({dataNode:r,watchers:i.watchers})),i.refreshCtxt=void 0;this.objects=void 0,o.length&&(e?te(o):Promise.resolve().then((function(){te(o)})))}},e}();function te(e){for(var t=function(e){w(e.watchers,(function(t){t(e.dataNode)}))},n=0,r=e;n<r.length;n++){t(r[n])}}var ne=new ee;function re(){ne.objects&&(ne=new ee)}var ie=/^\Δ/,oe=function(){function e(e){this.ΔTrackable=!0,this.ΔDataFactory=!0,this.ΔChangeVersion=0,this.ΔMd=void 0,this.ΔΔSelf=this,this.ΔIsProxy=!1,this.ΔItemFactory=e}return e.ΔNewProxy=function(t){var n=new Proxy({},new e(t));return n[p]=n,n},e.ΔCreateProxy=function(t,n){if("object"==typeof t){var r=new Proxy(t,new e(n));for(var i in q(r),t)t.hasOwnProperty(i)&&G(r,t[i]);return r}return null},e.prototype.ΔnewItem=function(e){var t=this.ΔItemFactory();return Z(this.ΔΔSelf,e,e,t,this.ΔItemFactory,this.ΔΔDict)},e.prototype.Δdispose=function(e){void 0===e&&(e=!1);var t,n=this.ΔΔDict;for(var r in n)n.hasOwnProperty(r)&&(t=n[r],Y(this.ΔΔSelf,t),n[r]=void 0,e&&P(t,!0));return n},e.prototype.Δconvert=function(e){var t={},n=this.ΔΔDict;for(var r in n)n.hasOwnProperty(r)&&(t[r]=F(n[r],e));return t},e.prototype.ΔinitFromJson=function(){var e=this["Δjson"];if(e){if(e.constructor!==Object)console.error("[Trax] Invalid json type: Dictionaries can only be initialized from Objects");else{var t=this.ΔΔDict,n=void 0,r=void 0;for(var i in e)if(e.hasOwnProperty(i))if(r=n=e[i],n){var o=this.ΔItemFactory();j(o)&&(o["Δjson"]=n,r=o),t[i]=r}else null===n&&(t[i]=null)}this["Δjson"]=void 0}},e.prototype.ΔToString=function(){return"Trax Dict {...}"},e.prototype.set=function(e,t,n){return this.ΔΔDict||(this.ΔΔDict=e),t.match(ie)?this[t]=n:Z(this.ΔΔSelf,t,t,n,this.ΔItemFactory,this.ΔΔDict),!0},e.prototype.get=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),t===f||(this["Δjson"]&&this.ΔinitFromJson(),t===Symbol.iterator?this.ΔΔDict[Symbol.iterator]:"string"===typeof t?t.match(ie)?this[t]:this.ΔΔDict[t]:this[t])},e.prototype.deleteProperty=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),!t.match(ie)&&(Z(this.ΔΔSelf,t,t,null,this.ΔItemFactory,this.ΔΔDict),delete this.ΔΔDict[t],!0)},e}();function ae(e){function t(){return oe.ΔNewProxy(e)}return e=e||J,t[u]=!0,t[v]=function(t){return oe.ΔCreateProxy(t,e)},t}var se=ae;var ce=0,de={log:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,arguments)},error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,arguments)}};function le(e,t){for(var n=e,r=[];n;){if(n.template){var i=n.template;r.push('\n>> Template: "'+i.templateName+'" - File: "'+i.filePath+'"')}n=n.parentView}de.error("IVY: "+t+r.join(""))}var ue=void 0,pe=11,fe="$api",he=/^ΔΔ(\w+)Emitter$/,ve=/^ΔΔ/,me=/^ΔΔ(.+)$/,ge=/([^ ]+)\s([^ ]+)/,be="ΔIsAPI",ye="ΔIsController",xe="ΔDefaultParam",Ne="ΔIoParams",we="ΔRequiredProps",ke={$targetApi:"$1 cannot be used on DOM nodes",$targetElt:"$1 cannot be used on components that don't define #main elements"},Ie=0,Ce=function(){function e(e,t,n,r,i,o){this.templateName=e,this.filePath=t,this.staticCache=n,this.renderFn=r,this.$Class=i,this.$contextIdentifiers=o,this.kind="$template",this._uid=++Ie,this.tplApi=void 0,this.tplCtl=void 0,this.forceRefresh=!1,this.activeWatch=!1,this.lastRefreshVersion=0,this.processing=!1,this.rendering=!1,this.initialized=!1,this.labels=void 0,this.hasCtlClass=!1,this.$contextInitialized=!1,this.view=De(null,null,1,this);var a=this;this.watchCb=function(){a.notifyChange()},this.watchCb.$templateId=this._uid,this.$Class!==ue&&(Ot(this.$Class,ye)?this.hasCtlClass=!0:Ot(this.$Class,be)||j(this.$Class.prototype)||le(this.view,"Type of $ argument must be either a @Controller, an @API or a @Data class"))}return e.prototype.dispose=function(e){void 0===e&&(e=!0);var t=this.view;this.disconnectObserver(),Ve(t,this.tplCtl,"$dispose",this.templateName),e&&t&&t.nodes&&t.nodes.length&&(xt(t,t.nodes[0]),t.anchorNode&&(t.rootDomNode.removeChild(t.anchorNode),t.anchorNode=null))},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.view.doc},set:function(e){this.view.doc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){if(!this.tplApi)if(this.hasCtlClass){var e=this.controller;e&&e.$api&&(this.tplApi=e.$api)}else this.$Class?(this.tplApi=new this.$Class,Pe(this.view,this.tplApi,this.staticCache)):this.$contextIdentifiers?this.tplApi=function(e){return void 0!==e?(t[u]=!0,ae(t)()):ae()();function t(){return new e}}():this.tplApi={};return this.tplApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){if(!this.tplCtl&&this.hasCtlClass){var e=this.tplCtl=new this.$Class;if($(e,"$template")&&(e.$template=this),$(e,"$logger")){var t=this.view;e.$logger={log:de.log,error:function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];le(t,e+(n.length?" "+n.join(" "):""))}}}e[fe]&&Pe(this.view,e[fe],this.staticCache)}return this.tplCtl},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){if(this.view.rootDomNode)le(this.view,"Template host cannot be changed once set");else{var t=this.view;if(!t.doc)throw new Error("[iv] Template.document must be defined before calling Template.attach()");t.rootDomNode=e,t.anchorNode=t.doc.createComment("template anchor"),Lt(t.anchorNode,e)}return this},e.prototype.registerLabel=function(e,t){this.labels||(this.labels={});var n=this.labels[e];n?n.push(t):n=this.labels[e]=[t]},e.prototype.query=function(e,t){if(void 0===t&&(t=!1),this.rendering)return null;for(var n=[],r=0,i=e.split(";");r<i.length;r++){var o=i[r];if(o&&"#"!==o.charAt(0))return le(this.view,"[$template.query()] Invalid label argument: '"+o+"' (labels must start with #)"),null;var a=this.labels&&this.labels[o]||null;if(a&&a.length){if(!t)return a[0];n=n.concat(a)}}return n.length?n:null},e.prototype.notifyChange=function(){this.render()},e.prototype.disconnectObserver=function(){this.activeWatch&&(E(this.api,this.watchCb),E(this.controller,this.watchCb),this.activeWatch=!1)},e.prototype.render=function(e,t){if(void 0===t&&(t=!1),this.processing)return this;t&&(this.forceRefresh=!0),this.processing=!0;var n=this.api,r=this.controller,i=this.view,o=this.$contextIdentifiers;r&&!j(r)&&(le(i,"Template controller must be a @Controller Object - please check: "+this.$Class.name),this.tplCtl=this.$Class=void 0);var a=!1;if(n&&e)if(o!==ue){var s=e.context;s!==ue&&"object"==typeof s&&(a=!0)}else for(var c in D(n)||re(),this.disconnectObserver(),e)e.hasOwnProperty(c)&&(n[c]=e[c]);if(this.$contextInitialized&&(a=!0),a){var d="",l=(e?e.context:null)||n.$context;if(l){for(var u=0;o.length>u;u++)n[d=o[u]]=l[d];n.$context=l,this.$contextInitialized=!0}}o===ue||this.$contextInitialized||le(i,"Missing $fragment context");var p=!this.forceRefresh,f=i.nodes;if(f&&f[0]&&f[0].attached||(p=!1),p&&C(n)+C(r)>this.lastRefreshVersion&&(p=!1),!p){r&&(this.initialized||(Ve(i,r,"$init","controller"),this.initialized=!0),Ve(i,r,"$beforeRender","controller")),this.rendering=!0,this.labels=void 0,i.lastRefresh++,i.instructions=void 0;try{this.renderFn(i,this.hasCtlClass?r:n,n,this)}catch(e){le(i,"Template execution error\n"+(e.message||e))}this.rendering=!1,r&&Ve(i,r,"$afterRender","controller"),function(e,t){if(void 0===t&&(t=!1),e){var n=e.ΔMd;n&&n.refreshCtxt?n.refreshCtxt.refresh(!0):t&&re()}}(n),this.forceRefresh=!1,this.lastRefreshVersion=C(n)+C(r)}return this.activeWatch||(O(n,this.watchCb),r&&O(r,this.watchCb),this.activeWatch=!0),this.processing=!1,this},e}();function Pe(e,t,n){var r=n.events;if(void 0===r){var i=void 0;for(var o in t)if(o.match(he)){var a=RegExp.$1;i||(i=[]),"function"!=typeof t[a+"Emitter"].init?le(e,"Invalid EventEmitter: "+a+"Emitter"):(i.push(a+"Emitter"),i.push(a),t[a+"Emitter"].init(a,t))}n.events=i||null}else if(null!==r)for(var s=r.length,c=0;s>c;c+=2)t[r[c]].init(r[c+1],t)}function Ve(e,t,n,r){if(t&&"function"==typeof t[n]){var i=void 0;try{void 0!==(i=t[n]())&&"function"==typeof i.catch&&i.catch((function(t){le(e,r+" "+n+" hook execution error\n"+(t.message||t))}))}catch(t){le(e,r+" "+n+" hook execution error\n"+(t.message||t))}}}function $e(e,t){return(t=t||this.namespace)?this.doc.createElementNS(t,e):this.doc.createElement(e)}function je(){return function(e){if(e!==ue&&null!==e){var t=!0;return _t(e,!1,(function(e){if(!t)return!1;var n=e.kind;if("#view"===n){var r=e;if(r.cm){var i=r.doc.createDocumentFragment();r.domNode=i,r.cmAppends=[function(e){e.domNode?Lt(e.domNode,i):e.domNode=i}]}Be(r)}else if("#element"===n||"#text"===n)return t=!1;return!0})),t}return!0}(this)}function De(e,t,n,r){var i={kind:"#view",uid:"view"+ ++ce,attached:!1,nodes:null,namespace:void 0,namespaces:void 0,doc:null,parentView:e,cm:!0,cmAppends:null,lastRefresh:0,container:null,projectionHost:null,template:r,rootDomNode:null,anchorNode:null,expressions:void 0,oExpressions:void 0,instructions:void 0,paramNode:void 0,createElement:$e,isEmpty:je};return e?Se(i,e,t):i.doc="undefined"!=typeof document?document:null,i}function Oe(e,t,n){if(n){var r=Ae(e);if(r!==ue&&null!==r)for(var i=r.template,o=n.length,a=0;o>a;a++)i.registerLabel(n[a],t)}}function Ee(e,t,n){if(0!==n){var r=Ae(e);r!==ue&&null!==r&&r.template.registerLabel(n,t)}}function Ae(e){for(var t=e;t&&!t.template;)t=t.parentView;return t}function Se(e,t,n){if(e.parentView=t,e.doc=t.doc,e.container=n,e.rootDomNode=t.rootDomNode,t.namespace){var r=t.namespace;e.namespace=r,e.namespaces=[r]}}function Fe(e,t,n,r,i,o){return function(){return new Ce(e,t,n,r,i,o)}}var Re=[];function Le(e,t,n){var r=e.cm;return r?(e.nodes=new Array(n),e.cmAppends||(e.cmAppends=[],e.anchorNode&&(e.cmAppends[0]=function(t,n){t.domNode?Tt(t.domNode,e.anchorNode,e.rootDomNode):t.domNode=e.rootDomNode}))):e.cmAppends=null,r}function Te(e,t,n,r,i){var o,a=e.nodes[n];if(a&&a.attached||le(e,"Invalid ζview call: container must be attached ("+(a?a.uid:"XX")+") - pview: "+e.uid+" containerIdx: "+n),"#container"===a.kind)if("##block"===a.subKind){var s=(c=a).views;1===i&&(c.insertFn=null),1===i&&c.views.length>1?(c.previousNbrOfViews=s.length,o=s.shift(),c.viewPool.length?c.viewPool=s.concat(c.viewPool):c.viewPool=s,c.views=[o]):(o=c.views[i-1])||(c.viewPool.length>0?(c.insertFn||(c.insertFn=He(e,c)),ze((o=s[i-1]=c.viewPool.shift()).nodes[0],c.insertFn),o.attached=!0):((o=s[i-1]=De(e,c)).nodes=new Array(r),e.cm&&c.cmAppend?o.cmAppends=[c.cmAppend]:e.cm||(o.cmAppends=[He(e,c)]))),c.lastRefresh=o.lastRefresh=e.lastRefresh}else{var c;(o=(c=a).contentView)||((o=c.contentView=De(e,c)).nodes=new Array(r)),o.lastRefresh=e.lastRefresh}else if("#param"===a.kind){var d=a;(o=d.contentView)||(o=d.contentView=De(e,null),d.viewPool&&(d.viewPool[d.viewInstanceIdx]=o),o.nodes=new Array(r),o.paramNode=d),o.lastRefresh=e.lastRefresh}return o}function _e(e,t,n){var r=t.nodes[n];"#container"===r.kind&&!e.cmAppends&&r.cmAppend&&(e.cmAppends=[r.cmAppend])}function Me(e,t,n){e.instructions.push(t),e.instructions.push(n)}function Be(e){if(e.instructions){var t=e.instructions.slice(0),n=t.length;if(e.instructions.splice(0,n),e.instructions=void 0,n)for(var r=0;n>r;r+=2)t[r].apply(null,t[r+1])}}function He(e,t){var n=function e(t,n){for(;;){if(n||le(t,"Internal error - findNextSiblingDomNd: nd cannot be undefined"),0===n.idx){if(!n.attached)return{position:"defer",parentDomNd:void 0};if(n.domNode.nodeType===pe)return{position:"lastChild",parentDomNd:n.domNode};var r=t.parentView;if(r){if(t.projectionHost){var i=t.projectionHost.hostNode;return"#element"===i.kind?{position:"lastChild",parentDomNd:i.domNode}:e(t.projectionHost.view,i)}if(t.container&&"##block"===t.container.subKind){var o=t.container,a=o.views.indexOf(t);if(a>-1)for(var s=void 0,c=void 0,d=a+1;d<o.views.length;d++)if((s=o.views[d]).nodes&&s.nodes.length&&(c=m(s,s.nodes[0],o.domNode)))return c;for(var l=o.viewPool,u=void 0,p=0,f=l;p<f.length;p++){if((s=f[p]).nodes&&s.nodes.length&&s.attached&&(u=m(s,s.nodes[0],o.domNode)))return u}}return e(r,t.container)}return{position:"lastOnRoot",parentDomNd:t.rootDomNode,nextDomNd:t.anchorNode}}if(!n.nextSibling){var h=t.nodes[n.parentIdx];return"#element"===h.kind?{position:"lastChild",parentDomNd:yt(t,n)}:e(t,h)}var v=m(t,n.nextSibling,yt(t,n));if(v)return v;n=n.nextSibling}function m(e,t,n){if(!t)return null;if("#element"===t.kind||"#text"===t.kind)return{position:"beforeChild",nextDomNd:t.domNode,parentDomNd:n};if("#fragment"===t.kind){for(var r=void 0,i=t.firstChild;i;){if(r=m(e,i,n))return r;i=i.nextSibling}if(t.contentView){var o=t.contentView;if(o.nodes)return m(o,o.nodes[0],n)}return null}if("#container"===t.kind){var a=t;r=null;if("##block"===a.subKind)for(var s=a.views,c=s.length,d=0;c>d&&!(r=m(s[d],s[d].nodes[0],n));d++);else if("##cpt"===a.subKind){var l=a.template.view;r=m(l,l.nodes[0],n)}return r||null}throw new Error("TODO findFirstDomNd: "+t.kind)}}(e,t),r=n.position,i=n.nextDomNd,o=n.parentDomNd;return"beforeChild"===r||"lastOnRoot"===r?function(e,t){e.domNode?Tt(e.domNode,i,o):e.domNode=o}:"lastChild"===r?function(e,t){e.domNode?Lt(e.domNode,o):e.domNode=o}:function(){console.warn("TODO: VALIDATE VIEW APPEND: ",r),function(e,t,n){void 0===t&&(t="");n&&e.uid!==n||(console.log(""),console.log(Mt),t&&console.log(t+":"),function e(t,n){void 0===n&&(n="");if(!t.nodes)return void console.log(""+n+t.uid+" - no nodes");var r=t.parentView?t.parentView.uid:"XX",i=t.projectionHost,o=i?" >>> projection host: "+i.hostNode.uid+" in "+i.view.uid:"";console.log(n+"*"+t.uid+"* cm:"+t.cm+" isTemplate:"+(void 0!==t.template)+" parentView:"+r+o);for(var a,s=t.nodes.length,c="",d=0;s>d;d++)if(a=t.nodes[d])if(c=a.uid.length<5?["     ","    ","   ","  "," "][a.uid.length]:"","#container"===a.kind){var l=a,u=l.domNode?l.domNode.uid:"XX";if(console.log(n+"["+d+"] "+a.uid+c+" "+u+" attached:"+(a.attached?1:0)+" parent:"+k(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")),"##block"===l.subKind){var p=l,f=p.views.length;if(f)for(var h=0;f>h;h++)if(p.views[h]){var v=p.views[h];u=v.rootDomNode?v.rootDomNode.$uid:"XX",console.log(n+"  - view #"+h),e(p.views[h],"    "+n)}else console.log(n+"  - view #"+h+" UNDEFINED");else console.log(n+"  - no child views")}else if("##cpt"===l.subKind){var m=l,g=m.template,b=m.contentView;b?(console.log(n+"  - light DOM:"),e(b,"    "+n)):console.log(n+"  - light DOM: none"),g?(console.log(n+"  - shadow DOM:"),e(g.view,"    "+n)):console.log(n+"  - no template")}else console.log(n+"  - "+l.subKind+" container")}else{u=a.domNode?a.domNode.uid:"XX";var y="";if(a.domNode&&"#text"===a.kind)y=" text=#"+a.domNode._textContent+"#";else if("#fragment"===a.kind||"#element"===a.kind){for(var x=[],N=a.firstChild;N;)x.push(N.uid),N=N.nextSibling;y=" children:["+x.join(", ")+"]";var w=a.contentView;w&&(y+=" >>> content view: "+w.uid)}console.log(n+"["+a.idx+"] "+a.uid+c+" "+u+" attached:"+(a.attached?1:0)+" parent:"+k(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")+y)}else console.log(n+"["+d+"] XX");function k(e){return e<0?"X":e}}(e))}(e,"getViewInsertFunction for "+t.uid)}}function Xe(e,t,n){var r=e.nodes[t];if(r&&"##block"===r.subKind){var i=r,o=i.lastRefresh;if(n||o===e.lastRefresh){var a=i.views.length;if(!n){if(a!==i.previousNbrOfViews)for(var s=i.viewPool,c=s.length,d=void 0,l=0;c>l;l++)xt(d=s[l],d.nodes[0]),d.attached=!1;i.previousNbrOfViews=a}}else xt(e,i)}}function ze(e,t,n){if(!e.attached){if(t(e,!0),e.attached=!0,"#fragment"===e.kind)for(var r=e.firstChild;r;)ze(r,t),r=r.nextSibling;else if("#container"===e.kind){var i=e.subKind;if("##cpt"===i){var o=e.template,a=o?o.view.nodes[0]:null;o&&(o.forceRefresh=!0),a&&(ze(a,t),o.view.attached=!0)}else if("##block"===i)for(var s=e.views,c=0;s.length>c;c++)ze(s[c].nodes[0],t),s[c].attached=!0}if("#fragment"===e.kind||"#element"===e.kind){var d=e.contentView;d&&(ze(d.nodes[0],t),d.attached=!0)}}}function Ke(e,t,n){if(n)for(var r=n.length,i=0;r>i;i++)Xe(e,n[i],e.cm);e.cm&&(e.cm=!1,e.cmAppends=null)}function Je(e,t,n,r,i,o,a,s,c){if(t){var d=e.createElement(i);if(s)for(var l=s.length,u=0;l>u;u+=2)d.setAttribute(s[u],s[u+1]);if(c){l=c.length;for(var p=0;l>p;p+=2)d[c[p]]=c[p+1]}var f={kind:"#element",uid:"elt"+ ++ce,idx:n,parentIdx:-1,ns:"",domNode:d,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=f,Oe(e,d,a),e.cmAppends[r](f,!1),o&&(e.cmAppends[r+1]=function(e,t){e.domNode?Lt(e.domNode,d):e.domNode=d,t||We(f,e)})}else a&&Oe(e,e.nodes[n].domNode,a)}function Ue(e,t,n){if(n)e.namespaces?e.namespaces.push(n):e.namespaces=[n],e.namespace=n;else{var r=e.namespaces.length;1===r?e.namespace=e.namespaces=void 0:(e.namespaces.pop(),e.namespace=e.namespaces[r-2])}}function We(e,t){e.firstChild?(e.lastChild.nextSibling=t,e.lastChild=t):(e.firstChild=e.lastChild=t,t.nextSibling=void 0),t.parentIdx=e.idx}function Ze(e,t,n,r,i,o,a,s){for(var c,d=[],l=8;l<arguments.length;l++)d[l-8]=arguments[l];if(s){var u=void 0,p=void 0,f=!1;u=t?a.slice(0):(c=e.nodes[r]).pieces;for(var h=0;s>h;h++)(p=Ye(e,n,d[h]))!==Re&&(f=!0,u[1+2*h]=null==p?"":p);if(!t)return f&&(c.domNode.textContent=u.join("")),void Oe(e,c.domNode,o);c=v(e.doc.createTextNode(u.join("")),u),Oe(e,c.domNode,o)}else{if(!t)return void(o&&Oe(e,e.nodes[r].domNode,o));c=v(e.doc.createTextNode(a),void 0),Oe(e,c.domNode,o)}function v(e,t){return{kind:"#text",uid:"txt"+ ++ce,domNode:e,attached:!0,idx:r,parentIdx:-1,pieces:t,nextSibling:void 0}}e.nodes[r]=c,e.cmAppends[i](c,!1)}function qe(e,t,n){if(e.expressions){var r=e.expressions;if(r.length>t&&r[t]===n)return Re;r[t]=n}else e.expressions=[],e.expressions[t]=n;return n}function Ye(e,t,n){if(t){if(n[2]){var r=e.oExpressions;return r[2*n[0]]?Re:(r[2*n[0]]=1,n[1])}return qe(e,n[0],n[1])}return n}function Ge(e,t,n,r){if(t){var i={kind:"#fragment",uid:"fra"+ ++ce,idx:n,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=i;var o=e.cmAppends[r];o(i,!1),e.cmAppends[r+1]=function(e,t){o(e,!0),t||We(i,e)}}}function Qe(e,t,n,r,i){if(t){var o=et(n,null,i);return e.nodes[n]=o,tt(e,o,r),o}}function et(e,t,n){var r;if(1===n)r={kind:"#container",subKind:"##block",uid:"cnb"+ ++ce,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,views:[],viewPool:[],cmAppend:t,lastRefresh:0,previousNbrOfViews:0,insertFn:null};else{if(2!==n)return console.warn("TODO: new cnt type"),null;r={kind:"#container",subKind:"##cpt",uid:"cnc"+ ++ce,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,cmAppend:t,cptRef:null,template:null,data:null,contentView:null,dynamicParams:void 0}}return r}function tt(e,t,n){if(e.cmAppends){var r=e.cmAppends[n];r?(t.cmAppend=function(e,t){r(e,!0)},r(t,!1)):console.log("ERROR?",r===ue)}}function nt(e,t,n,r,i,o,a,s,c,d){var l;n=n||0,t?l=e.nodes[r]||Qe(e,t,r,i,2):(l=e.nodes[r]).lists&&(l.lists.sizes={});var u=Ye(e,n,o);if(l.template){if(u!==Re&&l.cptRef!==u){var p=l.data;l.template.dispose(!0),m();var f=l.data;for(var h in p)if(p.hasOwnProperty(h)&&h.match(me)){var v=RegExp.$1;$(f,v)&&(f[v]=p[v])}}}else{if(u===Re)return void le(e,"Invalid component ref");m()}function m(){var t=l.template=u();l.cptRef=u,Se(t.view,e,l),t.disconnectObserver(),l.data=t.api,function(t){if(c){var n=c.length;if(!t&&n)le(e,"Invalid parameter: "+c[0]);else for(var r=0;n>r;r+=2)$(t,c[r])?t[c[r]]=c[r+1]:le(e,"Invalid parameter: "+c[r])}}(t.api)}d&&(l.dynamicParams={}),0===n&&a&&rt(e,r,l,s,d)}function rt(e,t,n,r,i){var o=(n=n||e.nodes[t])?n.template:void 0;if(void 0!==o){if(o.view.lastRefresh=e.lastRefresh-1,it(n),n.contentView){o.api.$content=n.contentView;var a=n.contentView.instructions;a&&a.length&&(o.forceRefresh=!0)}if(o.view.cm)o.view.cmAppends=[n.cmAppend];else{if(i)for(var s=i.length,c=(n?n.dynamicParams:{})||{},d=o.api,l=0;s>l;l++)c[i[l]]||S(d,i[l]);var u=o.view.nodes[0];if(!u.attached)o.forceRefresh=!0,ze(u,He(e,n))}r&&Oe(e,o.api,r),o.render()}}function it(e){if(e.lists)for(var t=e.lists,n=t.listNames,r=void 0,i=void 0,o=void 0,a=void 0,s=0;n.length>s;s++)r=n[s],(i=t.sizes[r]||0)<(a=(o=e.data[r]).length)&&o.splice(i,a-i)}function ot(e,t,n,r,i){if(i!==Re){var o=Ye(e,t,i);if(o!==Re){var a=e.nodes[n].domNode;void 0===o?a.removeAttribute(r):a.setAttribute(r,o)}}}function at(e,t,n,r,i){if(i!==Re){var o=Ye(e,t,i);o!==Re&&(e.nodes[n].domNode[r]=o)}}function st(e,t,n,r,i,o){if(o!==Re){var a=Ye(e,n,o);if(a!==Re){var s=e.nodes[r],c=s.kind;if("#container"===c){var d=s.data;ct(e,t,s,d,i)&&(d[i]=a)}else if("#param"===c)dt(e,t,s,a,i);else if("#decorator"===c){var l=s;t&&!ft(e,l,i)||(l.api[i]=a)}}}}function ct(e,t,n,r,i){if(r&&(!e.cm||$(r,i)))return!0;var o="";return n.template&&(o=" on <*"+n.template.templateName+"/>"),le(e,"Invalid parameter '"+i+"'"+o),!1}function dt(e,t,n,r,i){if(0===i){if(n.dataHolder)return n.dataHolder[n.dataName]=r,n.dataHolder}else{if(n.data)return t&&!$(n.data,i)&&le(e,"Invalid param node parameter: "+i),n.data[i]=r,n.data;le(e,"Invalid param node parameter: "+i)}return null}function lt(e,t,n,r,i,o,a,s){var c,d=e.nodes[r],l=d.kind,u=ue;if(a!==ue&&s!==ue&&null!==a&&"object"==typeof a&&(t&&"string"==typeof s&&j(a)&&!$(a,s)&&le(e,"Invalid property: '"+s+"'"),u=a[s]),"#container"===l)ct(e,0,d,c=d.data,o)&&(t&&Rt(e,c,o),c[o]=u);else if("#param"===l)if(0===o){var p=d;p.dataHolder&&(p.dataHolder[p.dataName]=u,c=p.dataHolder,o=p.dataName,t&&Rt(e,c,o,"."+o,!1,!0))}else c=dt(e,t,d,u,o),t&&Rt(e,c,o,"."+d.dataName);else if("#decorator"===l){var f=d;c=f.api,0===o?(o=ht(e,f,u),t&&o&&Rt(e,c,o,f.refName,!0)):t&&!ft(e,f,o)||(t&&Rt(e,c,o,f.refName),c[o]=u)}var h=d.bindings;if(h===ue&&(h=d.bindings=[]),h[i]===ue){if(c){var v={propertyHolder:a,propertyName:s,watchFn:O(c,(function(){var e=c[o],t=v.propertyHolder;if(t!==ue&&null!==t&&v.propertyName!==ue&&t[v.propertyName]!==e){var n=C(t);0===n||n%2==1?Promise.resolve().then((function(){t[v.propertyName]=e})):t[v.propertyName]=e}}))};h[i]=v}}else{var m=h[i];m.propertyHolder=a,m.propertyName=s}}function ut(e,t,n,r,i){if(i&&e.nodes){var o=e.nodes[n];if("#container"===o.kind&&"##cpt"===o.subKind){var a=o.template;a&&Ee(e,a.api,r)}else o.domNode?Ee(e,o.domNode,r):"#decorator"===o.kind&&Ee(e,o.api,r)}}function pt(e,t,n,r,i,o,a,s,c,d,l){var u;if(t){var p=e.nodes;if(void 0===a)le(e,"Undefined decorator reference: @"+o);else if("function"!=typeof a&&!0!==a.$isDecorator)le(e,"Invalid decorator reference: @"+o);else{var f=new a.$apiClass,h=a(f);if(u={kind:"#decorator",uid:"deco"+ ++ce,idx:r,parentIdx:i,attached:!0,nextSibling:void 0,domNode:void 0,instance:h,api:f,refName:"@"+o,validProps:!0},p[r]=u,d)for(var v=d.length,m=0;v>m;m+=2)ft(e,u,d[m]),f[d[m]]=d[m+1]}}else u=e.nodes[r];if(u!==ue){f=u.api;1===s&&ht(e,u,c),Oe(e,f,l)}}function ft(e,t,n){return!!$(t.api,n)||(le(e,"Invalid decorator parameter '"+n+"' on "+t.refName),!1)}function ht(e,t,n){var r=t.api,i=r[xe];return i===ue?(le(e,t.refName+" doesn't define any default parameter"),""):(r[i]=n,i)}function vt(e,t,n){if(t){var r=n.api,i=e.nodes[n.parentIdx],o=null,a=null;if(void 0===i.kind)o=i;else if("#element"===i.kind)o=i.domNode;else if("#container"===i.kind&&"##cpt"===i.subKind){var s=i.template;a=s.api,o=s.query("#main")}else le(e,"Invalid decorator target for "+n.refName);null!==o&&$(r,"$targetElt")&&(r.$targetElt=o),null!==a&&$(r,"$targetApi")&&(r.$targetApi=a),n.validProps=function(e,t,n,r){if(t[we]!==ue){var i=t[we],o=void 0,a=!0;for(var s in i)if((o=t[i[s]])===ue||null===o){var c=Dt(i[s]);r!==ue&&r[c]!==ue?le(e,(n+" "+c).replace(ge,r[c])):le(e,c+" property is required for "+n),a=!1}return a}return!0}(e,n.api,n.refName,ke),n.validProps&&Ve(e,n.instance,"$init",n.refName)}n.validProps&&Ve(e,n.instance,"$render",n.refName)}function mt(e,t,n,r){var i=e.nodes[r];i!==ue&&vt(e,t,i)}function gt(e,t,n,r,i,o,a,s){if(t){var c=e.nodes[r];if("#element"===c.kind){var d=c.domNode;if(!d)return void le(e,"Cannot set "+i+" event listener: undefined DOM node");var l=f(d);a&&!1!==(s=s||{}).passive&&(s.passive=!0),d.addEventListener(i,(function(e){l.callback&&l.callback(e)}),s)}else if("#container"===c.kind){var u=c.template;u?p(u.api,!1):le(e,"Cannot set "+i+" event listener: undefined component template")}else"#param"===c.kind?p(c.data,!0):"#decorator"===c.kind&&p(c.api,!0)}else e.nodes[n].callback=o;function p(t,n){if(t&&$(t,i+"Emitter")){var r=t[i+"Emitter"];if(r.addListener&&"function"==typeof r.addListener){var o=f(null);r.addListener((function(e){o.callback&&o.callback(e)})),n&&"function"==typeof r.init&&r.init(i,t)}else le(e,"Invalid event emitter for: "+i)}else le(e,"Unsupported event: "+i)}function f(t){var i={kind:"#listener",uid:"evt"+ ++ce,idx:n,parentIdx:r,nextSibling:void 0,domNode:t,attached:!0,callback:o};return e.nodes[n]=i,i}}function bt(e,t,n,r,i){var o,a=e.nodes[n];if(1===i)if(r[ye]){if($(r,fe)){var s=r[fe];s!==ue&&(o=s.$content)}}else $(r,"$content")&&(o=r.$content);else o=Ye(e,t,r);if(o!==Re&&void 0!==r||(o=a.contentView),o){var c=o.projectionHost;if(c&&c.hostNode!==a&&xt(o,o.nodes[0]),a.contentView&&a.contentView!==o&&xt(a.contentView,a.contentView.nodes[0]),a.contentView=o,o.projectionHost={view:e,hostNode:a},o.cm)if("#element"===a.kind){var d=a.domNode;o.cmAppends=[function(e){e.domNode?Lt(e.domNode,a.domNode):e.domNode=d}]}else o.cmAppends=[He(e,a)];else{var l=void 0,u=!1;if(o.domNode!==ue&&null!==o.nodes&&o.domNode.nodeType===pe&&(Lt(o.nodes[0].domNode,a.domNode),function(e,t,n){if(!e||e.cm||!e.nodes||!e.nodes.length)return;n===ue&&(n=e.domNode);if(n===ue||t===n)return;_t(e,!0,(function(e){return"#view"!==e.kind&&"#fragment"!==e.kind&&"#container"!==e.kind||e.domNode===n&&(e.domNode=t),!0}))}(o,a.domNode),u=!0),!u){if("#element"===a.kind){var p=a.domNode;l=function(e,t){e.domNode?Lt(e.domNode,p):e.domNode=p}}else l=He(e,a);ze(o.nodes[0],l)}}o.container=a,Be(o)}}function yt(e,t){if(0===t.idx&&e.projectionHost){if(!t.attached)return null;var n=e.projectionHost.hostNode;return"#element"===n.kind?n.domNode:yt(e.projectionHost.view,n)}return 0===t.idx?e.parentView?yt(e.parentView,e.container):e.rootDomNode:e.nodes[t.parentIdx].domNode}function xt(e,t){if(t&&t.attached)if("#text"===t.kind||"#element"===t.kind){var n=yt(e,t);t.attached=!1,n?n.removeChild(t.domNode):le(e,"Internal error - parent not found for: "+t.uid)}else if("#container"===t.kind){if("##block"===t.subKind){for(var r=t,i=r.views,o=i.length,a=void 0,s=0;o>s;s++)a=i[s].nodes[0],xt(i[s],a),i[s].attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0);r.views=[],r.previousNbrOfViews=0,r.viewPool=i.concat(r.viewPool)}else if("##cpt"===t.subKind){var c=t.template;a=c.view.nodes[0];xt(c.view,a),c.view.attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0)}}else if("#fragment"===t.kind){var d=t;if(d.attached=!1,d.contentView)xt(d.contentView,d.contentView.nodes[0]);else if(d.firstChild)for(var l=d.firstChild;l;)xt(e,l),l=l.nextSibling;d.domNode=void 0}else"#param"===t.kind?console.warn("TODO removeFromDom for param nodes"):console.warn("RemoveFromDom for "+t.kind)}var Nt=R,wt=L,kt=function(e){if(!e)return K;var t=e.ΔFactory;if(t)return t;function n(){return new e}return n[u]=!0,e[d]=n,n},It=se,Ct=M,Pt=H,Vt=T,$t=W;function jt(e){e.prototype[be]=!0,R(e)}function Dt(e){return e.replace(ve,"")}function Ot(e,t){return!0===e.prototype[t]}function Et(e,t){return t.$apiClass=e,t.$isDecorator=!0,t}function At(e,t){e[xe]=Dt(t)}function St(e,t){var n=e[Ne];t="/"+Dt(t),e[Ne]=n===ue?t:n+t}function Ft(e,t){var n=e[we];n===ue&&(n=e[we]=[]),n.push(t)}function Rt(e,t,n,r,i,o){var a=t[Ne];if(a!==ue){var s="/"+n;if(a===s||a.indexOf(s)>-1)return!0}return le(e,r!==ue?i?"Invalid I/O binding expression on "+r+" (@defaultParam is not an @io param)":o?"Invalid I/O binding expression on "+r+"@paramValue (not an @io param)":"Invalid I/O binding expression on "+r+"."+n+" (not an @io param)":"Invalid I/O binding expression on '"+n+"' (not an @io param)"),!1}function Lt(e,t,n){t.appendChild(e)}function Tt(e,t,n,r){n.insertBefore(e,t)}function _t(e,t,n){if(e!==ue&&null!==e){if(!n(e))return!1;if(null!==e.nodes&&e.nodes.length)for(var r=0,i=e.nodes;r<i.length;r++){if(!o(i[r]))return!1}}return!0;function o(e){var r=e.kind;if("#fragment"===r)return!!n(e)&&_t(e.contentView,t,n);if("#container"!==r)return n(e);if(!n(e))return!1;var i=e,o=i.subKind;if("##block"===o){var a=i.views;if(null!==a)for(var s=0,c=a;s<c.length;s++){if(!_t(c[s],t,n))return!1}if(t&&i.viewPool)for(var d=0,l=i.viewPool;d<l.length;d++){if(!_t(l[d],t,n))return!1}}else if("##cpt"===o){var u=i.template;if(null!==u)return _t(u.view,t,n)}else"##async"===o&&console.log("TODO: support scanNode for @async block");return!0}}var Mt="-------------------------------------------------------------------------------";var Bt={"ζt":Fe,"ζu":Re,"ζinit":Le,"ζview":Te,"ζviewD":function(e,t,n,r,i,o){var a=o||Te(e,0,n,r,i);if(1===t)a.instructions=[];else{for(var s=a,c=t-1;c>0;)s=s.parentView,c--;s.instructions||(s.instructions=[]),a.instructions=s.instructions}return a.cm&&!a.cmAppends&&Me(a,_e,[a,e,n]),a},"ζend":Ke,"ζendD":function(e,t,n){if(e.paramNode){var r=e.paramNode;r.dataHolder?(Me(e,Ke,[e,t,n]),r.data&&"#view"!==r.data.kind?r.data?r.data.$content=e:console.warn("TODO: ζendD no data"):r.dataHolder[r.dataName]=e):le(e,"ζendD dataHoler should be defined")}else Me(e,Ke,[e,t,n])},"ζelt":Je,"ζeltD":function(e,t,n,r,i,o,a,s,c){t&&Me(e,Je,[e,t,n,r,i,o,a,s,c])},"ζxmlns":Ue,"ζxmlnsD":function(e,t,n){Me(e,Ue,[e,t,n])},"ζtxt":Ze,"ζtxtD":function(e,t,n,r,i,o,a,s){for(var c=[],d=8;d<arguments.length;d++)c[d-8]=arguments[d];for(var l=[e,t,n,r,i,o,a,s],u=0;s>u;u++)l.push(c[u]);Me(e,Ze,l)},"ζe":qe,"ζo":function(e,t,n,r){var i=e.oExpressions;if(i||(i=e.oExpressions=[]),r){if(i[2*t])return i[1+2*t];var o=[t,n,1];return i[2*t]=0,i[1+2*t]=o,o}return i[2*t]?Re:(i[2*t]=1,n)},"ζfra":Ge,"ζfraD":function(e,t,n,r){Me(e,Ge,[e,t,n,r])},"ζcnt":Qe,"ζcntD":function(e,t,n,r,i){if(t){var o=et(n,null,i);e.nodes[n]=o,Me(e,tt,[e,o,r])}},"ζcpt":nt,"ζcptD":function(e,t,n,r,i,o,a,s,c,d){nt(e,t,n,r,i,o,a,s,c,d),Me(e,tt,[e,e.nodes[r],i]),a&&Me(e,rt,[e,r,0,s,d])},"ζcall":rt,"ζcallD":function(e,t,n,r,i){Me(e,rt,[e,t,n,r,i])},"ζpnode":function(e,t,n,r,i,o,a,s,c,d){var l,u=e.nodes,p=!1;if(u[r]){var f=(l=u[r]).viewPool;a>0&&!f&&((f=l.viewPool=[])[l.viewInstanceIdx]=l.contentView),f&&(l.contentView=f[a]),l.viewInstanceIdx=a,l.dataHolder=l.data=void 0,p=!0}else l={kind:"#param",uid:"pnd"+ ++ce,idx:r,parentIdx:i,nextSibling:void 0,domNode:void 0,attached:!0,dataName:o,dataHolder:void 0,data:void 0,dataIsList:void 0,contentView:void 0,dynamicParams:void 0,viewInstanceIdx:a,viewPool:void 0},u[r]=l;d&&(l.dynamicParams={});var h,v=u[i],m=o,g=void 0,b=v.data;if(b){if(l.dataHolder=b,void 0===l.dataIsList&&function(e,t,n,r){$(r,n)?t.dataIsList=!1:$(r,n+"List")?(t.dataIsList=!0,t.dataName=n+"List"):le(e,"Invalid parameter node: <."+n+">")}(e,l,m,b),m=l.dataName,g=l.data,l.dataIsList){var y=v.lists;y||(y=v.lists={sizes:{},listNames:[],listMap:{}}),y.listMap[m]||(y.listMap[m]=1,y.listNames.push(m));var x=y.sizes[m];x||(x=y.sizes[m]=0),(h=b[m][x])||(h=A(b[m],x)),y.sizes[m]+=1,l.data=h}else l.data=h=b[m],void 0===h&&(l.data=h=A(b,m));p&&h&&h["ΔΔ$content"]&&(l.contentView=h["ΔΔ$content"])}else le(e,"Invalid parameter node <."+o+"/>: no param node can be used in this context");l.lists&&(l.lists.sizes={});var N=v.dynamicParams;if(N&&(N[m]=1),c)if(h){if(g!==h)for(var w=c.length,k=0;w>k;k+=2)t&&!$(h,c[k])&&le(e,"Invalid param node parameter: "+c[k]),h[c[k]]=c[k+1]}else le(e,"Invalid param node parameter: "+c[0])},"ζpnEnd":function(e,t,n,r,i,o){var a=e.nodes[r];if(it(a),o)for(var s=o.length,c=a.dynamicParams,d=0;s>d;d++)c&&!c[o[d]]&&S(a.data,o[d]);void 0!==a.contentView&&q(a.dataHolder)},"ζatt":ot,"ζattD":function(e,t,n,r,i){i!==Re&&Me(e,ot,[e,t,n,r,i])},"ζpro":at,"ζproD":function(e,t,n,r,i){i!==Re&&Me(e,at,[e,t,n,r,i])},"ζpar":st,"ζparD":function(e,t,n,r,i,o){if(o!==Re){var a=e.nodes[r];a!==ue&&"#param"===a.kind?st(e,t,0,r,i,o):Me(e,st,[e,t,n,r,i,o])}},"ζbind":lt,"ζbindD":function(e,t,n,r,i,o,a,s){var c=e.nodes[r];c!==ue&&"#param"===c.kind?lt(e,t,0,r,i,o,a,s):Me(e,lt,[e,t,n,r,i,o,a,s])},"ζlbl":ut,"ζlblD":function(e,t,n,r,i){i&&Me(e,ut,[e,t,n,r,1])},"ζdeco":pt,"ζdecoD":function(e,t,n,r,i,o,a,s,c,d,l){Me(e,pt,[e,t,n,r,i,o,a,s,c,d,l])},"ζdecoCall":mt,"ζdecoCallD":function(e,t,n,r){Me(e,mt,[e,t,n,r])},"ζevt":gt,"ζevtD":function(e,t,n,r,i,o,a,s){Me(e,gt,[e,t,n,r,i,o,a,s])},"ζins":bt,"ζinsD":function(e,t,n,r,i){Me(e,bt,[e,t,n,r,i])}},Ht="value",Xt="checked",zt="data",Kt=["text","radio","checkbox","number","range"],Jt={passive:!0},Ut=Et(function(){function e(){this.ΔΔevents="input",this.ΔΔdebounce=0}return e.prototype.ΔDefault=function(e){switch(e){case"events":return"input";case"debounce":return 0}return Vt},n([Ft,At,St,r("design:type",Object)],e.prototype,"ΔΔdata",void 0),n([wt(),r("design:type",Object)],e.prototype,"data",void 0),n([Ft,r("design:type",Object)],e.prototype,"ΔΔ$targetElt",void 0),n([wt(),r("design:type",Object)],e.prototype,"$targetElt",void 0),n([wt(Ct),r("design:type",String)],e.prototype,"events",void 0),n([wt($t,2),r("design:type",Object)],e.prototype,"adapter",void 0),n([wt(Pt),r("design:type",Number)],e.prototype,"debounce",void 0),e=n([jt],e)}(),(function(e){var t,n,r="",i="",o="",a={};function s(t){if("number"===r&&"input"===t.type){var i=t[zt];if("e"===i||"E"===i||"-"===i||"+"===i)return}e.debounce<=0?c():(n||(n=new Wt("@value error")),n.duration=e.debounce,n.process(c))}function c(){var n;if("text"===r||"number"===r)n=t[Ht];else if("range"===r){var i=t[Ht];if(""===i)n=0;else if(n=parseInt(i),isNaN(n))throw"Invalid input value '"+i+"': value of input type range shall be an integer"}else if("checkbox"===r)n=t[Xt];else if("radio"===r){if(!t[Xt])return;n=t[Ht]}e.data=e.adapter.value2data(n)}return{$init:function(){if("INPUT"!==(t=e.$targetElt).tagName&&"TEXTAREA"!==t.tagName&&"SELECT"!==t.tagName)throw"@value can only be used on input, textarea and select elements";if(r="text","INPUT"===t.tagName&&(r=t.getAttribute("type"),-1===Kt.indexOf(r)))throw"Invalid input type '"+r+"': @value can only be used on types '"+Kt.join("', '")+"'";t.addEventListener("change",s,Jt)},$render:function(){var n;if(void 0===(n=void 0===e.adapter?e.adapter={}:e.adapter).value2data&&(n.value2data=function(e){if("number"===r){if(""===e)return 0;try{e=parseFloat(e)}catch(e){return console.log("@value conversion error: ",e),0}}return e}),void 0===n.data2value&&(n.data2value=qt),i!==e.data){i=e.data;var c=n.data2value(i);if("text"===r||"number"===r)t[Ht]=c;else if("range"===r){if(!Number.isInteger(c))throw"Invalid input value '"+c+"': value of input type range shall be an integer";t[Ht]=""+c}else"checkbox"===r?t[Xt]=!!c:"radio"===r&&(t[Xt]=c===t[Ht])}if(o!==e.events){for(var d=e.events.split(";"),l=0,u=o.split(";");l<u.length;l++){"change"!==(h=u[l])&&(d.indexOf(h)<0&&a[h]&&(t.removeEventListener(h,s,Jt),a[h]=!1))}for(var p=0,f=d;p<f.length;p++){var h;"change"!==(h=f[p])&&(a[h]||(t.addEventListener(h,s,Jt),a[h]=!0))}o=e.events}},$dispose:function(){if(t){if(t.removeEventListener("change",s),""!==o)for(var e=0,r=o.split(";");e<r.length;e++){var i=r[e];"change"!==i&&t.removeEventListener(i,s,Jt)}o="",n=void 0}}}})),Wt=function(){function e(e){void 0===e&&(e="Error in callback"),this.errContext=e,this.timeoutId=null,this.duration=100}return e.prototype.process=function(e){var t=this;this.duration<=0?Zt(e,this.errContext):(null!==this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){t.timeoutId=null,Zt(e,t.errContext)}),this.duration))},e}();function Zt(e,t){try{e()}catch(e){throw"Debounce - "+t+"\n"+(e.message?e.message:e)}}function qt(e){return e}var Yt=void 0,Gt=/^[ \f\r\t\v]*\n(\s*)/,Qt=/^\s*else/,en=/^\$(if|for|exec|let|each|log|template)/,tn=/^\$(if|each|log)/,nn=/^[$_a-zA-Z][_a-zA-Z0-9]*(\.[$_a-zA-Z][_a-zA-Z0-9]*)*$/,rn=/^[$_a-zA-Z][_a-zA-Z0-9]*$/,on=/^(script)$/,an=/^(script|frame|frameset|iframe)$/,sn="cdata",cn="$$default",dn=sn.length,ln="</!cdata>",un=ln.length,pn=-1,fn=-2,hn=10,vn=32,mn=33,gn=34,bn=35,yn=39,xn=40,Nn=41,wn=42,kn=43,In=44,Cn=45,Pn=46,Vn=58,$n=59,jn=63,Dn=64,On=47,En=92,An=91,Sn=93,Fn=95,Rn=60,Ln=61,Tn=62,_n=123,Mn=125,Bn=36,Hn=95,Xn=105,zn=116,Kn=102,Jn=122,Un=" ".charCodeAt(0),Wn={33:mn,36:Bn,47:On,60:Rn,62:Tn,95:vn,110:hn,115:Un,122:Jn,123:_n,125:Mn};function Zn(e,t){return i(this,void 0,void 0,(function(){function n(){return r(1)}function r(t){return z=X,X=(H+=t)<B?e.charCodeAt(H):fn}function a(){return H+1<B?e.charCodeAt(H+1):fn}function s(t){return H+t>=B&&(t=B-t-1),t<1?"":e.substr(H,t)}function c(t){return X!==fn?e.substring(H).match(t):null}function d(e,t){return X!==e&&b(void 0===t?u(e)+" expected instead of "+u(X):t),n()}function l(e){var t=e.length,n=H,i=s(t);if(e===i)r(t);else{var o=i.replace(/\n/g,"\\n");""===o&&X===fn&&(o="End of Content"),b("Unexpected characters '"+o+"' instead of '"+e+"'",n)}return X}function u(e){return e===fn?"End of Content":"'"+String.fromCharCode(e)+"'"}function p(e,t){void 0===t&&(t=!0);var r=[];for(t&&r.push(e),K.push("string"),d(e);X!==e&&X!==fn;)X===En&&n(),r.push(X),n();return d(e),t&&r.push(e),K.pop(),String.fromCharCode.apply(null,r)}function f(){return X>96&&X<123||X>64&&X<91}function h(){return X>47&&X<58}function v(){return X===kn||X===Cn}function m(e){return e===vn||e>7&&e<14}function g(){if(X!==On)return!1;var e=a();if(e===On){for(l("//");hn!==X&&fn!==X;)n();return n(),!0}if(e===wn){l("/*");for(var t=!0;t;)(fn===X||wn===X&&a()===On)&&(n(),t=!1),n();return!0}return!1}function b(n,r){var i=_?"$fragment":"$template";K.length&&(i=K[K.length-1]);var o=e.split("\n"),a=0,s=0,c=0,d=o.length,l=o[d-1].length;if((r=r||H)>-1)for(;c<o.length;){if(!(s+(a=o[c].length)<r)){d=c+1,l=1+r-s;break}c++,s+=a+1}var p="";t!==Yt&&t.fileId!==Yt&&(p="\nFile: "+t.fileId);var f=d;throw t&&(f+=void 0!==t.line1?t.line1-1:0,1===d&&(l+=void 0!==t.col1?t.col1-1:0)),{kind:"#Error",origin:"XJS",description:n=n===Yt?"Invalid "+i+": Invalid character "+u(X):"Invalid "+i+": "+n,message:"XJS: "+n+"\nLine "+f+" / Col "+l+p+"\nExtract: >> "+o[d-1].trim()+" <<",file:t&&t.fileId||"",line:f,column:l,lineExtract:o[d-1].trim()}}function y(e,t){void 0===e&&(e=!1),void 0===t&&(t=!0);var r=!0,i=H;if(X!==fn)for(;r;)m(X)?(n(),g()):g()||(r=!1);return e&&i===H&&b("Invalid syntax: spaces expected instead of "+u(X),i),X===fn&&t&&!_&&b("Unexpected End of Content"),i!==H}function x(e,t){if(void 0===t&&(t=!0),t&&X!==xn||!t&&X!==Bn)return!1;K.push("template function");var r=function(e){void 0===e&&(e=-1);return{kind:"#tplFunction",pos:e,indent:""}}(H);Qn(r,e),t||(l("$template"),y(!0),r.name=A()||"",""===r.name&&b("Invalid syntax: $template name cannot be empty",H),y()),K.push("template arguments"),d(xn);for(var i,o,a=!0,s=!1;a;){if(y(),o=H,(i=A())!==Yt){var u=qn(r,i,H);y(),X===jn&&(u.optional=s=!0,n(),y()),X===Vn&&(n(),y(),u.typeRef=S(!1,Yt,Yt,!0),y()),X===Ln&&(n(),y(),u.defaultValue=S(!1)),s&&!u.optional&&b("Optional arguments must be in last position",o)}y(),X!==In?a=!1:X=n()}return d(Nn),K.pop(),y(),t&&(l("=>"),y()),d(_n),c(Gt)&&(r.indent=RegExp.$1),N(r,"template content"),d(Mn),t&&y(!1,!1),K.pop(),!0}function N(e,t){for(void 0===t&&(t="content block"),K.push(t);I(e)||D(e)||w(e););K.pop()}function w(e){if(X===Rn&&z!==mn||X===fn||X===Mn)return!1;if(k())return!1;K.push("text node");var t=y(),r=H,i=[],o=!1;if(X!==Rn&&X!==fn&&!k()){var a=function(e,t){void 0===t&&(t=-1);return{kind:"#textNode",pos:t,textFragments:e}}([],r);t&&(i[0]=vn);for(var s=t;X!==Rn&&X!==fn&&X!==Mn&&!k();)if(g(),X===mn){var c=z;X=d(mn);var l=Wn[""+X];l!==Yt?Z?(i.push(mn),i.push(X),s=!1,n()):X===Jn?(s&&i.length>0&&i.pop(),s=!0,z=c,n()):(s=!1,n(),i.push(l),z=l,o=!0):(i.push(mn),s=!1)}else X===_n?(u(j(),a),s=!1):s&&m(X)?n():(s=m(X),i.push(s?vn:X),n());if(u(null,a),!o&&a.expressions===Yt&&(1===a.textFragments.length&&" "===a.textFragments[0]||0===a.textFragments.length))return K.pop(),!0;Qn(a,e)}return K.pop(),!0;function u(e,t){null!==e?(i.length?(t.textFragments.push(String.fromCharCode.apply(null,i)),i=[]):t.textFragments.push(""),t.expressions===Yt?t.expressions=[e]:t.expressions.push(e)):i.length&&t.textFragments.push(String.fromCharCode.apply(null,i))}}function k(){return X===Bn&&null!==c(_?tn:en)}function I(e){if(X!==Rn||a()===On)return!1;X=d(Rn);var t=0,r=-1;g();var i,o="",c="element";if(X===mn){if(d(mn),function(e){if(sn===s(dn)){K.push("cdata section");var t=H;l(sn);var r=function(e){void 0===e&&(e=-1);return{kind:"#cdata",pos:e,text:""}}(H);Qn(r,e),y()&&R(C(r,e,V)),d(Tn);for(var i=[],o=!0;o;)X===fn?(o=!1,b("end marker '</!cdata>' not found",t-2)):X===mn?(n(),ln===s(un)?(Z&&i.push(mn),i.push(X),n()):i.push(mn)):X===Rn&&ln===s(un)?(l(ln),o=!1):(i.push(X),n());return r.text=String.fromCharCode.apply(null,i),K.pop(),!0}return!1}(e))return!0;c="fragment",K.push(c),Qn(i=Gn(H),e)}else t===wn?c="component":t===Pn?c="param node":t===Dn&&(c="decorator node"),K.push(c),r=H,o=$(!0,0===t,c+" identifier"),i=function(){if(t===wn){var n=function(e,t){void 0===t&&(t=-1);return{kind:"#component",ref:e,pos:t}}(tr(o,r),H);return n.ref.refPath=F(n.ref.code),Qn(n,e)}if(t===Pn)return Qn(function(e,t){void 0===t&&(t=-1);return{kind:"#paramNode",name:e,pos:t}}(o,H),e);if(t===Dn){var i=function(e,t){void 0===t&&(t=-1);return{kind:"#decoratorNode",ref:e,pos:t}}(tr(o,r),H);return i.ref.refPath=F(i.ref.code),er(i,e)}return Qn(function(e,t){void 0===t&&(t=-1);return{kind:"#element",name:e,pos:t}}(o,H),e)}(),t!==wn&&t!==Dn||o.match(nn)?t!==Pn||o.match(rn)||b("Invalid identifier: '"+o+"'",r):b("Invalid "+c+" reference: '"+o+"'",r),0===t&&o.match(_?an:on)&&b("Invalid tag name '"+o+"'",r);var p=y();p&&R(C(i,e,V));if(X===On)l("/>");else if(X===Tn){d(Tn),N(i),l("</");var f=H,h=t,v=g(),m=$(!1,0===t,c+" identifier");""===m&&0===v&&mn===X?d(mn):""===m&&0===v||(h!==v||""!==m&&m!==o)&&b("End tag </"+x(v,m)+"> doesn't match start tag <"+x(h,o)+">",f),y(),d(Tn)}else b(p?"Unexpected character: "+u(X):"Invalid character in "+c+" identifier: "+u(X),H);return K.pop(),!0;function g(){return X===wn||X===Pn||X===Dn?(t=X,X=n(),t):0}function x(e,t){return(0===e?"":String.fromCharCode(e))+t}}function C(e,t,r){var i=0,o=!0,a=null,s=-1,c="";for(K.push("param");o&&!r();){s=H,c=X===Dn?"decorator":X===bn?"label":X===An?"property":"param";var u=null,p=!1,f=!1,h=void 0;if((i=V())===Dn&&X===Dn){d(Dn);var v=H-2;""===(h=A()||"")?b("Invalid preprocessor reference",v):"#preprocessor"!==e.kind&&"#decorator"!==e.kind&&"#decoratorNode"!==e.kind||b("@@"+h+" cannot be used in this context",v),u={kind:"#preprocessor",ref:tr("@@"+h,H),pos:v,hasDefaultPropValue:!1,isOrphan:!1,parent:e,grandParent:t},null===a&&(a=[]),a.push(u)}else{if(0===i&&X===_n){K.push("binding shortcut");var m=!1;(X=d(_n))===Vn&&(l("::"),m=!0),y(),X===An&&(d(An),p=!0,y()),h=A()||"",p&&(y(),d(Sn)),y(),d(Mn);var g=tr(h,s);g.oneTime=m,I(h,e,g,p),y()||(o=!1),K.pop();continue}K.push(c),i===bn&&X===bn&&(d(bn),f=!0);var x=H;0!==i&&(x-=1),h=$(!0,0===i,c+" name"),i===An?(d(Sn),p=!0):i===bn&&"#preprocessor"===e.kind&&b("Labels cannot be used on pre-processors",x),i!==bn&&i!==An||h.match(rn)||b("Invalid name '"+h+"'",x),f&&"#component"!==e.kind&&b("Forward label '"+h+"' can only be used on components",x-1)}var N=y();if(X===Ln)d(Ln),y(),null!==u?I(cn,u,P(),!1,f,!0):I(h,e,P(),p,f),y()||(o=!1);else if(i===Dn&&X===xn){var w=void 0;w=null!==u?u:I(h,e),d(xn),y(),C(w,e,k),d(Nn),y()||(o=!1)}else N||X===Tn||X===On||X===Nn?null!==u?u.isOrphan=!0:I(h,e,Yt,!1,f):o=!1;null===u&&K.pop()}return r()||b(),K.pop(),a;function k(){return X===Nn}function I(e,t,n,r,o,a){var c;return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),i!==Dn||a?i===bn?((c=function(e,t){void 0===t&&(t=-1);return{kind:"#label",pos:t,name:e,fwdLabel:!1,isOrphan:!1}}(e,s)).value=n,c.isOrphan=n===Yt,c.fwdLabel=o):c=r?function(e,t,n){void 0===n&&(n=-1);return{kind:"#property",name:e,value:t,pos:n}}(e,n,s):function(e,t,n,r){void 0===n&&(n=!1);void 0===r&&(r=-1);return{kind:"#param",name:e,isOrphan:n,pos:r,value:t}}(e,n,n===Yt,s):(c=function(e,t){void 0===t&&(t=-1);return{kind:"#decorator",pos:t,ref:e,hasDefaultPropValue:!1,isOrphan:!1}}(tr(e,s),s),n!==Yt?(c.hasDefaultPropValue=!0,c.defaultPropValue=n):c.isOrphan=!0,c.ref.refPath=F(c.ref.code)),er(c,t)}function V(){if(X===An||X===Dn||X===bn){var e=X;return n(),e}return 0}}function P(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var r=H,i=t?"argument":"param value";if(X===yn)return p(yn,t);if(X===gn)return p(gn,t);if(e&&X===_n)return j();if(!t&&X===zn)return l("true"),!0;if(!t&&X===Kn)return l("false"),!1;if(h()||v()){var o=[];for(v()&&(o.push(X),n(),y());h();)o.push(X),n();if(X===Pn)for(o.push(Pn),n(),h()||b("Invalid number");h();)o.push(X),n();return parseFloat(String.fromCharCode.apply(null,o))}if(t){var a=$(!0,!1);return"true"===a||"false"!==a&&a}return b("Invalid "+i+": "+u(X),r),0}function V(){return X===On||X===Tn}function $(e,t,r){void 0===t&&(t=!1),void 0===r&&(r="identifier");var i=[];if(f()||X===Fn){var o=!1;for(i.push(X),n();f()||h()||X===Fn||t&&X===Cn||!t&&X===Pn;)o=X===Pn,i.push(X),n();o&&b("Invalid "+r)}else e&&b("Invalid character "+u(X));return 0===i.length?"":String.fromCharCode.apply(null,i)}function j(){K.push("expression");var e=!1,t=!1,r=!1;d(_n),X===Vn?(l("::"),e=!0):X===Ln&&((X=n())===Tn?(n(),r=!0):t=!0);var i=H,o=tr(S(!1),i);if(o.oneTime=e,o.isBinding=t,r&&(o.code="()=>"+o.code),_){var a=F(o.code);a===Yt?b("Invalid reference path '"+o.code+"'",o.pos):o.refPath=a}return d(Mn),K.pop(),o}function D(e){if(!k())return!1;K.push("js statement");var t,r=s(3),i=H;switch(r){case"$ex":Qn(nr((t=O("$exec"))+";","$exec",i),e);break;case"$le":Qn(nr("let "+(t=O("$let"))+";","$let",i),e);break;case"$lo":K.push("$log statement");var o=nr("log","$log",i);if(_){l("$log"),y(),d(xn),K.push("$log argument");for(var a=[];;){y();var u=P(!1,!0);if(a.push(""+u),Yn(""+u,o),y(),X!==In)break;n()}d(Nn),y(),K.pop(),o.code="log("+a.join(", ")+");"}else t=E("$log"),o.code="log"+t+";";d($n),Qn(o,e),K.pop();break;case"$if":K.push("$if statement");var p=rr("if","$if",i);for(I("$if",p),Qn(p,e),d(_n),N(p),d(Mn);c(Qt);){y(),l("else"),y(!0);var f=H;X===Xn?I("if",p=rr("","$elseif",f),"else "):p=rr("else {","$else",f),d(_n),Qn(p,e),N(p),d(Mn)}K.pop();break;case"$fo":var h=rr("for "+(t=E("$for"))+" {","$for",i);Qn(h,e),d(_n),N(h),d(Mn);break;case"$ea":K.push("$each statement"),l("$each");var v=rr("each","$each",i);y(),d(xn),y();var m=void 0;K.push("$each argument"),_?(m=$(!0,!1),y()):m=S(!1),Yn(m,v),d(In),y();var g=void 0;for(d(xn),g="(";;){y();var w=H;if(Yn(u=$(!0,!1),v,!0)||b("Invalid function argument '"+u+"'",w),g+=u,y(),X===Vn&&(n(),y(),S(!1,Yt,Yt,!0),y()),X!==In)break;n(),g+=","}d(Nn),g+=")",K.pop(),v.startCode="each("+m+","+g+" => {",v.endCode="});",y(),l("=>"),y(),Qn(v,e),d(_n),N(v),d(Mn),y(),d(Nn),y(),d($n),K.pop();break;case"$te":x(e,!1);break;default:b("Invalid JS statement",H)}return K.pop(),!0;function I(e,n,r){void 0===r&&(r=""),_?(l(e),y(),d(xn),y(),t=$(!0,!1),y(),d(Nn),y(),n.startCode=r+"if ("+t+") {",Yn(t,n)):(t=E(e),n.startCode=r+"if "+t+" {")}}function O(e){K.push(e+" statement"),l(e),y(!0);var t=S(!1,Yt,Yt,!1,!0);return d($n),K.pop(),t}function E(e){K.push(e+" statement"),l(e),y(),X!==xn&&b("Invalid "+e+" statement",H);var t=S(!1,xn,Nn);return y(),K.pop(),t}function A(){if(f()||X===Bn||X===Hn){var e=[X];for(n();f()||X===Bn||X===Hn||h();)e.push(X),n();return String.fromCharCode.apply(null,e)}return Yt}function S(e,t,r,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=[],s="";for(t!==Yt&&(d(t),a.push(t));!u();)g()||(X===gn||X===yn?l(p(X)):X===_n?l(S(!0,_n,Mn,i)):X===An?l(S(!0,An,Sn,i)):X===xn?l(S(!0,xn,Nn,i)):i&&X===Rn?l(S(!0,Rn,Tn,!0)):(a.push(X),n()));if(l(""),(""===(s=s.trim())||t!==Yt&&s.length<=2)&&!1===e){var c=t===Yt?H:H-1;b(i?"type definition cannot be empty":"expression cannot be empty",c)}return s;function l(e){s+=String.fromCharCode.apply(null,a)+e,a=[]}function u(){if(r!==Yt){if(X===r)return a.push(X),n(),!0}else if(o){if(X===$n)return!0}else if(X===$n||X===Mn||X===In||X===Nn||i&&X===Ln)return!0;return X===fn}}function F(e){return""!==e&&e.match(nn)?e.split("."):Yt}function R(e){if(null!==e){for(var n=e.length-1;n>-1;n--){var r=void 0;if((p=e[n]).instance)r=p.instance;else{var i=p.ref.code;if(J===Yt||J[i]===Yt){if(!Z)return void b("Undefined pre-processor '"+i+"'",p.pos);if(t!==Yt){e.splice(n,1),t.undefinedPreProcessorsFound=!0;continue}}r=p.instance=J[i]()}var o={};if(p.params)for(var a=0,s=p.params;a<s.length;a++){var c=s[a];o[c.name]=c}if(p.paramsDict=o,r.setup!==Yt)try{r.setup(p.parent,p.paramsDict,T(p.ref.code,p.grandParent,p.pos))}catch(e){var d=e.message||e;if(d.match(/^XJS\:/))throw e;b("Error in "+p.ref.code+".setup(): "+d,p.pos)}}for(var l=0,u=e;l<u.length;l++){var p=u[l];U===Yt?U=[p]:U.push(p)}}}function L(e){return i(this,void 0,void 0,(function(){function t(e){e.parent=e.grandParent=e.params=e.instance=e.paramsDict=Yt}var n,r,i,a,s,c;return o(this,(function(o){switch(o.label){case 0:n=e.length,r=n-1,o.label=1;case 1:if(!(r>-1))return[3,6];if(i=e[r],(a=i.instance).process===Yt)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,a.process(i.parent,i.paramsDict,T(i.ref.code,i.grandParent,i.pos))];case 3:return o.sent(),t(i),[3,5];case 4:if(s=o.sent(),c=s.message||s,t(i),c.match(/^XJS\:/))throw s;return b("Error in "+i.ref.code+".process(): "+c,i.pos),[3,5];case 5:return r--,[3,1];case 6:return[2]}}))}))}function T(e,n,r){return q=e,Y=r,W===Yt?W={parent:n,fileId:t&&t.fileId||"",rootFragment:M,error:function(e,t){void 0===t&&(t=-1),b(q+": "+e,t>-1?t:Y)},preProcessors:J}:W.parent=n,W}var _,M,B,H,X,z,K,J,U,W,Z,q,Y;return o(this,(function(n){switch(n.label){case 0:return _=t&&"$fragment"===t.templateType,B=e.length,H=0,X=fn,z=pn,K=[],J=t&&t.preProcessors||{},Z=t&&!0===t.fragmentValidationMode,q="",Y=0,B>0&&(X=e.charCodeAt(0)),function(){if(M=Gn(H),_)N(M,"$fragment");else{var e=H;y(!1,!1),X===fn&&b("Empty template",e),x(M)||b("Invalid $template function",e)}}(),B>0?U===Yt?[3,2]:[4,L(U)]:[3,3];case 1:n.sent(),W=Yt,U=Yt,n.label=2;case 2:X!==fn&&b(),n.label=3;case 3:return[2,_?M:M.content[0]]}}))}))}function qn(e,t,n){void 0===n&&(n=-1);var r={kind:"#tplArgument",name:t,pos:n};return e.arguments?e.arguments.push(r):e.arguments=[r],r}function Yn(e,t,n){if(void 0===n&&(n=!1),t.args||(t.args=[]),e.match(nn)){var r=e.split(".");if(n){if(1!==r.length)return!1;t.args.push(e)}else t.args.push(r)}else t.args.push(n?e:[e]);return!0}function Gn(e){return void 0===e&&(e=-1),{kind:"#fragment",pos:e}}function Qn(e,t){return t.content?t.content.push(e):t.content=[e],e}function er(e,t){return t.params?t.params.push(e):t.params=[e],"#decorator"!==t.kind&&"#preprocessor"!==t.kind||(t.isOrphan=!1),e}function tr(e,t){return void 0===t&&(t=-1),{kind:"#expression",oneTime:!1,isBinding:!1,code:e,pos:t}}function nr(e,t,n){return void 0===n&&(n=-1),{kind:"#jsStatement",name:t,code:e,pos:n}}function rr(e,t,n){return void 0===n&&(n=-1),{kind:"#jsBlock",name:t,startCode:e,endCode:"}",pos:n}}var ir,or=void 0,ar=0,sr=2,cr=/^on(\w+)$/,dr={"#textNode":"Text nodes","#element":"Element nodes","#component":"Component nodes","#fragment":"Fragment nodes","#paramNode":"Parameter nodes","#decoratorNode":"Decorator nodes","#{element}":"Dynamic element nodes","#{paramNode}":"Dynamic parameter nodes","#param":"Parameters","#property":"Properties","#label":"Labels","##label":"Forward labels","#decorator":"Decorators"},lr={"#tplFunction":"$template function","#tplArgument":"$template argument","#jsStatement":"javascript statement","#jsBlock":"javascript block","#fragment":"fragment","#element":"element","#component":"component","#paramNode":"param node","#decoratorNode":"decorator node","#textNode":"text node","#param":"param","#property":"property","#decorator":"decorator","#reference":"reference","#expression":"expression","#eventListener":"event listener","#label":"label"},ur={"#textNode":{"#param":ar,"#property":ar,"#label":ar,"##label":ar,"#decorator":ar,"@onevent":ar},"#element":{"#param":1,"#property":1,"#label":1,"##label":ar,"#decorator":3,"@onevent":1},"#component":{"#param":1,"#property":ar,"#label":1,"##label":sr,"#decorator":3,"@onevent":1},"#fragment":{"#param":ar,"#property":ar,"#label":ar,"##label":ar,"#decorator":3,"@onevent":ar},"#paramNode":{"#param":1,"#property":ar,"#label":ar,"##label":ar,"#decorator":3,"@onevent":1},"#decorator":{"#param":1,"#property":ar,"#label":1,"##label":ar,"#decorator":ar,"@onevent":1},"#decoratorNode":sr},pr={paramValue:{"#textNode":ar,"#element":ar,"#component":ar,"#fragment":ar,"#paramNode":1,"#decoratorNode":ar,"#{element}":ar,"#{paramNode}":ar},xmlns:{"#textNode":ar,"#element":1,"#component":1,"#fragment":1,"#paramNode":ar,"#decoratorNode":ar,"#{element}":ar,"#{paramNode}":ar},content:{"#textNode":ar,"#element":1,"#component":ar,"#fragment":1,"#paramNode":ar,"#decoratorNode":ar,"#{element}":ar,"#{paramNode}":ar}},fr={validateXjsNode:function(e,t){var n=e.kind,r=ur[n];if(r===sr)t.error(dr[n]+" are not supported yet",e);else if("#cdata"===n||"#component"===n||"#decoratorNode"===n||"#element"===n||"#fragment"===n||"#paramNode"===n||"#decorator"===n){var i=e,o=void 0;if(i.params!==or)for(var a=0,s=i.params;a<s.length;a++){var c=s[a];if("#decoratorNode"===(o=c.kind))v(n,o,c);else if("#param"===o||"#property"===o)h(n,o,c),"#property"===c.kind&&("innerHTML"===c.name&&t.error("innerHTML is not authorized (security restriction)",c),"#element"!==i.kind&&t.error("Properties can only be used on element nodes",c));else if("#preprocessor"===o)t.acceptPreProcessors||t.error("Pre-processors are not accepted in this context",c);else if("#label"===o){var d=c;d.fwdLabel?(h(n,"##label",d),d.isOrphan||"string"==typeof d.value||"object"==typeof d.value||t.error("Forward labels values must be strings or expressions",d)):(h(n,"#label",c),d.isOrphan||"boolean"==typeof d.value||"object"==typeof d.value||t.error("Labels values must be expressions or booleans",d))}else if("#decorator"===o){var l=c,u=l.ref.code,p=pr[u];if("#paramNode"!==n||"paramValue"===u||u.match(cr)?p!==or&&p[n]===ar?t.error("@"+u+" is not supported on "+dr[n],l):u.match(cr)&&(ur[n]["@onevent"]||t.error("Event handlers are not supported on "+dr[n],l)):t.error("Only @paramValue and event listener decorators can be used on Parameter nodes",l),"content"===u){var f=i;f.content&&f.content.length?t.error("@content can only be used on empty elements or fragments",l):l.defaultPropValue&&"#expression"!==l.defaultPropValue.kind?t.error("@content value cannot be a "+typeof l.defaultPropValue,l):l.defaultPropValue&&"#expression"===l.defaultPropValue.kind&&l.defaultPropValue.oneTime&&t.error("@content expression cannot use one-time qualifier",l)}else"paramValue"===u?(i.params.length>1&&t.error("@paramValue cannot be mixed with other parameters",l),l.defaultPropValue===or&&t.error("Incorrect value for @paramValue",l)):"async"===u&&"#fragment"!==n&&"#element"!==n&&"#component"!==n&&t.error("@async cannot be used on "+dr[n],l)}if(c.value!==or&&"object"==typeof c.value)c.value.isBinding&&"#decorator"!==n&&"#decoratorNode"!==n&&"#component"!==n&&"#paramNode"!==n&&t.error("Binding expressions cannot be used on "+lr[n]+" "+lr[c.kind],c)}}function h(e,n,i){if(i)switch(r[n]){case ar:v(e,n,i);case sr:t.error(dr[n]+" are not yet supported on "+dr[e],i)}}function v(e,n,r){t.error(dr[n]+" are not supported on "+dr[e],r)}},getShortPath:function(e){var t=e.split(/\/|\\/);return t.length>2&&(e=".../"+t[t.length-2]+"/"+t[t.length-1]),e},throwError:function(e,t,n,r,i,o,a){void 0===i&&(i="IVY"),void 0===o&&(o=0),void 0===a&&(a=0),r=this.getShortPath(r);var s=this.getLineInfo(n,t),c={kind:"#Error",origin:i,message:"",description:e,line:s.lineNbr+o,column:1===s.lineNbr?s.columnNbr+a:s.columnNbr,lineExtract:s.lineContent.trim(),file:r};throw c.message=this.getErrorMessage(c.origin,c.description,c.file,c.line,c.column,c.lineExtract),c},getErrorMessage:function(e,t,n,r,i,o){return e+":"+t+"\nFile: "+n+" - Line "+r+" / Col "+i+"\nExtract: >> "+o+" <<"},getLineInfo:function(e,t){var n=e.split("\n"),r=0,i=0,o=0;if(t>-1)for(;o<n.length;){if(!(i+(r=n[o].length)<t))return{lineNbr:o+1,lineContent:n[o],columnNbr:1+t-i};o++,i+=r+1}return{lineNbr:0,lineContent:"",columnNbr:0}},nodeName:function(e){return lr[e]||e}};!function(e){e[e.Block=1]="Block",e[e.Component=2]="Component",e[e.Async=3]="Async"}(ir||(ir={}));var hr=void 0,vr=/\"/g,mr=/\\/g,gr=/\n/g,br=/\/\/\s*log\s*/,yr=/^on(\w+)$/,xr={xhtml:"http://www.w3.org/1999/xhtml",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",mathml:"http://www.w3.org/1998/mathml"};function Nr(e,t,n){return i(this,void 0,void 0,(function(){var r,i,a,s,c,d,l,u;return o(this,(function(o){switch(o.label){case 0:return n.lineOffset=n.lineOffset||0,r=!1,e===hr&&t.error("Invalid template string"),e.match(br)&&(r=!0,e=e.replace(br,"")),i={line1:n.lineOffset?n.lineOffset+1:1,col1:n.columnOffset?n.columnOffset+1:1,fileId:n.filePath||"",templateType:n.templateType||"$template",preProcessors:n?n.preProcessors:void 0},[4,Zn(e,i)];case 1:if(a=o.sent(),t.init(e,n),s=t.process(a),r){for(l in c=s.importMap||n.importMap,d=[],c)c.hasOwnProperty(l)&&d.push(l);u="-------------------------------------------------------------------------------",console.log(u),console.log("imports: ",d.join(", ")),console.log("template: "+s.function),console.log(u)}return[2,s]}}))}))}function wr(e){return'"'+e.replace(mr,"\\\\").replace(vr,'\\"').replace(gr,"\\n")+'"'}var kr=function(){function e(e,t,n,r,i,o,a,s){this.kind=t,this.node=n,this.idx=r,this.parentView=i,this.iFlag=o,this.nodeCount=0,this.instructions=[],this.indent="",this.prevKind="",this.nextKind="",this.instanceCounterVar="",this.blockIdx=0,this.jsVarName="ζ",this.cmVarName="ζc",this.childBlockCreated=[],this.childBlockIndexes=[],this.childViewIndexes=[],this.exprCount=0,this.expr1Count=0,this.dExpressions=[],this.hasChildNodes=!1,this.hasParamNodes=!1,this.asyncValue=0,this.cptIFlag=-1,this.cpnParentLevel=-1,this.paramInstanceVars=void 0,this.bindingsCount=0;var c=a.addViewInstruction(e,t,n,r,i,o,a,s);this.vi=c,this.gc=c.gc,this.instructions=c.instructions,this.indent=c.indent,this.nodeCount=c.nodeCount,this.jsVarName=c.jsVarName,this.cmVarName=c.cmVarName,this.hasChildNodes=c.hasChildNodes,this.childBlockIndexes=c.childBlockIndexes,this.childViewIndexes=c.childViewIndexes,this.paramInstanceVars=c.paramInstanceVars,this.asyncValue=c.asyncValue,this.exprCount=c.exprCount,this.expr1Count=c.expr1Count,this.dExpressions=c.dExpressions,this.bindingsCount=c.bindingsCount}return e.prototype.scan=function(){if("asyncBlock"===this.kind)this.generateInstruction([this.node],0,0,this.iFlag,this.prevKind,this.nextKind);else{var e=this.node.content,t=e?e.length:0;if(0===t)return;var n=0;if(t>1){for(var r=0,i=void 0,o=0;t>o&&!("#jsStatement"!==(i=e[o]).kind&&"#paramNode"!==i.kind&&++r>1);o++);r>1&&(this.nodeCount=1,this.gc.addFraInstruction(null,0,this,this.iFlag,n),n=1)}this.scanContent(e,n,this.iFlag)}this.vi.update&&this.vi.update(this.indent,this.nodeCount,this.hasChildNodes,this.asyncValue,this.exprCount,this.expr1Count,this.bindingsCount,this.paramInstanceVars)},e.prototype.scanContent=function(e,t,n){for(var r="",i="",o=e?e.length:0,a=0;o>a;a++)i=a<o-1?e[a+1].kind:"",this.generateInstruction(e,a,t,n,r,i),r=e[a].kind},e.prototype.generateInstruction=function(t,n,r,i,o,a){var s,c=t[n],d=this.nodeCount;"#jsStatement"!==c.kind&&"#paramNode"!==c.kind&&(this.nodeCount++,this.hasChildNodes=!0),fr.validateXjsNode(c,this.gc);var l="",u=-1,p=-1,f=!1;"#element"!==c.kind&&"#component"!==c.kind&&"#paramNode"!==c.kind||(u=(s=this.registerStatics(c.params))[0],p=s[1],f=s[2],u>-1&&p>-1?l=", ζs"+u+", ζs"+p:u>-1?l=", ζs"+u:p>-1&&(l=", 0, ζs"+p));var h="";switch(c.kind){case"#cdata":c.params!==hr&&c.params.length&&this.gc.error("Params, properties, decorators or labels are not supported on cdata sections",c.params[0]);case"#textNode":this.gc.addTxtInstruction(c,d,this,i,r,"0");break;case"#fragment":if(!this.processAsyncCase(c,d,r,o,a)){(h=this.retrieveXmlNs(c))&&this.gc.addXmlNsInstruction(this,i,!0,h),this.gc.addFraInstruction(c,d,this,i,r);var v=this.generateDecoratorInstructions(c,d,i);F(this,c.content),R(this,v)}break;case"#element":if(!this.processAsyncCase(c,d,r,o,a)){(h=this.retrieveXmlNs(c))&&this.gc.addXmlNsInstruction(this,i,!0,h),this.gc.addEltInstruction(c,d,this,i,r,this.generateLabelStatics(c),l),this.generateParamInstructions(c,d,i,!0,this),this.generateDynLabelInstructions(c,d,i,this);v=this.generateDecoratorInstructions(c,d,i);this.createListeners(c,d,i,this),F(this,c.content),R(this,v)}break;case"#component":if(!this.processAsyncCase(c,d,r,o,a)){var m=!(f||c.content&&c.content.length),g=this.gc.addCptInstruction(c,d,this,i,r,this.generateLabelStatics(c),m,u);f&&this.generateParamInstructions(c,d,i,!1,this);v=this.generateDecoratorInstructions(c,d,i,!1,!0);if(this.generateDynLabelInstructions(c,d,i,this),c.content&&c.content.length)($=new e(this,"cptContent",c,d,this,1,this.gc)).contentParentInstruction=g,$.cptIFlag=i,$.cpnParentLevel=r,this.hasParamNodes=!1,$.scan(),$.hasChildNodes||this.hasParamNodes||(g.callImmediately=m=!0),this.hasParamNodes=!1;this.createListeners(c,d,i,this)&&(g.callImmediately=m=!1),m||g.addEndInstruction(),R(this,v)}break;case"#paramNode":this.parentView||this.gc.error("Param nodes cannot be defined at root level",c);for(var b=this,y=0,x=0,N=c.name;b;)if(b.cptIFlag>-1&&(y=b.cptIFlag),b.cpnParentLevel>-1&&(x=b.cpnParentLevel),"asyncBlock"===b.kind)this.gc.error("Param nodes cannot be defined in @async blocks",c);else if("jsBlock"===b.kind)b=b.parentView;else{if("cptContent"===b.kind||"paramContent"===b.kind){b=b.parentView;break}if("template"===b.kind)break;this.gc.error("Param nodes cannot be defined in "+b.kind+" views",c)}var w=b.nodeCount++;b.hasParamNodes=!0;for(var k=this,I=!1,C=null;k;){if("jsBlock"!==k.kind){if("cptContent"===k.kind||"paramContent"===k.kind){C=k;break}break}I=!0,k=k.parentView}if(C||this.gc.error("Internal error: contentParentView should be defined",c),I){var P=C.contentParentInstruction.dynamicPNodeNames;P.indexOf(N)<0&&P.push(N)}b.paramInstanceVars||(b.paramInstanceVars={});var V=b.paramInstanceVars[N];V||(V="ζp"+this.gc.paramCounter++,this.gc.localVars[""+V]=1,b.paramInstanceVars[N]=V);var $,j=C.contentParentInstruction.idx,D=void 0!==c.content&&c.content.length>0,O=this.gc.addPndInstruction(this,c,w,b,y,x+1,"0",u,this.indent,j,V,D);if(this.generateParamInstructions(c,w,y,!1,b),this.createListeners(c,w,y,b),D)($=new e(this,"paramContent",c,w,b,1,this.gc)).indent=this.indent,$.contentParentInstruction=O,$.cpnParentLevel=x+1,$.scan(),O.addEndInstruction();break;case"#jsStatement":this.gc.addJsStatementsInstruction(c,this,i,o);break;case"#jsBlock":if(!this.childBlockCreated[d])for(var E=0,A=n;t.length>A&&"#jsBlock"===t[A].kind;A++)this.gc.addCntInstruction(d+E,this,this.iFlag,r,ir.Block),this.childBlockCreated[d+E]=!0,E++;this.childBlockIndexes.push(d);var S=new e(this,"jsBlock",c,d,this,this.iFlag?this.iFlag+1:0,this.gc);S.prevKind=o,S.nextKind=a,S.scan();break;case"#tplFunction":this.gc.error("$template statements are not supported yet",c)}function F(e,t){t&&(e.scanContent(t,r+1,i),h&&e.gc.addXmlNsInstruction(e,i,!1,h))}function R(e,t){if(t)for(var n=0;t.length>n;n++)t[n].addEndInstruction()}},e.prototype.retrieveXmlNs=function(e){var t="",n=e.params;if(n&&n.length)for(var r=0,i=n;r<i.length;r++){var o=i[r];if("#param"===o.kind&&"xmlns"===o.name)t?this.gc.error("xmlns cannot be defined twice",o):o.value===hr||"string"!=typeof o.value?this.gc.error("xmlns value must be a string",o):((o.isOrphan||o.value===hr)&&this.gc.error("xmlns value cannot be empty",o),t=o.value);else if("#decorator"===o.kind&&"xmlns"===o.ref.code)if(t)this.gc.error("xmlns cannot be defined twice",o);else if(o.defaultPropValue===hr||"string"!=typeof o.defaultPropValue)this.gc.error("@xmlns value must be a string",o);else{var a=o.defaultPropValue;xr[a]?t=xr[a]:this.gc.error('Invalid @xmlns value: must be "html", "xhtml", "svg" or "mathml"',o)}}return""===t&&"#element"===e.kind&&"svg"===e.name.toLowerCase()&&(t=xr.svg),t},e.prototype.registerStatics=function(e){if(!e||!e.length)return[-1,-1,!1];for(var t,n,r=-1,i=hr,o=-1,a=hr,s="",c=!1,d=this.gc.statics,l=d.length,u=0;e.length>u;u++)s="","#param"===(n=e[u]).kind||"#property"===n.kind?(t=n.value,n.isOrphan?s="true":"object"==typeof t?c=!0:s="string"==typeof t?wr(t):""+t,s&&("#param"===n.kind?(i=i||[],r=p(n.name,s,r,i)):(a=a||[],o=p(n.name,s,o,a)))):"#decorator"!==n.kind&&"#decoratorNode"!==n.kind||(c=!0);return f(r,i),f(o,a),[r,o,c];function p(e,t,n,r){return n<0&&(n=l,l++),r.push(wr(e)),r.push(t),n}function f(e,t){t&&(d[e]="ζs"+e+" = ["+t.join(", ")+"]")}},e.prototype.generateLabelStatics=function(e){if(e.params===hr)return"0";for(var t=[],n=0,r=e.params;n<r.length;n++){var i=r[n];"#label"===i.kind&&i.isOrphan&&t.push(wr("#"+i.name))}if(!t.length)return"0";var o=this.gc.statics,a=o.length;return o[a]="ζs"+a+" = ["+t.join(", ")+"]","ζs"+a},e.prototype.generateParamInstructions=function(e,t,n,r,i){var o=e.params;if(o!==hr)for(var a="#paramNode"===e.kind,s=0,c=o;s<c.length;s++){var d=c[s];if("#param"===d.kind||"#property"===d.kind)d.value&&"#expression"===d.value.kind&&this.gc.addParamInstruction(this,d,t,i,n,r,this.indent,a);else if(a&&"#decorator"===d.kind){var l=d;"paramValue"===l.ref.code&&this.gc.addParamInstruction(this,l,t,i,n,!1,this.indent,!0)}}},e.prototype.generateDynLabelInstructions=function(e,t,n,r){if(e.params!==hr)for(var i=0,o=e.params;i<o.length;i++){var a=o[i];"#label"!==a.kind||a.isOrphan||!a.value||a.fwdLabel||this.gc.addLblInstruction(a,t,r,n,this.indent)}},e.prototype.processAsyncCase=function(t,n,r,i,o){var a=0;if(t===this.node)return!1;if(t.params)for(var s=0,c=t.params;s<c.length;s++){var d=c[s];if("#decorator"===d.kind&&"async"===d.ref.code){if(!d.hasDefaultPropValue){d.params&&this.gc.error("Async decorator doesn't accept multiple params",d),a=1;break}var l=d.defaultPropValue;"object"==typeof l?a=l:"number"==typeof l?a=l:this.gc.error("@async value must be either empty or a number or an expression",d)}}if(a){this.gc.addCntInstruction(n,this,this.iFlag,r,ir.Async);var u=new e(this,"asyncBlock",t,n,this,this.iFlag?this.iFlag+1:0,this.gc);return u.setAsync(a),u.prevKind=i,u.nextKind=o,u.scan(),!0}return!1},e.prototype.setAsync=function(e){this.asyncValue=e},e.prototype.generateDecoratorInstructions=function(e,t,n,r,i){var o;void 0===r&&(r=!0),void 0===i&&(i=!0);var a=void 0;if(e.params!==hr)for(var s=e.kind,c="",d=0,l=e.params;d<l.length;d++){var u=l[d];if("#decorator"===u.kind)if("content"===(c=u.ref?u.ref.code:""))r&&("#element"!==s&&"#fragment"!==s||this.gc.addInsInstruction(u,e,t,this,n));else{if("async"===c||"key"===c||"paramValue"===c||"xmlns"===c||c.match(yr))continue;if(i){var p,f;p=(o=this.registerStatics(u.params))[0],o[1],f=o[2];var h=this.nodeCount++,v=this.gc.addDecoInstruction(u,h,t,this,n,this.indent,p,this.generateLabelStatics(u));f&&this.generateParamInstructions(u,h,n,!1,this),this.generateDynLabelInstructions(u,h,n,this),this.createListeners(u,h,n,this),a?a.push(v):a=[v]}}}return a},e.prototype.createListeners=function(e,t,n,r){if(e.params===hr)return!1;for(var i=!1,o=0,a=e.params;o<a.length;o++){var s=a[o];"#decorator"===s.kind&&s.ref.code.match(yr)&&(this.gc.addEvtInstruction(s,RegExp.$1,r.nodeCount++,t,r,n),i=!0)}return i},e}(),Ir=/\"/g,Cr=/\\/g,Pr=/\n/g,Vr=/^\n*/,$r="$",jr="$api",Dr="$api",Or="$template",Er="$apiClassName",Ar=function(){function e(){this.template="",this.indentIncrement="    ",this.templateName="",this.filePath="",this.errorPath="",this.statics=[],this.localVars={},this.blockCount=0,this.eachCount=0,this.templateArgs=[],this.paramCounter=0,this.acceptPreProcessors=!1,this.fragmentMode=!1}return e.prototype.init=function(e,t){this.template=e,this.options=t,this.imports=t.importMap||{},this.templateName=t.templateName.replace(Ir,""),this.filePath=t.filePath.replace(Ir,""),this.errorPath=fr.getShortPath(this.filePath)},e.prototype.error=function(e,t){var n=this.options.filePath||"",r=this.options.lineOffset||0,i=this.options.columnOffset||0;fr.throwError("Invalid "+fr.nodeName(t.kind)+" - "+e,t.pos,this.template,n,"IVY",r,i)},e.prototype.decreaseIndent=function(e){var t=this.indentIncrement.length;return e.length>t?e.substring(0,e.length-t):e},e.prototype.process=function(e){var t,n,r=this.fragmentMode="#tplFunction"!==e.kind;this.fragmentMode?(n={kind:"#tplFunction",indent:"",content:e.content,name:"[$fragment template string]",pos:0},t=this.expressionRoots={}):n=e;var i=this,o=this.options,a=[];return function(){var e=n.arguments;if(e)for(var s=0;e.length>s;s++)i.templateArgs.push(e[s].name);new kr(null,"template",n,1,null,0,i,n.indent).scan(),i.processRoot(a);var c={};(o.function||o.body)&&(c.body=function(){for(var e=[],i=0,o=a;i<o.length;i++){var s=o[i];"string"==typeof s?e.push(s):"#expression"===s.kind?(r&&(t[Hr(s.code)]=1),e.push(s.code)):"#jsStatement"===s.kind?e.push(s.code):"#jsBlock"===s.kind&&e.push(s.startCode.replace(Vr,""))}return"\n"+e.join("")+Br(n.indent)}());o.statics&&(c.statics=i.statics);var d=[];for(var l in t)t.hasOwnProperty(l)&&d.push(l);o.function&&(c.function=function(e,t,n,r,i){var o,a=[],s="",c="",d=t.arguments,l="",u=[],p=!1;if(e=Br(e),!n&&d&&d.length){var f=[],h=void 0,v="";s=", $, $api";for(var m=0;d.length>m;m++)if(v="",h=d[m],0!==m||h.name!==$r&&h.name!==jr||(l=h.typeRef||""),h.name===$r)m>0&&h.typeRef&&r.error("Template Controller class must be defined as first argument",h);else if(h.name===jr)m>0&&h.typeRef&&r.error("Template Api class must be defined as first argument",h);else if(h.name===Or)p=!0;else if(h.name===Dr);else if(l)m>0&&u.push(h.name+' = $api["'+h.name+'"]');else{switch(u.push(h.name+' = $api["'+h.name+'"]'),h.typeRef){case"string":case"number":case"boolean":o=h.typeRef;break;case"IvContent":o="any";break;default:o=h.typeRef?h.typeRef:"any"}h.defaultValue&&(v=" = "+h.defaultValue);var g=h.optional?"?":"";f.push(""+(e+r.indentIncrement)+h.name+g+": "+o+v+";")}!l&&f.length&&(l="ζParams",b="ζΔD",r.imports[b]=1,c=[e,"@ζΔD"," class ζParams {\n",f.join("\n"),"\n",e,"}"].join(""))}var b;if(r.imports["ζt"]=1,t[Er]=l,n){s=", $, $context";var y=r.imports,x=[];for(var N in y)y.hasOwnProperty(N)&&x.push(N+"=ζr."+N);a.push("const "+x.join(",")+";")}else a.push("(function () {");r.statics.length&&a.push(e+"const "+r.statics.join(", ")+";");c&&a.push(c);p&&p&&(s+=", $template");if(a.push(e+'return ζt("'+r.templateName+'", "'+r.errorPath+'", ζs0, function (ζ'+s+") {"),i.length>0){x=[];var w=void 0;for(m=0;i.length>m;m++)w=i[m],x.push(w+'=$context["'+w+'"]');a.push("let "+x.join(", ")+";")}u.length&&a.push(e+r.indentIncrement+"let "+u.join(", ")+";");return a.join("\n")}(n.indent,n,r,i,d)+c.body+function(e,t,n){if(t){var r="";return n.length>0&&(r=', undefined, ["'+n.join('","')+'"]'),"}"+r+");\n"+Br(e.indent)}var i=e[Er];return i?"}, "+i+");\n"+Br(e.indent)+"})()":"});\n"+Br(e.indent)+"})()"}(n,r,d));o.imports&&(c.importMap=i.imports);r&&d.length>0&&(c.contextIdentifiers=d);return c}()},e.prototype.addTxtInstruction=function(e,t,n,r,i,o){var a=!0,s='""';if(n.gc.imports["ζtxt"+Sr(r)]=1,"#cdata"===e.kind)s=Fr(e.text),a=!1;else{var c=e.expressions?e.expressions.length:0;if(e.textFragments.length<=1&&0===c)s=Fr(e.textFragments[0]);else{for(var d=n.gc,l=d.statics.length,u=[],p=e.textFragments.length,f=0,h=0;p>h;h++)u.push(Fr(e.textFragments[h])),f<c&&(u.push('""'),f++);d.statics.push("ζs"+l+" = ["+u.join(", ")+"]"),s="ζs"+l}}n.instructions.push((function(c){var d,l=n,u=0;if(a&&(u=(d=e).expressions?d.expressions.length:0),c.push(""+l.indent+Rr("txt",r)+l.jsVarName+", "+l.cmVarName+", "+r+", "+t+", "+i+", "+o+", "+s+", "+u),a)for(var p=0;u>p;p++)c.push(", "),Lr(c,d.expressions[p],l,r);c.push(");\n")}))},e.prototype.addXmlNsInstruction=function(e,t,n,r){e.gc.imports["ζxmlns"+Sr(t)]=1,e.instructions.push((function(i){var o=e,a="";n&&(a=', "'+r+'"'),i.push(""+o.indent+Rr("xmlns",t)+o.jsVarName+", "+t+a+");\n")}))},e.prototype.addEltInstruction=function(e,t,n,r,i,o,a){n.gc.imports["ζelt"+Sr(r)]=1,n.instructions.push((function(s){var c=n,d=e.content&&e.content.length?1:0,l="0"!==o||a?", "+o+a:"";s.push(""+c.indent+Rr("elt",r)+c.jsVarName+", "+c.cmVarName+", "+t+", "+i+', "'+e.name+'", '+d+l+");\n")}))},e.prototype.addFraInstruction=function(e,t,n,r,i){n.gc.imports["ζfra"+Sr(r)]=1,n.instructions.push((function(e){var o=n;e.push(""+o.indent+Rr("fra",r)+o.jsVarName+", "+o.cmVarName+", "+t+", "+i+");\n")}))},e.prototype.addParamInstruction=function(e,t,n,r,i,o,a,s){var c;void 0===s&&(s=!1),c=o?"att":"par",t&&"#property"===t.kind&&(c="pro"),r.gc.imports["ζ"+c+Sr(i)]=1,e.instructions.push((function(e){var o=r,d=i?"D":"",l="0",u=!0;"#decorator"!==t.kind&&(l='"'+t.name+'"');var p=t.value;if("par"===c){if("#decorator"===t.kind)(f=t.defaultPropValue)&&(p=f);p&&p.isBinding?(_r(e,p.code,t,o,a,i,n,o.bindingsCount,l),o.bindingsCount++,u=!1):e.push(a+"ζpar"+d+"("+o.jsVarName+", "+o.cmVarName+", "+(i?1:0)+", "+n+", "+l+", ")}else e.push(a+"ζ"+c+d+"("+o.jsVarName+", "+(i?1:0)+", "+n+", "+l+", ");if(u){var f;if("#decorator"===t.kind)(f=t.defaultPropValue)&&Tr(e,f);else s?e.push(p):Lr(e,p,o,i);e.push(");\n")}}))},e.prototype.addDecoInstruction=function(e,t,n,r,i,o,a,s){var c=0,d=Sr(i);if(r.gc.imports["ζdeco"+d]=1,e.defaultPropValue)c=1;else if(void 0!==e.params)for(var l=0,u=e.params;l<u.length;l++){if("#param"===u[l].kind){c=2;break}}function p(d){var l=r,u=i?"D":"",p=e.defaultPropValue,f="0"!==s,h=p&&"#expression"===p.kind&&p.isBinding;d.push(o+"ζdeco"+u+"("+l.jsVarName+", "+l.cmVarName+", "+(i?1:0)+", "+t+", "+n+", "),d.push(Fr(e.ref.code)+", "),Tr(d,e.ref),h?d.push(", 2"):(l.bindingsCount=0,d.push(", "+c)),!h&&(p||a>-1||f)&&(d.push(", "),p?Tr(d,p):d.push("0"),a>-1?d.push(", ζs"+a):f&&d.push(", 0"),f&&d.push(", "+s)),d.push(");\n"),h&&_r(d,p.code,e,l,o,i,t,0,0)}return p.addEndInstruction=function(){r.gc.imports["ζdecoCall"+d]=1,r.instructions.push((function(e){var n=r;e.push(n.indent+"ζdecoCall"+d+"("+n.jsVarName+", "+n.cmVarName+", "+(i?1:0)+", "+t+");\n")}))},r.instructions.push(p),p},e.prototype.addLblInstruction=function(e,t,n,r,i){n.gc.imports["ζlbl"+Sr(r)]=1,n.instructions.push((function(o){var a=n,s=r?"D":"",c=e.value;o.push(i+"ζlbl"+s+"("+a.jsVarName+", "+(r?1:0)+", "+t+', "#'+e.name+'", '),Tr(o,c),o.push(");\n")}))},e.prototype.addJsStatementsInstruction=function(e,t,n,r){t.instructions.push((function(n){var r=t;"$log"===e.name&&(e.code="console."+e.code),n.push(r.indent),n.push(e),e.code.match(/\n$/)||n.push("\n")}))},e.prototype.addCntInstruction=function(e,t,n,r,i){t.gc.imports["ζcnt"+Sr(n)]=1,t.instructions.push((function(o){var a=t;o.push(""+a.indent+Rr("cnt",n)+a.jsVarName+", "+a.cmVarName+", "+e+", "+r+", "+i+");\n")}))},e.prototype.addCptInstruction=function(e,t,n,r,i,o,a,s){var c=[],d="";function l(u){var p;a=l.callImmediately;var f,h=n;f=(p=Mr(n,c,s,a?o:"0"))[0],d=p[1],h.bindingsCount=0,u.push(""+h.indent+Rr("cpt",r)+h.jsVarName+", "+h.cmVarName+", "+r+", "+t+", "+i+", "),Lr(u,e.ref,h,r),u.push(", "+(a?1:0)+f+");\n")}return n.gc.imports["ζcpt"+Sr(r)]=1,l.idx=t,l.dynamicPNodeNames=c,l.callImmediately=a,l.addEndInstruction=function(){var e=this;c=l.dynamicPNodeNames,n.gc.imports["ζcall"+Sr(r)]=1,n.instructions.push((function(t){var i=n,a="";d?a=", 0, "+o+", "+d:"0"!==o&&(a=", 0, "+o),t.push(""+i.indent+Rr("call",r)+i.jsVarName+", "+e.idx+a+");\n")}))},n.instructions.push(l),l},e.prototype.addPndInstruction=function(e,t,n,r,i,o,a,s,c,d,l,u){var p,f=[];function h(e){var o,h,v=r;h=(o=Mr(r,f,s,u?"0":a))[0],p=o[1],e.push(c+"ζpnode("+v.jsVarName+", "+v.cmVarName+", "+i+", "+n+", "+d+', "'+t.name+'", '+l+"++"+h+");\n")}return e.gc.imports["ζpnode"]=1,h.idx=n,h.dynamicPNodeNames=f,h.addEndInstruction=function(){var t=this;e.gc.imports["ζpnEnd"]=1,e.instructions.push((function(e){var n=r,o="";p?o=", "+a+", "+p:"0"!==a&&(o=", "+a),e.push(c+"ζpnEnd("+n.jsVarName+", "+n.cmVarName+", "+i+", "+t.idx+o+");\n")}))},e.instructions.push(h),h},e.prototype.addEvtInstruction=function(e,t,n,r,i,o){i.gc.imports["ζevt"+Sr(o)]=1,e.hasDefaultPropValue||e.params||i.gc.error("Missing event handler value for @"+e.ref.code,e),i.instructions.push((function(a){var s,c,d=i;if(e.defaultPropValue)"#expression"!==e.defaultPropValue.kind?d.gc.error("Event listeners must be function expressions - e.g. @onclick={e=>doSomething(e)}",e):s=e.defaultPropValue;else for(var l=0,u=e.params;l<u.length;l++){var p=u[l];"#param"===p.kind?"listener"===p.name?p.value?"#expression"!==p.value.kind?d.gc.error("listeners must be function expressions - e.g. listener={e=>doSomething(e)}",p):s=p.value:d.gc.error("listener value cannot be empty",p):"options"===p.name&&(p.value?"#expression"!==p.value.kind?d.gc.error("options value must be an expression - e.g. options={{passive:true, once:true}}",p):c=p.value:d.gc.error("options value cannot be empty",p)):d.gc.error("Invalid param on event listener",p)}if(s){var f="",h="";s.code.match(/^\s*(\=\>)|(\(\s*\)\s*\=\>)/)&&(f=", 1"),c&&(h=", "+c.code,f=f||", 0"),a.push(""+d.indent+Rr("evt",o)+d.jsVarName+", "+d.cmVarName+", "+n+", "+r+', "'+t+'", '),Tr(a,s),a.push(""+f+h+");\n")}else d.gc.error("Missing listener parameter",e)}))},e.prototype.addInsInstruction=function(e,t,n,r,i){r.gc.imports["ζins"+Sr(i)]=1,r.instructions.push((function(t){var o=r,a=r.gc;!e.isOrphan&&e.defaultPropValue||a.templateArgs.indexOf("$")<0&&a.templateArgs.indexOf("$content")<0&&a.error("$ or $content must be defined as template arguments to use @content with no values",e),t.push(""+o.indent+Rr("ins",i)+o.jsVarName+", "+i+", "+n+", "),e.isOrphan||!e.defaultPropValue?t.push("$, 1);\n"):(Lr(t,e.defaultPropValue,o,i),t.push(");\n"))}))},e.prototype.addViewInstruction=function(e,t,n,r,i,o,a,s){var c,d="",l=0,u=s||"";if(i)c=i.gc,l=c.blockCount++,"cptContent"===t||"paramContent"===t?(u=i.indent,d=""):"asyncBlock"===t?(c.imports["ζasync"]=1,u=i.indent+c.indentIncrement,d=""):"jsBlock"===t&&(u=i.indent+c.indentIncrement,d="ζi"+l,c.localVars[d+" = 0"]=1,i.childViewIndexes.push(l));else{if(!a)throw new Error("ViewInstruction: either parentView or generationCtxt must be provided");l=(c=a).blockCount++,c.imports["ζinit"]=1,c.imports["ζend"]=1,c.statics[0]="ζs0 = {}"}var p={gc:c,indent:u,instructions:[],nodeCount:0,jsVarName:"ζ",cmVarName:"ζc",hasChildNodes:!1,childBlockIndexes:[],childViewIndexes:[],paramInstanceVars:void 0,asyncValue:0,exprCount:0,expr1Count:0,dExpressions:[],bindingsCount:0,update:function(e,t,n,r,a,s,d,l){p.indent=e,p.nodeCount=t,p.hasChildNodes=n,p.paramInstanceVars=l,p.asyncValue=r,p.exprCount=a,p.expr1Count=s,p.bindingsCount=d,i&&n&&(c.imports["ζview"+Sr(o)]=1,c.imports["ζend"+Sr(o)]=1)}};l>0&&(p.jsVarName="ζ"+l,p.cmVarName="ζc"+l,c.localVars[p.jsVarName]=1,c.localVars[p.cmVarName]=1);var f=this;function h(e){var a="#jsBlock"===n.kind;if(a){var s=n,u=s.args,h=s.name;if("$each"===h){var v;Array.isArray(u[0])?(f.fragmentMode&&(f.expressionRoots[u[0][0]]=1),v=u[0].join(".")):(v=u[0],f.fragmentMode&&(f.expressionRoots[v]=1));var m=++c.eachCount,g="let ζec"+m+"="+v+", ζl"+m+"=ζec"+m+"? ζec"+m+".length:0;",b="for (let ζx"+m+"=0;ζl"+m+">ζx"+m+";ζx"+m+"++) {",y="let "+u[1]+"=ζec"+m+"[ζx"+m+"]",x="",N="";u.length>2&&(x=", "+u[2]+"=ζx"+m),u.length>3&&(N=", "+u[3]+"=ζx"+m+"===ζl"+m+"-1"),s.startCode=g+b+y+x+N+";",s.endCode="}"}else!f.fragmentMode||"$if"!==h&&"$elseif"!==h||("$if"===h?s.startCode="if ("+s.args[0].join(".")+") {":"$elseif"===h&&(s.startCode="else if ("+s.args[0].join(".")+") {"),f.expressionRoots[u[0][0]]=1);e.push(c.decreaseIndent(p.indent)),e.push(s),s.startCode.match(/\n$/)||e.push("\n")}else if("asyncBlock"===t){var w=i;e.push(c.decreaseIndent(p.indent)),e.push(""+Rr("async",o)+w.jsVarName+", "+o+", "+r+", "),"number"==typeof p.asyncValue?e.push(""+p.asyncValue):Lr(e,p.asyncValue,w,o),e.push(", function () {\n")}if(p.instructions.length){var k="";if(p.childBlockIndexes.length){var I=c.statics,C=I.length;I.push("ζs"+C+" = ["+p.childBlockIndexes.join(", ")+"]"),k=", ζs"+C}if(p.hasChildNodes){var P="",V="ζ";if(i)p.childViewIndexes.length&&e.push(p.indent+"ζi"+p.childViewIndexes.join(" = ζi")+" = 0;\n"),V=i.jsVarName,P=d?", ++"+d:", 0";else{var $=[],j=c.localVars;for(var D in j)j.hasOwnProperty(D)&&$.push(D);$.push("ζc = ζinit(ζ, ζs0, "+p.nodeCount+")"),$.length&&e.push(p.indent+"let "+$.join(", ")+";\n")}l>0&&(e.push(""+p.indent+p.jsVarName+" = "+Rr("view",o)+V+", "+o+", "+r+", "+p.nodeCount+P+");\n"),e.push(""+p.indent+p.cmVarName+" = "+p.jsVarName+".cm;\n"))}if(void 0!==p.paramInstanceVars){$=[];for(var D in p.paramInstanceVars)p.paramInstanceVars.hasOwnProperty(D)&&$.push(p.paramInstanceVars[D]);e.push(""+p.indent+$.join(" = ")+" = 0;\n")}for(var O=0,E=p.instructions;O<E.length;O++){var A=E[O];"function"==typeof A?A(e):A.pushCode(e)}p.hasChildNodes&&e.push(""+p.indent+Rr("end",o)+p.jsVarName+", "+p.cmVarName+k+");\n")}if(a){var S=n;e.push(c.decreaseIndent(p.indent)),e.push(S.endCode),S.endCode.match(/\n$/)||e.push("\n")}else"asyncBlock"===t&&e.push(i.indent+"});\n")}return null!==e?e.instructions.push(h):this.processRoot=h,p},e}();function Sr(e){return e?"D":""}function Fr(e){return'"'+e.replace(Cr,"\\\\").replace(Ir,'\\"').replace(Pr,"\\n")+'"'}function Rr(e,t){return t?"ζ"+e+"D(":"ζ"+e+"("}function Lr(e,t,n,r){if("string"!=typeof t&&t.oneTime){var i=r?", 1":"";e.push("ζo("+n.jsVarName+", "+n.expr1Count+++", "+n.cmVarName+"? "),e.push(t),e.push(" : ζu"+i+")"),n.gc.imports["ζo"]=1,n.gc.imports["ζu"]=1}else 0===r?(e.push("ζe("+n.jsVarName+", "+n.exprCount+++", "),e.push(t),e.push(")")):(void 0===n.dExpressions[r]?n.dExpressions[r]=0:n.dExpressions[r]++,e.push("["+n.dExpressions[r]+", "),e.push(t),e.push("]")),n.gc.imports["ζe"]=1}function Tr(e,t){"#expression"===t.kind?e.push(t):"string"==typeof t?e.push(Fr(t)):e.push(""+t)}function _r(e,t,n,r,i,o,a,s,c,d){var l=o?"D":"",u=function(e){var t="",n="",r="";e.match(/(.*)\.([a-zA-Z_][a-zA-Z_0-9]*)$/)?(t=RegExp.$1,n='"'+RegExp.$2+'"'):r="Invalid binding expression: {="+e+"}";return{hostExp:t,propExp:n,errorMsg:r}}(t),p=u.hostExp,f=u.propExp,h=u.errorMsg;void 0!==d&&(d[Hr(p)]=1),h?r.gc.error(h,n):(r.gc.imports["ζbind"+Sr(o)]=1,e.push(i+"ζbind"+l+"("+r.jsVarName+", "+r.cmVarName+", "+(o?1:0)+", "+a+", "+s+", "+c+", "+p+", "+f+");\n"))}function Mr(e,t,n,r){var i="";if(t&&t.length){for(var o=e.gc.statics.length,a=0;t.length>a;a++)t[a]=Fr(t[a]);return i="ζs"+o,e.gc.statics[o]=i+" = ["+t.join(", ")+"]",[", "+r+", "+(n>-1?"ζs"+n:"0")+", ζs"+o,i]}return n>-1?[", "+r+", ζs"+n,""]:"0"!==r?[", "+r,""]:["",""]}function Br(e){return e.length>3?e.slice(0,-4):e}function Hr(e){var t=e.indexOf(".");return t>-1?e.slice(0,t):e}var Xr=function(){function e(e,t,n,r){this._defaultPrevented=!1,this._immediatePropagationStopped=!1,this._type=e,this._target=t,this._cancelable=n,this.data=r||null}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this._defaultPrevented},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"immediatePropagationStopped",{get:function(){return this._immediatePropagationStopped},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){this._cancelable&&(this._defaultPrevented=!0)},e.prototype.stopImmediatePropagation=function(){this._immediatePropagationStopped=!0},e}(),zr=function(){function e(){this._cancelableEvents=!1,this._target=null,this._eventType=""}return e.prototype.init=function(e,t){this._eventType||(this._eventType=e,this._target=t||null)},Object.defineProperty(e.prototype,"listenerCount",{get:function(){return this._listeners?this._listeners.length:0},enumerable:!0,configurable:!0}),e.prototype.addListener=function(e){return this._listeners?this._listeners.push(e):this._listeners=[e],e},e.prototype.removeListener=function(e){var t=this._listeners;if(t)if(1===t.length&&t[0]===e)this._listeners=void 0;else{var n=t.indexOf(e);n>-1&&t.splice(n,1)}},e.prototype.removeAllListeners=function(){this._listeners=void 0},e.prototype.emit=function(e){if(this._listeners){for(var t=new Xr(this._eventType,this._target,this._cancelableEvents,e||null),n=!0,r=0,i=this._listeners;r<i.length;r++){if((0,i[r])(t),t.defaultPrevented&&(n=!1),t.immediatePropagationStopped)break}return n}return!0},e}(),Kr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(zr),Jr=(function(e){function n(){var t=e.call(this)||this;return t._cancelableEvents=!0,t}t(n,e)}(zr),void 0),Ur="$fragment",Wr="ζtemplate",Zr=function(){function e(){this.kind=Ur,this.ΔΔtemplate=""}return e.prototype.ΔDefault=function(e){switch(e){case"kind":return Ur;case"template":return""}return T},n([L(M),r("design:type",String)],e.prototype,"kind",void 0),n([L(M),r("design:type",String)],e.prototype,"template",void 0),e=n([R],e)}();function qr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=new Zr;if(0===t.length)return r.template=e[0],r;for(var i=[],o=e.length,a=t.length,s=0;o>s;s++)i.push(e[s]),s<a&&i.push(t[s].kind===Ur?t[s].template:t[s]);return r.template=i.join(""),r}function Yr(e,t,n,r){return i(this,void 0,void 0,(function(){var i,a,s;return o(this,(function(o){switch(o.label){case 0:if("$fragment"!==e.kind)throw"Invalid $fragment template";return e.createInstance!==Jr&&e[Wr]===e.template?[3,2]:[4,Nr(e.template,new Ar,{templateName:"testTpl",filePath:"[$fragment string]",statics:!0,function:!0,templateType:"$fragment",preProcessors:r?r.preProcessors:void 0})];case 1:i=o.sent(),a=new Function("ζr",i.function||""),e.createInstance=a(Bt),e[Wr]=e.template,o.label=2;case 2:return s=e.createInstance(),r&&r.doc&&(s.document=r.doc),s.attach(t),s.render(n!==Jr?{context:n}:Jr),[2,s]}}))}))}var Gr,Qr,ei,ti,ni,ri,ii,oi=Et(function(){function e(){}return n([At,Ft,r("design:type",Object)],e.prototype,"ΔΔvalue",void 0),n([wt(),r("design:type",Object)],e.prototype,"value",void 0),n([wt(It(),2),r("design:type",Object)],e.prototype,"context",void 0),n([wt(0,2),r("design:type",Object)],e.prototype,"doc",void 0),n([Ft,r("design:type",Object)],e.prototype,"ΔΔ$targetElt",void 0),n([wt(),r("design:type",Object)],e.prototype,"$targetElt",void 0),n([wt(kt(Kr)),r("design:type",Kr)],e.prototype,"completeEmitter",void 0),e=n([jt],e)}(),(function(e){var t,n,r=!1,a=!0,s="";return{$render:function(){return i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return a?(a=!1,void 0===e.value?[3,2]:(r=!0,[4,c(e.value)])):[3,4];case 1:return i.sent(),[3,3];case 2:throw"Missing value param";case 3:return[3,7];case 4:return r?e.value!==t||e.value.template!==s?[3,5]:(n!==Jr&&n.render({context:e.context}),[3,7]):[3,7];case 5:return n&&n.dispose(),[4,c(e.value)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))}};function c(r){return i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:if(t=r,r===Jr||"$fragment"!==r.kind)throw"@fragment value must be a $fragment object";return[4,Yr(r,e.$targetElt,e.context,{doc:e.doc})];case 1:return n=i.sent(),s=r.template,e.completeEmitter.emit(),[2]}}))}))}})),ai=qr(ni||(ni=a(["<!><div class='special'><div class='info'>special characters:</> Angle brackets: !< and !> <br/> Non-breaking space: \"!s!s!s!s!s!s!s\" (vs \" \")<br/> Bang: !! <br/> New line: !n(discarded by HTML parser)<br/></></>"],["<!><div class='special'><div class='info'>special characters:</> Angle brackets: !< and !> <br/> Non-breaking space: \"!s!s!s!s!s!s!s\" (vs \" \")<br/> Bang: !! <br/> New line: !n(discarded by HTML parser)<br/></></>"]))),si=qr(ri||(ri=a(["<!><div class='info'>xtr content...</><*alert type='warning'><.title><b> Important! </>: </> Some important message... </></>"],["<!><div class='info'>xtr content...</><*alert type='warning'><.title><b> Important! </>: </> Some important message... </></>"]))),ci=qr(ii||(ii=a(["<!> fragment strings also accept cdata sections: <div><div class='info'>(before the cdata section)</><!cdata>\n            // Here content doesn't need to be encoded:\n            <div> Hello World! </div>\n            Only end of cdata needs to be escaped: !</!cdata> ...\n        </!cdata><div class='info'>(after the cdata section)</></></>"],["<!> fragment strings also accept cdata sections: <div><div class='info'>(before the cdata section)</><!cdata>\n            // Here content doesn't need to be encoded:\n            <div> Hello World! </div>\n            Only end of cdata needs to be escaped: !</!cdata> ...\n        </!cdata><div class='info'>(after the cdata section)</></></>"]))),di={helloClass:"blue",alert:(Gr={},Qr=["class","title"],ei=[2,3],ti=function(){function e(){this.ΔΔtype=""}return e.prototype.ΔDefault=function(e){switch(e){case"type":return""}return Vt},n([wt(),r("design:type",Object)],e.prototype,"type",void 0),n([wt(),r("design:type",Object)],e.prototype,"$content",void 0),n([wt(),r("design:type",Object)],e.prototype,"title",void 0),e=n([Nt],e)}(),Fe("alert",".../fragment2/fragment2.ts",Gr,(function(e,t,n){var r,i,o=n.type,a=(n.$content,n.title),s=0,c=0,d=Le(e,0,5);Je(e,d,0,0,"div",1),ot(e,0,0,"class",qe(e,0,"alert "+o)),Je(e,d,1,1,"span",1,0,Qr),Qe(e,d,2,2,1),Qe(e,d,3,2,1),a?(Ge(r=Te(e,0,2,1,++s),r.cm,0,0),bt(r,0,0,qe(r,0,a)),Ke(r)):(Ze(i=Te(e,0,3,1,++c),i.cm,0,0,0,0," Warning: ",0),Ke(i)),Ge(e,d,4,1),bt(e,0,4,t,1),Ke(e,0,ei)}),ti))};(function(){var e={},t=["type","radio","value","A"],i=["type","radio","value","B"],o=["type","radio","value","C"],a=["class","output"],s=function(){function e(){this.ΔΔselection="A"}return e.prototype.ΔDefault=function(e){switch(e){case"selection":return"A"}return Vt},n([wt(Ct),r("design:type",String)],e.prototype,"selection",void 0),e=n([Nt],e)}();return Fe("main",".../fragment2/fragment2.ts",e,(function(e,n,r,s){var c=r.selection,d=Le(e,0,19);Ge(e,d,0,0);var l="type"+s.uid;Je(e,d,1,1,"span",1),Ze(e,d,0,2,2,0," Choose your content: ",0),Je(e,d,3,1,"label",1),Je(e,d,4,2,"input",0,0,t),ot(e,0,4,"name",qe(e,0,l)),pt(e,d,0,5,4,"value",Ut,2),lt(e,d,0,5,0,0,r,"selection"),mt(e,d,0,5),Ze(e,d,0,6,2,0," A ",0),Je(e,d,7,1,"label",1),Je(e,d,8,2,"input",0,0,i),ot(e,0,8,"name",qe(e,1,l)),pt(e,d,0,9,8,"value",Ut,2),lt(e,d,0,9,0,0,r,"selection"),mt(e,d,0,9),Ze(e,d,0,10,2,0," B ",0),Je(e,d,11,1,"label",1),Je(e,d,12,2,"input",0,0,o),ot(e,0,12,"name",qe(e,2,l)),pt(e,d,0,13,12,"value",Ut,2),lt(e,d,0,13,0,0,r,"selection"),mt(e,d,0,13),Ze(e,d,0,14,2,0," C ",0),Je(e,d,15,1,"div",1,0,a),Ze(e,d,0,16,2,0," Output: ",0);var u="A"===c?ai:"B"===c?si:ci;Je(e,d,17,1,"div",0),pt(e,d,0,18,17,"fragment",oi,2),st(e,d,0,18,"value",qe(e,3,u)),st(e,d,0,18,"context",qe(e,4,di)),mt(e,d,0,18),Ke(e)}),s)})()().attach(document.body).render()}();
