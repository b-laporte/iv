!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};function t(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var a="ΔTrackable",s="ΔChangeVersion",c="ΔFactory",d="ΔDefFactories",l="ΔIsFactory",u="ΔΔProxy",p="ΔIsProxy",f="ΔDefault",h="ΔCreateProxy",m="ΔnewItem",v="Δdispose",g="Δjson",b=!1;function y(e){return e&&e.ΔTrackable?e.ΔMd?e.ΔMd:e.ΔMd={parents:void 0,refreshCtxt:void 0,watchers:void 0}:null}var x=Array.isArray;function N(e,t){e&&(x(e)&&!e[p]?e.forEach(t):t(e))}function w(e,t){if(e&&t){if(e===t)return;if(x(e)){var n=e;if(1===n.length){if(n[0]===t)return}else{var r=n.indexOf(t);if(r>-1)return n.splice(r,1),1===n.length?n[0]:n}}}return e}function k(e,t){return e?x(e)&&!e[p]?(e.push(t),e):[e,t]:t}function I(e){return e&&!0===e[a]?e[s]:0}function C(e,t){if(void 0===t&&(t=!1),$(e)){e[v]?e[v](t):P(e,(function(n,r){q(e,r),e["ΔΔ"+n]=void 0,t&&C(r,!0)}));var n=e.ΔMd;if(n){var r=[];N(n.parents,(function(e){r.push(e)}));for(var i=function(t){P(t,(function(n,r){r===e&&(q(t,e),t["ΔΔ"+n]=void 0)})),Z(t)},o=0,a=r;o<a.length;o++){i(a[o])}}}}function P(e,t){if($(e)){var n=e.constructor.prototype["ΔDefFactories"];for(var r in n)n.hasOwnProperty(r)&&t(r,e["ΔΔ"+r],n[r])}}function V(e,t){return!(!e||"object"!=typeof e)&&"ΔΔ"+t in e}function $(e){return!(!e||!0!==e[a])}function j(e){return I(e)%2==1}function D(e,t){var n=y(e);return n&&t?(n.watchers=k(n.watchers,t),j(e)&&te.register(e),t):null}function O(e,t){var n=e?e.ΔMd:void 0;n&&t&&(n.watchers=w(n.watchers,t))}function E(e,t){if(e&&void 0!==t){if(e[m])return e[m](t);b=!0;var n=e[t];return b=!1,n}}function A(e,t){if(e&&t){var n=e[f];if(n){var r=n(t);if(r!==L)return e[t]=r}var i=e[d],o=i?i[t]:null;if(o)return e[t]=o()}}var S=function(){var e,t,n=[],r=[],i={getDefaultConversion:function(){return o(e,i)},getPreviousConversion:function(){return e.ΔtoJsResult}};function o(e,n){var r=n.getPreviousConversion();if(r)return r;var i=void 0;if(e.Δconvert)i=e.Δconvert(t);else{if(e["Δjson"])return e["Δjson"];i={},P(e,(function(e,n){$(n)&&(n=a(n,t)),void 0!==n&&(i[e]=n)}))}return i}function a(a,s){var c=0===n.length,d=a;if(a&&$(a)&&(n.push(a),d=void 0,r.push(a),e=a,s?(t=s,d=s(a,i)):d=o(a,i),a.ΔtoJsResult=d,r.pop(),e=r[r.length-1]),c){for(var l=n.length;l--;)n[l]["ΔtoJsResult"]=void 0;e=null,n=[],t=void 0}return d}return a}();function F(e){var t=e.prototype;t[a]=!0,t[s]=0}function R(e,t){return e||(e=z,t=3),function(n,r){var i="ΔΔ"+r,o=n[d];o||(o=n[d]={}),o[r]=t?1===t?z:J:e,n[i]=void 0,function(e,t,n,r){r&&delete e[t]&&Object.defineProperty(e,t,r)}(n,r,0,{get:function(){return function(e,t,n,r,i){e.ΔComputeDependencies&&(e.ΔComputeDependencies[n]=!0);!b&&e[g]&&function(e,t){var n,r;t&&P(e,(function(i,o,a){var s=a===U;if(n=t[i],r="ΔΔ"+i,void 0===n)s&&(e[r]=void 0);else{var c=typeof n;if(null===n)(s||a===K)&&(e[r]=null);else if("object"===c){var d=E(e,i);d?d[g]=n:s&&(e[r]=n)}else"string"===c?(s||a===_)&&(e[r]=n):"number"===c?(s||a===B)&&(e[r]=n):"boolean"===c?(s||a===X)&&(e[r]=n):s&&(e[r]=n)}})),e[g]=void 0}(e,e[g]);var o=e[t];(void 0===o||b&&null===o)&&(o=e[t]=!b&&i?i>1?void 0:null:r(),Y(e,o));return o}(this,i,r,e,t)},set:function(t){W(this,r,i,t,e,this)},enumerable:!0,configurable:!0})}}var L={};function T(){return""}T[l]=!0;var _=T;function M(){return 0}M[l]=!0;var B=M;function H(){return!1}H[l]=!0;var X=H;function z(){return null}z[l]=!0;var K=z;function J(){}J[l]=!0;var U=J;function W(e,t,n,r,i,o){var a=$(r),s=i===U;if(!e.ΔComputeDependencies){r&&!a&&i.ΔCreateProxy&&(a=$(r=i.ΔCreateProxy(r)||r));var c=!1,d=o[n];return j(e)?c=d!==r:d!==r&&(Z(e),c=!0),c&&(a&&void 0===r&&(r=null),(a||d&&$(d))&&function(e,t,n,r){q(e,t),r||Y(e,n)}(e,d,r,s),o[n]=r,function(e,t,n,r,i){var o=e?e.ΔMd:void 0;if(o&&o.trackers){var a=e[u]||e;N(o.trackers,(function(e){e(a,t,n,r,i)}))}}(e,"set",t,d,r)),r}console.error("[Trax] @computed properties must not mutate the Data object when calculated")}function Z(e){if($(e)){var t=!0;if(j(e)?t=!1:e.ΔChangeVersion+=1,te.register(e),t){var n=e.ΔMd;n&&n.parents&&N(n.parents,(function(e){Z(e)}))}}}function q(e,t){if(t){var n=t.ΔMd;n&&n.parents&&(n.parents=w(n.parents,e))}}function Y(e,t){if(t){var n=y(t);n&&(n.parents=k(n.parents,e))}}var G=0,Q=function(){function e(){this.id=++G}return e.prototype.register=function(e){var t=this,n=y(e);n&&!n.refreshCtxt&&(this.objects?this.objects.push(e):(this.objects=[e],Promise.resolve().then((function(){t.refresh()}))),n.refreshCtxt=this)},e.prototype.refresh=function(e){void 0===e&&(e=!0);var t=this.objects,n=t?t.length:0;if(n){ne();for(var r,i,o=[],a=0;n>a;a++)(i=(r=t[a]).ΔMd).refreshCtxt&&(r.ΔChangeVersion%2&&(r.ΔChangeVersion+=1),i.refreshCtxt&&i.watchers&&o.push({dataNode:r,watchers:i.watchers})),i.refreshCtxt=void 0;this.objects=void 0,o.length&&(e?ee(o):Promise.resolve().then((function(){ee(o)})))}},e}();function ee(e){for(var t=function(e){N(e.watchers,(function(t){t(e.dataNode)}))},n=0,r=e;n<r.length;n++){t(r[n])}}var te=new Q;function ne(){te.objects&&(te=new Q)}var re=/^\Δ/,ie=function(){function e(e){this.ΔTrackable=!0,this.ΔDataFactory=!0,this.ΔChangeVersion=0,this.ΔMd=void 0,this.ΔΔSelf=this,this.ΔIsProxy=!1,this.ΔItemFactory=e}return e.ΔNewProxy=function(t){var n=new Proxy({},new e(t));return n[u]=n,n},e.ΔCreateProxy=function(t,n){if("object"==typeof t){var r=new Proxy(t,new e(n));for(var i in Z(r),t)t.hasOwnProperty(i)&&Y(r,t[i]);return r}return null},e.prototype.ΔnewItem=function(e){var t=this.ΔItemFactory();return W(this.ΔΔSelf,e,e,t,this.ΔItemFactory,this.ΔΔDict)},e.prototype.Δdispose=function(e){void 0===e&&(e=!1);var t,n=this.ΔΔDict;for(var r in n)n.hasOwnProperty(r)&&(t=n[r],q(this.ΔΔSelf,t),n[r]=void 0,e&&C(t,!0));return n},e.prototype.Δconvert=function(e){var t={},n=this.ΔΔDict;for(var r in n)n.hasOwnProperty(r)&&(t[r]=S(n[r],e));return t},e.prototype.ΔinitFromJson=function(){var e=this["Δjson"];if(e){if(e.constructor!==Object)console.error("[Trax] Invalid json type: Dictionaries can only be initialized from Objects");else{var t=this.ΔΔDict,n=void 0,r=void 0;for(var i in e)if(e.hasOwnProperty(i))if(r=n=e[i],n){var o=this.ΔItemFactory();$(o)&&(o["Δjson"]=n,r=o),t[i]=r}else null===n&&(t[i]=null)}this["Δjson"]=void 0}},e.prototype.ΔToString=function(){return"Trax Dict {...}"},e.prototype.set=function(e,t,n){return this.ΔΔDict||(this.ΔΔDict=e),t.match(re)?this[t]=n:W(this.ΔΔSelf,t,t,n,this.ΔItemFactory,this.ΔΔDict),!0},e.prototype.get=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),t===p||(this["Δjson"]&&this.ΔinitFromJson(),t===Symbol.iterator?this.ΔΔDict[Symbol.iterator]:"string"===typeof t?t.match(re)?this[t]:this.ΔΔDict[t]:this[t])},e.prototype.deleteProperty=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),!t.match(re)&&(W(this.ΔΔSelf,t,t,null,this.ΔItemFactory,this.ΔΔDict),delete this.ΔΔDict[t],!0)},e}();function oe(e){function t(){return ie.ΔNewProxy(e)}return e=e||K,t[l]=!0,t[h]=function(t){return ie.ΔCreateProxy(t,e)},t}var ae=oe;var se=0,ce={log:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,arguments)},error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,arguments)}};function de(e,t){for(var n=e,r=[];n;){if(n.template){var i=n.template;r.push('\n>> Template: "'+i.templateName+'" - File: "'+i.filePath+'"')}n=n.parentView}ce.error("IVY: "+t+r.join(""))}var le=void 0,ue=11,pe="$api",fe=/^ΔΔ(\w+)Emitter$/,he=/^ΔΔ/,me=/^ΔΔ(.+)$/,ve=/([^ ]+)\s([^ ]+)/,ge="ΔIsAPI",be="ΔIsController",ye="ΔDefaultParam",xe="ΔIoParams",Ne="ΔRequiredProps",we={$targetApi:"$1 cannot be used on DOM nodes",$targetElt:"$1 cannot be used on components that don't define #main elements"},ke=0,Ie=function(){function e(e,t,n,r,i,o){this.templateName=e,this.filePath=t,this.staticCache=n,this.renderFn=r,this.$Class=i,this.$contextIdentifiers=o,this.kind="$template",this._uid=++ke,this.tplApi=void 0,this.tplCtl=void 0,this.forceRefresh=!1,this.activeWatch=!1,this.lastRefreshVersion=0,this.processing=!1,this.rendering=!1,this.initialized=!1,this.labels=void 0,this.hasCtlClass=!1,this.$contextInitialized=!1,this.view=je(null,null,1,this);var a=this;this.watchCb=function(){a.notifyChange()},this.watchCb.$templateId=this._uid,this.$Class!==le&&(jt(this.$Class,be)?this.hasCtlClass=!0:jt(this.$Class,ge)||$(this.$Class.prototype)||de(this.view,"Type of $ argument must be either a @Controller, an @API or a @Data class"))}return e.prototype.dispose=function(e){void 0===e&&(e=!0);var t=this.view;this.disconnectObserver(),Pe(t,this.tplCtl,"$dispose",this.templateName),e&&t&&t.nodes&&t.nodes.length&&(yt(t,t.nodes[0]),t.anchorNode&&(t.rootDomNode.removeChild(t.anchorNode),t.anchorNode=null))},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.view.doc},set:function(e){this.view.doc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){if(!this.tplApi)if(this.hasCtlClass){var e=this.controller;e&&e.$api&&(this.tplApi=e.$api)}else this.$Class?(this.tplApi=new this.$Class,Ce(this.view,this.tplApi,this.staticCache)):this.$contextIdentifiers?this.tplApi=function(e){return void 0!==e?(t[l]=!0,oe(t)()):oe()();function t(){return new e}}():this.tplApi={};return this.tplApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){if(!this.tplCtl&&this.hasCtlClass){var e=this.tplCtl=new this.$Class;if(V(e,"$template")&&(e.$template=this),V(e,"$logger")){var t=this.view;e.$logger={log:ce.log,error:function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];de(t,e+(n.length?" "+n.join(" "):""))}}}e[pe]&&Ce(this.view,e[pe],this.staticCache)}return this.tplCtl},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){if(this.view.rootDomNode)de(this.view,"Template host cannot be changed once set");else{var t=this.view;if(!t.doc)throw new Error("[iv] Template.document must be defined before calling Template.attach()");t.rootDomNode=e,t.anchorNode=t.doc.createComment("template anchor"),Ft(t.anchorNode,e)}return this},e.prototype.registerLabel=function(e,t){this.labels||(this.labels={});var n=this.labels[e];n?n.push(t):n=this.labels[e]=[t]},e.prototype.query=function(e,t){if(void 0===t&&(t=!1),this.rendering)return null;for(var n=[],r=0,i=e.split(";");r<i.length;r++){var o=i[r];if(o&&"#"!==o.charAt(0))return de(this.view,"[$template.query()] Invalid label argument: '"+o+"' (labels must start with #)"),null;var a=this.labels&&this.labels[o]||null;if(a&&a.length){if(!t)return a[0];n=n.concat(a)}}return n.length?n:null},e.prototype.notifyChange=function(){this.render()},e.prototype.disconnectObserver=function(){this.activeWatch&&(O(this.api,this.watchCb),O(this.controller,this.watchCb),this.activeWatch=!1)},e.prototype.render=function(e,t){if(void 0===t&&(t=!1),this.processing)return this;t&&(this.forceRefresh=!0),this.processing=!0;var n=this.api,r=this.controller,i=this.view,o=this.$contextIdentifiers;r&&!$(r)&&(de(i,"Template controller must be a @Controller Object - please check: "+this.$Class.name),this.tplCtl=this.$Class=void 0);var a=!1;if(n&&e)if(o!==le){var s=e.context;s!==le&&"object"==typeof s&&(a=!0)}else for(var c in j(n)||ne(),this.disconnectObserver(),e)e.hasOwnProperty(c)&&(n[c]=e[c]);if(this.$contextInitialized&&(a=!0),a){var d="",l=(e?e.context:null)||n.$context;if(l){for(var u=0;o.length>u;u++)n[d=o[u]]=l[d];n.$context=l,this.$contextInitialized=!0}}o===le||this.$contextInitialized||de(i,"Missing $fragment context");var p=!this.forceRefresh,f=i.nodes;if(f&&f[0]&&f[0].attached||(p=!1),p&&I(n)+I(r)>this.lastRefreshVersion&&(p=!1),!p){r&&(this.initialized||(Pe(i,r,"$init","controller"),this.initialized=!0),Pe(i,r,"$beforeRender","controller")),this.rendering=!0,this.labels=void 0,i.lastRefresh++,i.instructions=void 0;try{this.renderFn(i,this.hasCtlClass?r:n,n,this)}catch(e){de(i,"Template execution error\n"+(e.message||e))}this.rendering=!1,r&&Pe(i,r,"$afterRender","controller"),function(e,t){if(void 0===t&&(t=!1),e){var n=e.ΔMd;n&&n.refreshCtxt?n.refreshCtxt.refresh(!0):t&&ne()}}(n),this.forceRefresh=!1,this.lastRefreshVersion=I(n)+I(r)}return this.activeWatch||(D(n,this.watchCb),r&&D(r,this.watchCb),this.activeWatch=!0),this.processing=!1,this},e}();function Ce(e,t,n){var r=n.events;if(void 0===r){var i=void 0;for(var o in t)if(o.match(fe)){var a=RegExp.$1;i||(i=[]),"function"!=typeof t[a+"Emitter"].init?de(e,"Invalid EventEmitter: "+a+"Emitter"):(i.push(a+"Emitter"),i.push(a),t[a+"Emitter"].init(a,t))}n.events=i||null}else if(null!==r)for(var s=r.length,c=0;s>c;c+=2)t[r[c]].init(r[c+1],t)}function Pe(e,t,n,r){if(t&&"function"==typeof t[n]){var i=void 0;try{void 0!==(i=t[n]())&&"function"==typeof i.catch&&i.catch((function(t){de(e,r+" "+n+" hook execution error\n"+(t.message||t))}))}catch(t){de(e,r+" "+n+" hook execution error\n"+(t.message||t))}}}function Ve(e,t){return(t=t||this.namespace)?this.doc.createElementNS(t,e):this.doc.createElement(e)}function $e(){return function(e){if(e!==le&&null!==e){var t=!0;return Lt(e,!1,(function(e){if(!t)return!1;var n=e.kind;if("#view"===n){var r=e;if(r.cm){var i=r.doc.createDocumentFragment();r.domNode=i,r.cmAppends=[function(e){e.domNode?Ft(e.domNode,i):e.domNode=i}]}Me(r)}else if("#element"===n||"#text"===n)return t=!1;return!0})),t}return!0}(this)}function je(e,t,n,r){var i={kind:"#view",uid:"view"+ ++se,attached:!1,nodes:null,namespace:void 0,namespaces:void 0,doc:null,parentView:e,cm:!0,cmAppends:null,lastRefresh:0,container:null,projectionHost:null,template:r,rootDomNode:null,anchorNode:null,expressions:void 0,oExpressions:void 0,instructions:void 0,paramNode:void 0,createElement:Ve,isEmpty:$e};return e?Ae(i,e,t):i.doc="undefined"!=typeof document?document:null,i}function De(e,t,n){if(n){var r=Ee(e);if(r!==le&&null!==r)for(var i=r.template,o=n.length,a=0;o>a;a++)i.registerLabel(n[a],t)}}function Oe(e,t,n){if(0!==n){var r=Ee(e);r!==le&&null!==r&&r.template.registerLabel(n,t)}}function Ee(e){for(var t=e;t&&!t.template;)t=t.parentView;return t}function Ae(e,t,n){if(e.parentView=t,e.doc=t.doc,e.container=n,e.rootDomNode=t.rootDomNode,t.namespace){var r=t.namespace;e.namespace=r,e.namespaces=[r]}}function Se(e,t,n,r,i,o){return function(){return new Ie(e,t,n,r,i,o)}}var Fe=[];function Re(e,t,n){var r=e.cm;return r?(e.nodes=new Array(n),e.cmAppends||(e.cmAppends=[],e.anchorNode&&(e.cmAppends[0]=function(t,n){t.domNode?Rt(t.domNode,e.anchorNode,e.rootDomNode):t.domNode=e.rootDomNode}))):e.cmAppends=null,r}function Le(e,t,n,r,i){var o,a=e.nodes[n];if(a&&a.attached||de(e,"Invalid ζview call: container must be attached ("+(a?a.uid:"XX")+") - pview: "+e.uid+" containerIdx: "+n),"#container"===a.kind)if("##block"===a.subKind){var s=(c=a).views;1===i&&(c.insertFn=null),1===i&&c.views.length>1?(c.previousNbrOfViews=s.length,o=s.shift(),c.viewPool.length?c.viewPool=s.concat(c.viewPool):c.viewPool=s,c.views=[o]):(o=c.views[i-1])||(c.viewPool.length>0?(c.insertFn||(c.insertFn=Be(e,c)),Xe((o=s[i-1]=c.viewPool.shift()).nodes[0],c.insertFn),o.attached=!0):((o=s[i-1]=je(e,c)).nodes=new Array(r),e.cm&&c.cmAppend?o.cmAppends=[c.cmAppend]:e.cm||(o.cmAppends=[Be(e,c)]))),c.lastRefresh=o.lastRefresh=e.lastRefresh}else{var c;(o=(c=a).contentView)||((o=c.contentView=je(e,c)).nodes=new Array(r)),o.lastRefresh=e.lastRefresh}else if("#param"===a.kind){var d=a;(o=d.contentView)||(o=d.contentView=je(e,null),d.viewPool&&(d.viewPool[d.viewInstanceIdx]=o),o.nodes=new Array(r),o.paramNode=d),o.lastRefresh=e.lastRefresh}return o}function Te(e,t,n){var r=t.nodes[n];"#container"===r.kind&&!e.cmAppends&&r.cmAppend&&(e.cmAppends=[r.cmAppend])}function _e(e,t,n){e.instructions.push(t),e.instructions.push(n)}function Me(e){if(e.instructions){var t=e.instructions.slice(0),n=t.length;if(e.instructions.splice(0,n),e.instructions=void 0,n)for(var r=0;n>r;r+=2)t[r].apply(null,t[r+1])}}function Be(e,t){var n=function e(t,n){for(;;){if(n||de(t,"Internal error - findNextSiblingDomNd: nd cannot be undefined"),0===n.idx){if(!n.attached)return{position:"defer",parentDomNd:void 0};if(n.domNode.nodeType===ue)return{position:"lastChild",parentDomNd:n.domNode};var r=t.parentView;if(r){if(t.projectionHost){var i=t.projectionHost.hostNode;return"#element"===i.kind?{position:"lastChild",parentDomNd:i.domNode}:e(t.projectionHost.view,i)}if(t.container&&"##block"===t.container.subKind){var o=t.container,a=o.views.indexOf(t);if(a>-1)for(var s=void 0,c=void 0,d=a+1;d<o.views.length;d++)if((s=o.views[d]).nodes&&s.nodes.length&&(c=v(s,s.nodes[0],o.domNode)))return c;for(var l=o.viewPool,u=void 0,p=0,f=l;p<f.length;p++){if((s=f[p]).nodes&&s.nodes.length&&s.attached&&(u=v(s,s.nodes[0],o.domNode)))return u}}return e(r,t.container)}return{position:"lastOnRoot",parentDomNd:t.rootDomNode,nextDomNd:t.anchorNode}}if(!n.nextSibling){var h=t.nodes[n.parentIdx];return"#element"===h.kind?{position:"lastChild",parentDomNd:bt(t,n)}:e(t,h)}var m=v(t,n.nextSibling,bt(t,n));if(m)return m;n=n.nextSibling}function v(e,t,n){if(!t)return null;if("#element"===t.kind||"#text"===t.kind)return{position:"beforeChild",nextDomNd:t.domNode,parentDomNd:n};if("#fragment"===t.kind){for(var r=void 0,i=t.firstChild;i;){if(r=v(e,i,n))return r;i=i.nextSibling}if(t.contentView){var o=t.contentView;if(o.nodes)return v(o,o.nodes[0],n)}return null}if("#container"===t.kind){var a=t;r=null;if("##block"===a.subKind)for(var s=a.views,c=s.length,d=0;c>d&&!(r=v(s[d],s[d].nodes[0],n));d++);else if("##cpt"===a.subKind){var l=a.template.view;r=v(l,l.nodes[0],n)}return r||null}throw new Error("TODO findFirstDomNd: "+t.kind)}}(e,t),r=n.position,i=n.nextDomNd,o=n.parentDomNd;return"beforeChild"===r||"lastOnRoot"===r?function(e,t){e.domNode?Rt(e.domNode,i,o):e.domNode=o}:"lastChild"===r?function(e,t){e.domNode?Ft(e.domNode,o):e.domNode=o}:function(){console.warn("TODO: VALIDATE VIEW APPEND: ",r),function(e,t,n){void 0===t&&(t="");n&&e.uid!==n||(console.log(""),console.log(Tt),t&&console.log(t+":"),function e(t,n){void 0===n&&(n="");if(!t.nodes)return void console.log(""+n+t.uid+" - no nodes");var r=t.parentView?t.parentView.uid:"XX",i=t.projectionHost,o=i?" >>> projection host: "+i.hostNode.uid+" in "+i.view.uid:"";console.log(n+"*"+t.uid+"* cm:"+t.cm+" isTemplate:"+(void 0!==t.template)+" parentView:"+r+o);for(var a,s=t.nodes.length,c="",d=0;s>d;d++)if(a=t.nodes[d])if(c=a.uid.length<5?["     ","    ","   ","  "," "][a.uid.length]:"","#container"===a.kind){var l=a,u=l.domNode?l.domNode.uid:"XX";if(console.log(n+"["+d+"] "+a.uid+c+" "+u+" attached:"+(a.attached?1:0)+" parent:"+k(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")),"##block"===l.subKind){var p=l,f=p.views.length;if(f)for(var h=0;f>h;h++)if(p.views[h]){var m=p.views[h];u=m.rootDomNode?m.rootDomNode.$uid:"XX",console.log(n+"  - view #"+h),e(p.views[h],"    "+n)}else console.log(n+"  - view #"+h+" UNDEFINED");else console.log(n+"  - no child views")}else if("##cpt"===l.subKind){var v=l,g=v.template,b=v.contentView;b?(console.log(n+"  - light DOM:"),e(b,"    "+n)):console.log(n+"  - light DOM: none"),g?(console.log(n+"  - shadow DOM:"),e(g.view,"    "+n)):console.log(n+"  - no template")}else console.log(n+"  - "+l.subKind+" container")}else{u=a.domNode?a.domNode.uid:"XX";var y="";if(a.domNode&&"#text"===a.kind)y=" text=#"+a.domNode._textContent+"#";else if("#fragment"===a.kind||"#element"===a.kind){for(var x=[],N=a.firstChild;N;)x.push(N.uid),N=N.nextSibling;y=" children:["+x.join(", ")+"]";var w=a.contentView;w&&(y+=" >>> content view: "+w.uid)}console.log(n+"["+a.idx+"] "+a.uid+c+" "+u+" attached:"+(a.attached?1:0)+" parent:"+k(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")+y)}else console.log(n+"["+d+"] XX");function k(e){return e<0?"X":e}}(e))}(e,"getViewInsertFunction for "+t.uid)}}function He(e,t,n){var r=e.nodes[t];if(r&&"##block"===r.subKind){var i=r,o=i.lastRefresh;if(n||o===e.lastRefresh){var a=i.views.length;if(!n){if(a!==i.previousNbrOfViews)for(var s=i.viewPool,c=s.length,d=void 0,l=0;c>l;l++)yt(d=s[l],d.nodes[0]),d.attached=!1;i.previousNbrOfViews=a}}else yt(e,i)}}function Xe(e,t,n){if(!e.attached){if(t(e,!0),e.attached=!0,"#fragment"===e.kind)for(var r=e.firstChild;r;)Xe(r,t),r=r.nextSibling;else if("#container"===e.kind){var i=e.subKind;if("##cpt"===i){var o=e.template,a=o?o.view.nodes[0]:null;o&&(o.forceRefresh=!0),a&&(Xe(a,t),o.view.attached=!0)}else if("##block"===i)for(var s=e.views,c=0;s.length>c;c++)Xe(s[c].nodes[0],t),s[c].attached=!0}if("#fragment"===e.kind||"#element"===e.kind){var d=e.contentView;d&&(Xe(d.nodes[0],t),d.attached=!0)}}}function ze(e,t,n){if(n)for(var r=n.length,i=0;r>i;i++)He(e,n[i],e.cm);e.cm&&(e.cm=!1,e.cmAppends=null)}function Ke(e,t,n,r,i,o,a,s,c){if(t){var d=e.createElement(i);if(s)for(var l=s.length,u=0;l>u;u+=2)d.setAttribute(s[u],s[u+1]);if(c){l=c.length;for(var p=0;l>p;p+=2)d[c[p]]=c[p+1]}var f={kind:"#element",uid:"elt"+ ++se,idx:n,parentIdx:-1,ns:"",domNode:d,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=f,De(e,d,a),e.cmAppends[r](f,!1),o&&(e.cmAppends[r+1]=function(e,t){e.domNode?Ft(e.domNode,d):e.domNode=d,t||Ue(f,e)})}else a&&De(e,e.nodes[n].domNode,a)}function Je(e,t,n){if(n)e.namespaces?e.namespaces.push(n):e.namespaces=[n],e.namespace=n;else{var r=e.namespaces.length;1===r?e.namespace=e.namespaces=void 0:(e.namespaces.pop(),e.namespace=e.namespaces[r-2])}}function Ue(e,t){e.firstChild?(e.lastChild.nextSibling=t,e.lastChild=t):(e.firstChild=e.lastChild=t,t.nextSibling=void 0),t.parentIdx=e.idx}function We(e,t,n,r,i,o,a,s){for(var c,d=[],l=8;l<arguments.length;l++)d[l-8]=arguments[l];if(s){var u=void 0,p=void 0,f=!1;u=t?a.slice(0):(c=e.nodes[r]).pieces;for(var h=0;s>h;h++)(p=qe(e,n,d[h]))!==Fe&&(f=!0,u[1+2*h]=null==p?"":p);if(!t)return f&&(c.domNode.textContent=u.join("")),void De(e,c.domNode,o);c=m(e.doc.createTextNode(u.join("")),u),De(e,c.domNode,o)}else{if(!t)return void(o&&De(e,e.nodes[r].domNode,o));c=m(e.doc.createTextNode(a),void 0),De(e,c.domNode,o)}function m(e,t){return{kind:"#text",uid:"txt"+ ++se,domNode:e,attached:!0,idx:r,parentIdx:-1,pieces:t,nextSibling:void 0}}e.nodes[r]=c,e.cmAppends[i](c,!1)}function Ze(e,t,n){if(e.expressions){var r=e.expressions;if(r.length>t&&r[t]===n)return Fe;r[t]=n}else e.expressions=[],e.expressions[t]=n;return n}function qe(e,t,n){if(t){if(n[2]){var r=e.oExpressions;return r[2*n[0]]?Fe:(r[2*n[0]]=1,n[1])}return Ze(e,n[0],n[1])}return n}function Ye(e,t,n,r){if(t){var i={kind:"#fragment",uid:"fra"+ ++se,idx:n,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=i;var o=e.cmAppends[r];o(i,!1),e.cmAppends[r+1]=function(e,t){o(e,!0),t||Ue(i,e)}}}function Ge(e,t,n,r,i){if(t){var o=Qe(n,null,i);return e.nodes[n]=o,et(e,o,r),o}}function Qe(e,t,n){var r;if(1===n)r={kind:"#container",subKind:"##block",uid:"cnb"+ ++se,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,views:[],viewPool:[],cmAppend:t,lastRefresh:0,previousNbrOfViews:0,insertFn:null};else{if(2!==n)return console.warn("TODO: new cnt type"),null;r={kind:"#container",subKind:"##cpt",uid:"cnc"+ ++se,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,cmAppend:t,cptRef:null,template:null,data:null,contentView:null,dynamicParams:void 0}}return r}function et(e,t,n){if(e.cmAppends){var r=e.cmAppends[n];r?(t.cmAppend=function(e,t){r(e,!0)},r(t,!1)):console.log("ERROR?",r===le)}}function tt(e,t,n,r,i,o,a,s,c,d){var l;n=n||0,t?l=e.nodes[r]||Ge(e,t,r,i,2):(l=e.nodes[r]).lists&&(l.lists.sizes={});var u=qe(e,n,o);if(l.template){if(u!==Fe&&l.cptRef!==u){var p=l.data;l.template.dispose(!0),v();var f=l.data;for(var h in p)if(p.hasOwnProperty(h)&&h.match(me)){var m=RegExp.$1;V(f,m)&&(f[m]=p[m])}}}else{if(u===Fe)return void de(e,"Invalid component ref");v()}function v(){var t=l.template=u();l.cptRef=u,Ae(t.view,e,l),t.disconnectObserver(),l.data=t.api,function(t){if(c){var n=c.length;if(!t&&n)de(e,"Invalid parameter: "+c[0]);else for(var r=0;n>r;r+=2)V(t,c[r])?t[c[r]]=c[r+1]:de(e,"Invalid parameter: "+c[r])}}(t.api)}d&&(l.dynamicParams={}),0===n&&a&&nt(e,r,l,s,d)}function nt(e,t,n,r,i){var o=(n=n||e.nodes[t])?n.template:void 0;if(void 0!==o){if(o.view.lastRefresh=e.lastRefresh-1,rt(n),n.contentView){o.api.$content=n.contentView;var a=n.contentView.instructions;a&&a.length&&(o.forceRefresh=!0)}if(o.view.cm)o.view.cmAppends=[n.cmAppend];else{if(i)for(var s=i.length,c=(n?n.dynamicParams:{})||{},d=o.api,l=0;s>l;l++)c[i[l]]||A(d,i[l]);var u=o.view.nodes[0];if(!u.attached)o.forceRefresh=!0,Xe(u,Be(e,n))}r&&De(e,o.api,r),o.render()}}function rt(e){if(e.lists)for(var t=e.lists,n=t.listNames,r=void 0,i=void 0,o=void 0,a=void 0,s=0;n.length>s;s++)r=n[s],(i=t.sizes[r]||0)<(a=(o=e.data[r]).length)&&o.splice(i,a-i)}function it(e,t,n,r,i){if(i!==Fe){var o=qe(e,t,i);if(o!==Fe){var a=e.nodes[n].domNode;void 0===o?a.removeAttribute(r):a.setAttribute(r,o)}}}function ot(e,t,n,r,i){if(i!==Fe){var o=qe(e,t,i);o!==Fe&&(e.nodes[n].domNode[r]=o)}}function at(e,t,n,r,i,o){if(o!==Fe){var a=qe(e,n,o);if(a!==Fe){var s=e.nodes[r],c=s.kind;if("#container"===c){var d=s.data;st(e,t,s,d,i)&&(d[i]=a)}else if("#param"===c)ct(e,t,s,a,i);else if("#decorator"===c){var l=s;t&&!pt(e,l,i)||(l.api[i]=a)}}}}function st(e,t,n,r,i){if(r&&(!e.cm||V(r,i)))return!0;var o="";return n.template&&(o=" on <*"+n.template.templateName+"/>"),de(e,"Invalid parameter '"+i+"'"+o),!1}function ct(e,t,n,r,i){if(0===i){if(n.dataHolder)return n.dataHolder[n.dataName]=r,n.dataHolder}else{if(n.data)return t&&!V(n.data,i)&&de(e,"Invalid param node parameter: "+i),n.data[i]=r,n.data;de(e,"Invalid param node parameter: "+i)}return null}function dt(e,t,n,r,i,o,a,s){var c,d=e.nodes[r],l=d.kind,u=le;if(a!==le&&s!==le&&null!==a&&"object"==typeof a&&(t&&"string"==typeof s&&$(a)&&!V(a,s)&&de(e,"Invalid property: '"+s+"'"),u=a[s]),"#container"===l)st(e,0,d,c=d.data,o)&&(t&&St(e,c,o),c[o]=u);else if("#param"===l)if(0===o){var p=d;p.dataHolder&&(p.dataHolder[p.dataName]=u,c=p.dataHolder,o=p.dataName,t&&St(e,c,o,"."+o,!1,!0))}else c=ct(e,t,d,u,o),t&&St(e,c,o,"."+d.dataName);else if("#decorator"===l){var f=d;c=f.api,0===o?(o=ft(e,f,u),t&&o&&St(e,c,o,f.refName,!0)):t&&!pt(e,f,o)||(t&&St(e,c,o,f.refName),c[o]=u)}var h=d.bindings;if(h===le&&(h=d.bindings=[]),h[i]===le){if(c){var m={propertyHolder:a,propertyName:s,watchFn:D(c,(function(){var e=c[o],t=m.propertyHolder;if(t!==le&&null!==t&&m.propertyName!==le&&t[m.propertyName]!==e){var n=I(t);0===n||n%2==1?Promise.resolve().then((function(){t[m.propertyName]=e})):t[m.propertyName]=e}}))};h[i]=m}}else{var v=h[i];v.propertyHolder=a,v.propertyName=s}}function lt(e,t,n,r,i){if(i&&e.nodes){var o=e.nodes[n];if("#container"===o.kind&&"##cpt"===o.subKind){var a=o.template;a&&Oe(e,a.api,r)}else o.domNode?Oe(e,o.domNode,r):"#decorator"===o.kind&&Oe(e,o.api,r)}}function ut(e,t,n,r,i,o,a,s,c,d,l){var u;if(t){var p=e.nodes;if(void 0===a)de(e,"Undefined decorator reference: @"+o);else if("function"!=typeof a&&!0!==a.$isDecorator)de(e,"Invalid decorator reference: @"+o);else{var f=new a.$apiClass,h=a(f);if(u={kind:"#decorator",uid:"deco"+ ++se,idx:r,parentIdx:i,attached:!0,nextSibling:void 0,domNode:void 0,instance:h,api:f,refName:"@"+o,validProps:!0},p[r]=u,d)for(var m=d.length,v=0;m>v;v+=2)pt(e,u,d[v]),f[d[v]]=d[v+1]}}else u=e.nodes[r];if(u!==le){f=u.api;1===s&&ft(e,u,c),De(e,f,l)}}function pt(e,t,n){return!!V(t.api,n)||(de(e,"Invalid decorator parameter '"+n+"' on "+t.refName),!1)}function ft(e,t,n){var r=t.api,i=r[ye];return i===le?(de(e,t.refName+" doesn't define any default parameter"),""):(r[i]=n,i)}function ht(e,t,n){if(t){var r=n.api,i=e.nodes[n.parentIdx],o=null,a=null;if(void 0===i.kind)o=i;else if("#element"===i.kind)o=i.domNode;else if("#container"===i.kind&&"##cpt"===i.subKind){var s=i.template;a=s.api,o=s.query("#main")}else de(e,"Invalid decorator target for "+n.refName);null!==o&&V(r,"$targetElt")&&(r.$targetElt=o),null!==a&&V(r,"$targetApi")&&(r.$targetApi=a),n.validProps=function(e,t,n,r){if(t[Ne]!==le){var i=t[Ne],o=void 0,a=!0;for(var s in i)if((o=t[i[s]])===le||null===o){var c=$t(i[s]);r!==le&&r[c]!==le?de(e,(n+" "+c).replace(ve,r[c])):de(e,c+" property is required for "+n),a=!1}return a}return!0}(e,n.api,n.refName,we),n.validProps&&Pe(e,n.instance,"$init",n.refName)}n.validProps&&Pe(e,n.instance,"$render",n.refName)}function mt(e,t,n,r){var i=e.nodes[r];i!==le&&ht(e,t,i)}function vt(e,t,n,r,i,o,a,s){if(t){var c=e.nodes[r];if("#element"===c.kind){var d=c.domNode;if(!d)return void de(e,"Cannot set "+i+" event listener: undefined DOM node");var l=f(d);a&&!1!==(s=s||{}).passive&&(s.passive=!0),d.addEventListener(i,(function(e){l.callback&&l.callback(e)}),s)}else if("#container"===c.kind){var u=c.template;u?p(u.api,!1):de(e,"Cannot set "+i+" event listener: undefined component template")}else"#param"===c.kind?p(c.data,!0):"#decorator"===c.kind&&p(c.api,!0)}else e.nodes[n].callback=o;function p(t,n){if(t&&V(t,i+"Emitter")){var r=t[i+"Emitter"];if(r.addListener&&"function"==typeof r.addListener){var o=f(null);r.addListener((function(e){o.callback&&o.callback(e)})),n&&"function"==typeof r.init&&r.init(i,t)}else de(e,"Invalid event emitter for: "+i)}else de(e,"Unsupported event: "+i)}function f(t){var i={kind:"#listener",uid:"evt"+ ++se,idx:n,parentIdx:r,nextSibling:void 0,domNode:t,attached:!0,callback:o};return e.nodes[n]=i,i}}function gt(e,t,n,r,i){var o,a=e.nodes[n];if(1===i)if(r[be]){if(V(r,pe)){var s=r[pe];s!==le&&(o=s.$content)}}else V(r,"$content")&&(o=r.$content);else o=qe(e,t,r);if(o!==Fe&&void 0!==r||(o=a.contentView),o){var c=o.projectionHost;if(c&&c.hostNode!==a&&yt(o,o.nodes[0]),a.contentView&&a.contentView!==o&&yt(a.contentView,a.contentView.nodes[0]),a.contentView=o,o.projectionHost={view:e,hostNode:a},o.cm)if("#element"===a.kind){var d=a.domNode;o.cmAppends=[function(e){e.domNode?Ft(e.domNode,a.domNode):e.domNode=d}]}else o.cmAppends=[Be(e,a)];else{var l=void 0,u=!1;if(o.domNode!==le&&null!==o.nodes&&o.domNode.nodeType===ue&&(Ft(o.nodes[0].domNode,a.domNode),function(e,t,n){if(!e||e.cm||!e.nodes||!e.nodes.length)return;n===le&&(n=e.domNode);if(n===le||t===n)return;Lt(e,!0,(function(e){return"#view"!==e.kind&&"#fragment"!==e.kind&&"#container"!==e.kind||e.domNode===n&&(e.domNode=t),!0}))}(o,a.domNode),u=!0),!u){if("#element"===a.kind){var p=a.domNode;l=function(e,t){e.domNode?Ft(e.domNode,p):e.domNode=p}}else l=Be(e,a);Xe(o.nodes[0],l)}}o.container=a,Me(o)}}function bt(e,t){if(0===t.idx&&e.projectionHost){if(!t.attached)return null;var n=e.projectionHost.hostNode;return"#element"===n.kind?n.domNode:bt(e.projectionHost.view,n)}return 0===t.idx?e.parentView?bt(e.parentView,e.container):e.rootDomNode:e.nodes[t.parentIdx].domNode}function yt(e,t){if(t&&t.attached)if("#text"===t.kind||"#element"===t.kind){var n=bt(e,t);t.attached=!1,n?n.removeChild(t.domNode):de(e,"Internal error - parent not found for: "+t.uid)}else if("#container"===t.kind){if("##block"===t.subKind){for(var r=t,i=r.views,o=i.length,a=void 0,s=0;o>s;s++)a=i[s].nodes[0],yt(i[s],a),i[s].attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0);r.views=[],r.previousNbrOfViews=0,r.viewPool=i.concat(r.viewPool)}else if("##cpt"===t.subKind){var c=t.template;a=c.view.nodes[0];yt(c.view,a),c.view.attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0)}}else if("#fragment"===t.kind){var d=t;if(d.attached=!1,d.contentView)yt(d.contentView,d.contentView.nodes[0]);else if(d.firstChild)for(var l=d.firstChild;l;)yt(e,l),l=l.nextSibling;d.domNode=void 0}else"#param"===t.kind?console.warn("TODO removeFromDom for param nodes"):console.warn("RemoveFromDom for "+t.kind)}var xt=F,Nt=R,wt=function(e){var t=e.ΔFactory;if(t)return t;function n(){return new e}return n[l]=!0,e[c]=n,n},kt=ae,It=_,Ct=B,Pt=L;function Vt(e){e.prototype[ge]=!0,F(e)}function $t(e){return e.replace(he,"")}function jt(e,t){return!0===e.prototype[t]}function Dt(e,t){return t.$apiClass=e,t.$isDecorator=!0,t}function Ot(e,t){e[ye]=$t(t)}function Et(e,t){var n=e[xe];t="/"+$t(t),e[xe]=n===le?t:n+t}function At(e,t){var n=e[Ne];n===le&&(n=e[Ne]=[]),n.push(t)}function St(e,t,n,r,i,o){var a=t[xe];if(a!==le){var s="/"+n;if(a===s||a.indexOf(s)>-1)return!0}return de(e,r!==le?i?"Invalid I/O binding expression on "+r+" (@defaultParam is not an @io param)":o?"Invalid I/O binding expression on "+r+"@paramValue (not an @io param)":"Invalid I/O binding expression on "+r+"."+n+" (not an @io param)":"Invalid I/O binding expression on '"+n+"' (not an @io param)"),!1}function Ft(e,t,n){t.appendChild(e)}function Rt(e,t,n,r){n.insertBefore(e,t)}function Lt(e,t,n){if(e!==le&&null!==e){if(!n(e))return!1;if(null!==e.nodes&&e.nodes.length)for(var r=0,i=e.nodes;r<i.length;r++){if(!o(i[r]))return!1}}return!0;function o(e){var r=e.kind;if("#fragment"===r)return!!n(e)&&Lt(e.contentView,t,n);if("#container"!==r)return n(e);if(!n(e))return!1;var i=e,o=i.subKind;if("##block"===o){var a=i.views;if(null!==a)for(var s=0,c=a;s<c.length;s++){if(!Lt(c[s],t,n))return!1}if(t&&i.viewPool)for(var d=0,l=i.viewPool;d<l.length;d++){if(!Lt(l[d],t,n))return!1}}else if("##cpt"===o){var u=i.template;if(null!==u)return Lt(u.view,t,n)}else"##async"===o&&console.log("TODO: support scanNode for @async block");return!0}}var Tt="-------------------------------------------------------------------------------";var _t={"ζt":Se,"ζu":Fe,"ζinit":Re,"ζview":Le,"ζviewD":function(e,t,n,r,i,o){var a=o||Le(e,0,n,r,i);if(1===t)a.instructions=[];else{for(var s=a,c=t-1;c>0;)s=s.parentView,c--;s.instructions||(s.instructions=[]),a.instructions=s.instructions}return a.cm&&!a.cmAppends&&_e(a,Te,[a,e,n]),a},"ζend":ze,"ζendD":function(e,t,n){if(e.paramNode){var r=e.paramNode;r.dataHolder?(_e(e,ze,[e,t,n]),r.data&&"#view"!==r.data.kind?r.data?r.data.$content=e:console.warn("TODO: ζendD no data"):r.dataHolder[r.dataName]=e):de(e,"ζendD dataHoler should be defined")}else _e(e,ze,[e,t,n])},"ζelt":Ke,"ζeltD":function(e,t,n,r,i,o,a,s,c){t&&_e(e,Ke,[e,t,n,r,i,o,a,s,c])},"ζxmlns":Je,"ζxmlnsD":function(e,t,n){_e(e,Je,[e,t,n])},"ζtxt":We,"ζtxtD":function(e,t,n,r,i,o,a,s){for(var c=[],d=8;d<arguments.length;d++)c[d-8]=arguments[d];for(var l=[e,t,n,r,i,o,a,s],u=0;s>u;u++)l.push(c[u]);_e(e,We,l)},"ζe":Ze,"ζo":function(e,t,n,r){var i=e.oExpressions;if(i||(i=e.oExpressions=[]),r){if(i[2*t])return i[1+2*t];var o=[t,n,1];return i[2*t]=0,i[1+2*t]=o,o}return i[2*t]?Fe:(i[2*t]=1,n)},"ζfra":Ye,"ζfraD":function(e,t,n,r){_e(e,Ye,[e,t,n,r])},"ζcnt":Ge,"ζcntD":function(e,t,n,r,i){if(t){var o=Qe(n,null,i);e.nodes[n]=o,_e(e,et,[e,o,r])}},"ζcpt":tt,"ζcptD":function(e,t,n,r,i,o,a,s,c,d){tt(e,t,n,r,i,o,a,s,c,d),_e(e,et,[e,e.nodes[r],i]),a&&_e(e,nt,[e,r,0,s,d])},"ζcall":nt,"ζcallD":function(e,t,n,r,i){_e(e,nt,[e,t,n,r,i])},"ζpnode":function(e,t,n,r,i,o,a,s,c,d){var l,u=e.nodes,p=!1;if(u[r]){var f=(l=u[r]).viewPool;a>0&&!f&&((f=l.viewPool=[])[l.viewInstanceIdx]=l.contentView),f&&(l.contentView=f[a]),l.viewInstanceIdx=a,l.dataHolder=l.data=void 0,p=!0}else l={kind:"#param",uid:"pnd"+ ++se,idx:r,parentIdx:i,nextSibling:void 0,domNode:void 0,attached:!0,dataName:o,dataHolder:void 0,data:void 0,dataIsList:void 0,contentView:void 0,dynamicParams:void 0,viewInstanceIdx:a,viewPool:void 0},u[r]=l;d&&(l.dynamicParams={});var h,m=u[i],v=o,g=void 0,b=m.data;if(b){if(l.dataHolder=b,void 0===l.dataIsList&&function(e,t,n,r){V(r,n)?t.dataIsList=!1:V(r,n+"List")?(t.dataIsList=!0,t.dataName=n+"List"):de(e,"Invalid parameter node: <."+n+">")}(e,l,v,b),v=l.dataName,g=l.data,l.dataIsList){var y=m.lists;y||(y=m.lists={sizes:{},listNames:[],listMap:{}}),y.listMap[v]||(y.listMap[v]=1,y.listNames.push(v));var x=y.sizes[v];x||(x=y.sizes[v]=0),(h=b[v][x])||(h=E(b[v],x)),y.sizes[v]+=1,l.data=h}else l.data=h=b[v],void 0===h&&(l.data=h=E(b,v));p&&h&&h["ΔΔ$content"]&&(l.contentView=h["ΔΔ$content"])}else de(e,"Invalid parameter node <."+o+"/>: no param node can be used in this context");l.lists&&(l.lists.sizes={});var N=m.dynamicParams;if(N&&(N[v]=1),c)if(h){if(g!==h)for(var w=c.length,k=0;w>k;k+=2)t&&!V(h,c[k])&&de(e,"Invalid param node parameter: "+c[k]),h[c[k]]=c[k+1]}else de(e,"Invalid param node parameter: "+c[0])},"ζpnEnd":function(e,t,n,r,i,o){var a=e.nodes[r];if(rt(a),o)for(var s=o.length,c=a.dynamicParams,d=0;s>d;d++)c&&!c[o[d]]&&A(a.data,o[d]);void 0!==a.contentView&&Z(a.dataHolder)},"ζatt":it,"ζattD":function(e,t,n,r,i){i!==Fe&&_e(e,it,[e,t,n,r,i])},"ζpro":ot,"ζproD":function(e,t,n,r,i){i!==Fe&&_e(e,ot,[e,t,n,r,i])},"ζpar":at,"ζparD":function(e,t,n,r,i,o){if(o!==Fe){var a=e.nodes[r];a!==le&&"#param"===a.kind?at(e,t,0,r,i,o):_e(e,at,[e,t,n,r,i,o])}},"ζbind":dt,"ζbindD":function(e,t,n,r,i,o,a,s){var c=e.nodes[r];c!==le&&"#param"===c.kind?dt(e,t,0,r,i,o,a,s):_e(e,dt,[e,t,n,r,i,o,a,s])},"ζlbl":lt,"ζlblD":function(e,t,n,r,i){i&&_e(e,lt,[e,t,n,r,1])},"ζdeco":ut,"ζdecoD":function(e,t,n,r,i,o,a,s,c,d,l){_e(e,ut,[e,t,n,r,i,o,a,s,c,d,l])},"ζdecoCall":mt,"ζdecoCallD":function(e,t,n,r){_e(e,mt,[e,t,n,r])},"ζevt":vt,"ζevtD":function(e,t,n,r,i,o,a,s){_e(e,vt,[e,t,n,r,i,o,a,s])},"ζins":gt,"ζinsD":function(e,t,n,r,i){_e(e,gt,[e,t,n,r,i])}},Mt="value",Bt="checked",Ht="data",Xt=["text","radio","checkbox","number","range"],zt={passive:!0},Kt=Dt(function(){function e(){this.ΔΔevents="input",this.ΔΔdebounce=0}return e.prototype.ΔDefault=function(e){switch(e){case"events":return"input";case"debounce":return 0}return Pt},n([At,Ot,Et,r("design:type",Object)],e.prototype,"ΔΔdata",void 0),n([Nt(),r("design:type",Object)],e.prototype,"data",void 0),n([At,r("design:type",Object)],e.prototype,"ΔΔ$targetElt",void 0),n([Nt(),r("design:type",Object)],e.prototype,"$targetElt",void 0),n([Nt(It),r("design:type",String)],e.prototype,"events",void 0),n([Nt(0,2),r("design:type",Object)],e.prototype,"input2data",void 0),n([Nt(0,2),r("design:type",Object)],e.prototype,"data2input",void 0),n([Nt(Ct),r("design:type",Number)],e.prototype,"debounce",void 0),e=n([Vt],e)}(),(function(e){var t,n,r="",i="",o="",a={};function s(t){if("number"===r&&"input"===t.type){var i=t[Ht];if("e"===i||"E"===i||"-"===i||"+"===i)return}e.debounce<=0?c():(n||(n=new Jt("@value error")),n.duration=e.debounce,n.process(c))}function c(){var n;if("text"===r||"number"===r)n=t[Mt];else if("range"===r){var i=t[Mt];if(""===i)n=0;else if(n=parseInt(i),isNaN(n))throw"Invalid input value '"+i+"': value of input type range shall be an integer"}else if("checkbox"===r)n=t[Bt];else if("radio"===r){if(!t[Bt])return;n=t[Mt]}e.data=e.input2data(n)}return{$init:function(){if("INPUT"!==(t=e.$targetElt).tagName&&"TEXTAREA"!==t.tagName&&"SELECT"!==t.tagName)throw"@value can only be used on input, textarea and select elements";if(r="text","INPUT"===t.tagName&&(r=t.getAttribute("type"),-1===Xt.indexOf(r)))throw"Invalid input type '"+r+"': @value can only be used on types '"+Xt.join("', '")+"'";t.addEventListener("change",s,zt)},$render:function(){if(void 0===e.input2data&&(e.input2data=function(e){if("number"===r){if(""===e)return 0;try{e=parseFloat(e)}catch(e){return console.log("@value conversion error: ",e),0}}return e}),void 0===e.data2input&&(e.data2input=Wt),i!==e.data){i=e.data;var n=e.data2input(i);if("text"===r||"number"===r)t[Mt]=n;else if("range"===r){if(!Number.isInteger(n))throw"Invalid input value '"+n+"': value of input type range shall be an integer";t[Mt]=""+n}else"checkbox"===r?t[Bt]=!!n:"radio"===r&&(t[Bt]=n===t[Mt])}if(o!==e.events){for(var c=e.events.split(";"),d=0,l=o.split(";");d<l.length;d++){"change"!==(f=l[d])&&(c.indexOf(f)<0&&a[f]&&(t.removeEventListener(f,s,zt),a[f]=!1))}for(var u=0,p=c;u<p.length;u++){var f;"change"!==(f=p[u])&&(a[f]||(t.addEventListener(f,s,zt),a[f]=!0))}o=e.events}},$dispose:function(){if(t){if(t.removeEventListener("change",s),""!==o)for(var e=0,r=o.split(";");e<r.length;e++){var i=r[e];"change"!==i&&t.removeEventListener(i,s,zt)}o="",n=void 0}}}})),Jt=function(){function e(e){void 0===e&&(e="Error in callback"),this.errContext=e,this.timeoutId=null,this.duration=100}return e.prototype.process=function(e){var t=this;this.duration<=0?Ut(e,this.errContext):(null!==this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){t.timeoutId=null,Ut(e,t.errContext)}),this.duration))},e}();function Ut(e,t){try{e()}catch(e){throw"Debounce - "+t+"\n"+(e.message?e.message:e)}}function Wt(e){return e}var Zt=void 0,qt=/^[ \f\r\t\v]*\n(\s*)/,Yt=/^\s*else/,Gt=/^\$(if|for|exec|let|each|log|template)/,Qt=/^\$(if|each|log)/,en=/^[$_a-zA-Z][_a-zA-Z0-9]*(\.[$_a-zA-Z][_a-zA-Z0-9]*)*$/,tn=/^[$_a-zA-Z][_a-zA-Z0-9]*$/,nn=/^(script)$/,rn=/^(script|frame|frameset|iframe)$/,on="cdata",an="$$default",sn=on.length,cn="</!cdata>",dn=cn.length,ln=-1,un=-2,pn=10,fn=32,hn=33,mn=34,vn=35,gn=39,bn=40,yn=41,xn=42,Nn=43,wn=44,kn=45,In=46,Cn=58,Pn=59,Vn=63,$n=64,jn=47,Dn=92,On=91,En=93,An=95,Sn=60,Fn=61,Rn=62,Ln=123,Tn=125,_n=36,Mn=95,Bn=105,Hn=116,Xn=102,zn=122,Kn=" ".charCodeAt(0),Jn={33:hn,36:_n,47:jn,60:Sn,62:Rn,95:fn,110:pn,115:Kn,122:zn,123:Ln,125:Tn};function Un(e,t){return i(this,void 0,void 0,(function(){function n(){return r(1)}function r(t){return z=X,X=(H+=t)<B?e.charCodeAt(H):un}function a(){return H+1<B?e.charCodeAt(H+1):un}function s(t){return H+t>=B&&(t=B-t-1),t<1?"":e.substr(H,t)}function c(t){return X!==un?e.substring(H).match(t):null}function d(e,t){return X!==e&&b(void 0===t?u(e)+" expected instead of "+u(X):t),n()}function l(e){var t=e.length,n=H,i=s(t);if(e===i)r(t);else{var o=i.replace(/\n/g,"\\n");""===o&&X===un&&(o="End of Content"),b("Unexpected characters '"+o+"' instead of '"+e+"'",n)}return X}function u(e){return e===un?"End of Content":"'"+String.fromCharCode(e)+"'"}function p(e,t){void 0===t&&(t=!0);var r=[];for(t&&r.push(e),K.push("string"),d(e);X!==e&&X!==un;)X===Dn&&n(),r.push(X),n();return d(e),t&&r.push(e),K.pop(),String.fromCharCode.apply(null,r)}function f(){return X>96&&X<123||X>64&&X<91}function h(){return X>47&&X<58}function m(){return X===Nn||X===kn}function v(e){return e===fn||e>7&&e<14}function g(){if(X!==jn)return!1;var e=a();if(e===jn){for(l("//");pn!==X&&un!==X;)n();return n(),!0}if(e===xn){l("/*");for(var t=!0;t;)(un===X||xn===X&&a()===jn)&&(n(),t=!1),n();return!0}return!1}function b(n,r){var i=_?"$fragment":"$template";K.length&&(i=K[K.length-1]);var o=e.split("\n"),a=0,s=0,c=0,d=o.length,l=o[d-1].length;if((r=r||H)>-1)for(;c<o.length;){if(!(s+(a=o[c].length)<r)){d=c+1,l=1+r-s;break}c++,s+=a+1}var p="";t!==Zt&&t.fileId!==Zt&&(p="\nFile: "+t.fileId);var f=d;throw t&&(f+=void 0!==t.line1?t.line1-1:0,1===d&&(l+=void 0!==t.col1?t.col1-1:0)),{kind:"#Error",origin:"XJS",description:n=n===Zt?"Invalid "+i+": Invalid character "+u(X):"Invalid "+i+": "+n,message:"XJS: "+n+"\nLine "+f+" / Col "+l+p+"\nExtract: >> "+o[d-1].trim()+" <<",file:t&&t.fileId||"",line:f,column:l,lineExtract:o[d-1].trim()}}function y(e,t){void 0===e&&(e=!1),void 0===t&&(t=!0);var r=!0,i=H;if(X!==un)for(;r;)v(X)?(n(),g()):g()||(r=!1);return e&&i===H&&b("Invalid syntax: spaces expected instead of "+u(X),i),X===un&&t&&!_&&b("Unexpected End of Content"),i!==H}function x(e,t){if(void 0===t&&(t=!0),t&&X!==bn||!t&&X!==_n)return!1;K.push("template function");var r=function(e){void 0===e&&(e=-1);return{kind:"#tplFunction",pos:e,indent:""}}(H);Yn(r,e),t||(l("$template"),y(!0),r.name=A()||"",""===r.name&&b("Invalid syntax: $template name cannot be empty",H),y()),K.push("template arguments"),d(bn);for(var i,o,a=!0,s=!1;a;){if(y(),o=H,(i=A())!==Zt){var u=Wn(r,i,H);y(),X===Vn&&(u.optional=s=!0,n(),y()),X===Cn&&(n(),y(),u.typeRef=S(!1,Zt,Zt,!0),y()),X===Fn&&(n(),y(),u.defaultValue=S(!1)),s&&!u.optional&&b("Optional arguments must be in last position",o)}y(),X!==wn?a=!1:X=n()}return d(yn),K.pop(),y(),t&&(l("=>"),y()),d(Ln),c(qt)&&(r.indent=RegExp.$1),N(r,"template content"),d(Tn),t&&y(!1,!1),K.pop(),!0}function N(e,t){for(void 0===t&&(t="content block"),K.push(t);I(e)||D(e)||w(e););K.pop()}function w(e){if(X===Sn&&z!==hn||X===un||X===Tn)return!1;if(k())return!1;K.push("text node");var t=y(),r=H,i=[],o=!1;if(X!==Sn&&X!==un&&!k()){var a=function(e,t){void 0===t&&(t=-1);return{kind:"#textNode",pos:t,textFragments:e}}([],r);t&&(i[0]=fn);for(var s=t;X!==Sn&&X!==un&&X!==Tn&&!k();)if(g(),X===hn){var c=z;X=d(hn);var l=Jn[""+X];l!==Zt?Z?(i.push(hn),i.push(X),s=!1,n()):X===zn?(s&&i.length>0&&i.pop(),s=!0,z=c,n()):(s=!1,n(),i.push(l),z=l,o=!0):(i.push(hn),s=!1)}else X===Ln?(u(j(),a),s=!1):s&&v(X)?n():(s=v(X),i.push(s?fn:X),n());if(u(null,a),!o&&a.expressions===Zt&&(1===a.textFragments.length&&" "===a.textFragments[0]||0===a.textFragments.length))return K.pop(),!0;Yn(a,e)}return K.pop(),!0;function u(e,t){null!==e?(i.length?(t.textFragments.push(String.fromCharCode.apply(null,i)),i=[]):t.textFragments.push(""),t.expressions===Zt?t.expressions=[e]:t.expressions.push(e)):i.length&&t.textFragments.push(String.fromCharCode.apply(null,i))}}function k(){return X===_n&&null!==c(_?Qt:Gt)}function I(e){if(X!==Sn||a()===jn)return!1;X=d(Sn);var t=0,r=-1;g();var i,o="",c="element";if(X===hn){if(d(hn),function(e){if(on===s(sn)){K.push("cdata section");var t=H;l(on);var r=function(e){void 0===e&&(e=-1);return{kind:"#cdata",pos:e,text:""}}(H);Yn(r,e),y()&&R(C(r,e,V)),d(Rn);for(var i=[],o=!0;o;)X===un?(o=!1,b("end marker '</!cdata>' not found",t-2)):X===hn?(n(),cn===s(dn)?(Z&&i.push(hn),i.push(X),n()):i.push(hn)):X===Sn&&cn===s(dn)?(l(cn),o=!1):(i.push(X),n());return r.text=String.fromCharCode.apply(null,i),K.pop(),!0}return!1}(e))return!0;c="fragment",K.push(c),Yn(i=qn(H),e)}else t===xn?c="component":t===In?c="param node":t===$n&&(c="decorator node"),K.push(c),r=H,o=$(!0,0===t,c+" identifier"),i=function(){if(t===xn){var n=function(e,t){void 0===t&&(t=-1);return{kind:"#component",ref:e,pos:t}}(Qn(o,r),H);return n.ref.refPath=F(n.ref.code),Yn(n,e)}if(t===In)return Yn(function(e,t){void 0===t&&(t=-1);return{kind:"#paramNode",name:e,pos:t}}(o,H),e);if(t===$n){var i=function(e,t){void 0===t&&(t=-1);return{kind:"#decoratorNode",ref:e,pos:t}}(Qn(o,r),H);return i.ref.refPath=F(i.ref.code),Gn(i,e)}return Yn(function(e,t){void 0===t&&(t=-1);return{kind:"#element",name:e,pos:t}}(o,H),e)}(),t!==xn&&t!==$n||o.match(en)?t!==In||o.match(tn)||b("Invalid identifier: '"+o+"'",r):b("Invalid "+c+" reference: '"+o+"'",r),0===t&&o.match(_?rn:nn)&&b("Invalid tag name '"+o+"'",r);var p=y();p&&R(C(i,e,V));if(X===jn)l("/>");else if(X===Rn){d(Rn),N(i),l("</");var f=H,h=t,m=g(),v=$(!1,0===t,c+" identifier");""===v&&0===m&&hn===X?d(hn):""===v&&0===m||(h!==m||""!==v&&v!==o)&&b("End tag </"+x(m,v)+"> doesn't match start tag <"+x(h,o)+">",f),y(),d(Rn)}else b(p?"Unexpected character: "+u(X):"Invalid character in "+c+" identifier: "+u(X),H);return K.pop(),!0;function g(){return X===xn||X===In||X===$n?(t=X,X=n(),t):0}function x(e,t){return(0===e?"":String.fromCharCode(e))+t}}function C(e,t,r){var i=0,o=!0,a=null,s=-1,c="";for(K.push("param");o&&!r();){s=H,c=X===$n?"decorator":X===vn?"label":X===On?"property":"param";var u=null,p=!1,f=!1,h=void 0;if((i=V())===$n&&X===$n){d($n);var m=H-2;""===(h=A()||"")?b("Invalid preprocessor reference",m):"#preprocessor"!==e.kind&&"#decorator"!==e.kind&&"#decoratorNode"!==e.kind||b("@@"+h+" cannot be used in this context",m),u={kind:"#preprocessor",ref:Qn("@@"+h,H),pos:m,hasDefaultPropValue:!1,isOrphan:!1,parent:e,grandParent:t},null===a&&(a=[]),a.push(u)}else{if(0===i&&X===Ln){K.push("binding shortcut");var v=!1;(X=d(Ln))===Cn&&(l("::"),v=!0),y(),X===On&&(d(On),p=!0,y()),h=A()||"",p&&(y(),d(En)),y(),d(Tn);var g=Qn(h,s);g.oneTime=v,I(h,e,g,p),y()||(o=!1),K.pop();continue}K.push(c),i===vn&&X===vn&&(d(vn),f=!0);var x=H;0!==i&&(x-=1),h=$(!0,0===i,c+" name"),i===On?(d(En),p=!0):i===vn&&"#preprocessor"===e.kind&&b("Labels cannot be used on pre-processors",x),i!==vn&&i!==On||h.match(tn)||b("Invalid name '"+h+"'",x),f&&"#component"!==e.kind&&b("Forward label '"+h+"' can only be used on components",x-1)}var N=y();if(X===Fn)d(Fn),y(),null!==u?I(an,u,P(),!1,f,!0):I(h,e,P(),p,f),y()||(o=!1);else if(i===$n&&X===bn){var w=void 0;w=null!==u?u:I(h,e),d(bn),y(),C(w,e,k),d(yn),y()||(o=!1)}else N||X===Rn||X===jn||X===yn?null!==u?u.isOrphan=!0:I(h,e,Zt,!1,f):o=!1;null===u&&K.pop()}return r()||b(),K.pop(),a;function k(){return X===yn}function I(e,t,n,r,o,a){var c;return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),i!==$n||a?i===vn?((c=function(e,t){void 0===t&&(t=-1);return{kind:"#label",pos:t,name:e,fwdLabel:!1,isOrphan:!1}}(e,s)).value=n,c.isOrphan=n===Zt,c.fwdLabel=o):c=r?function(e,t,n){void 0===n&&(n=-1);return{kind:"#property",name:e,value:t,pos:n}}(e,n,s):function(e,t,n,r){void 0===n&&(n=!1);void 0===r&&(r=-1);return{kind:"#param",name:e,isOrphan:n,pos:r,value:t}}(e,n,n===Zt,s):(c=function(e,t){void 0===t&&(t=-1);return{kind:"#decorator",pos:t,ref:e,hasDefaultPropValue:!1,isOrphan:!1}}(Qn(e,s),s),n!==Zt?(c.hasDefaultPropValue=!0,c.defaultPropValue=n):c.isOrphan=!0,c.ref.refPath=F(c.ref.code)),Gn(c,t)}function V(){if(X===On||X===$n||X===vn){var e=X;return n(),e}return 0}}function P(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var r=H,i=t?"argument":"param value";if(X===gn)return p(gn,t);if(X===mn)return p(mn,t);if(e&&X===Ln)return j();if(!t&&X===Hn)return l("true"),!0;if(!t&&X===Xn)return l("false"),!1;if(h()||m()){var o=[];for(m()&&(o.push(X),n(),y());h();)o.push(X),n();if(X===In)for(o.push(In),n(),h()||b("Invalid number");h();)o.push(X),n();return parseFloat(String.fromCharCode.apply(null,o))}if(t){var a=$(!0,!1);return"true"===a||"false"!==a&&a}return b("Invalid "+i+": "+u(X),r),0}function V(){return X===jn||X===Rn}function $(e,t,r){void 0===t&&(t=!1),void 0===r&&(r="identifier");var i=[];if(f()||X===An){var o=!1;for(i.push(X),n();f()||h()||X===An||t&&X===kn||!t&&X===In;)o=X===In,i.push(X),n();o&&b("Invalid "+r)}else e&&b("Invalid character "+u(X));return 0===i.length?"":String.fromCharCode.apply(null,i)}function j(){K.push("expression");var e=!1,t=!1,r=!1;d(Ln),X===Cn?(l("::"),e=!0):X===Fn&&((X=n())===Rn?(n(),r=!0):t=!0);var i=H,o=Qn(S(!1),i);if(o.oneTime=e,o.isBinding=t,r&&(o.code="()=>"+o.code),_){var a=F(o.code);a===Zt?b("Invalid reference path '"+o.code+"'",o.pos):o.refPath=a}return d(Tn),K.pop(),o}function D(e){if(!k())return!1;K.push("js statement");var t,r=s(3),i=H;switch(r){case"$ex":Yn(er((t=O("$exec"))+";","$exec",i),e);break;case"$le":Yn(er("let "+(t=O("$let"))+";","$let",i),e);break;case"$lo":K.push("$log statement");var o=er("log","$log",i);if(_){l("$log"),y(),d(bn),K.push("$log argument");for(var a=[];;){y();var u=P(!1,!0);if(a.push(""+u),Zn(""+u,o),y(),X!==wn)break;n()}d(yn),y(),K.pop(),o.code="log("+a.join(", ")+");"}else t=E("$log"),o.code="log"+t+";";d(Pn),Yn(o,e),K.pop();break;case"$if":K.push("$if statement");var p=tr("if","$if",i);for(I("$if",p),Yn(p,e),d(Ln),N(p),d(Tn);c(Yt);){y(),l("else"),y(!0);var f=H;X===Bn?I("if",p=tr("","$elseif",f),"else "):p=tr("else {","$else",f),d(Ln),Yn(p,e),N(p),d(Tn)}K.pop();break;case"$fo":var h=tr("for "+(t=E("$for"))+" {","$for",i);Yn(h,e),d(Ln),N(h),d(Tn);break;case"$ea":K.push("$each statement"),l("$each");var m=tr("each","$each",i);y(),d(bn),y();var v=void 0;K.push("$each argument"),_?(v=$(!0,!1),y()):v=S(!1),Zn(v,m),d(wn),y();var g=void 0;for(d(bn),g="(";;){y();var w=H;if(Zn(u=$(!0,!1),m,!0)||b("Invalid function argument '"+u+"'",w),g+=u,y(),X===Cn&&(n(),y(),S(!1,Zt,Zt,!0),y()),X!==wn)break;n(),g+=","}d(yn),g+=")",K.pop(),m.startCode="each("+v+","+g+" => {",m.endCode="});",y(),l("=>"),y(),Yn(m,e),d(Ln),N(m),d(Tn),y(),d(yn),y(),d(Pn),K.pop();break;case"$te":x(e,!1);break;default:b("Invalid JS statement",H)}return K.pop(),!0;function I(e,n,r){void 0===r&&(r=""),_?(l(e),y(),d(bn),y(),t=$(!0,!1),y(),d(yn),y(),n.startCode=r+"if ("+t+") {",Zn(t,n)):(t=E(e),n.startCode=r+"if "+t+" {")}}function O(e){K.push(e+" statement"),l(e),y(!0);var t=S(!1,Zt,Zt,!1,!0);return d(Pn),K.pop(),t}function E(e){K.push(e+" statement"),l(e),y(),X!==bn&&b("Invalid "+e+" statement",H);var t=S(!1,bn,yn);return y(),K.pop(),t}function A(){if(f()||X===_n||X===Mn){var e=[X];for(n();f()||X===_n||X===Mn||h();)e.push(X),n();return String.fromCharCode.apply(null,e)}return Zt}function S(e,t,r,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=[],s="";for(t!==Zt&&(d(t),a.push(t));!u();)g()||(X===mn||X===gn?l(p(X)):X===Ln?l(S(!0,Ln,Tn,i)):X===On?l(S(!0,On,En,i)):X===bn?l(S(!0,bn,yn,i)):i&&X===Sn?l(S(!0,Sn,Rn,!0)):(a.push(X),n()));if(l(""),(""===(s=s.trim())||t!==Zt&&s.length<=2)&&!1===e){var c=t===Zt?H:H-1;b(i?"type definition cannot be empty":"expression cannot be empty",c)}return s;function l(e){s+=String.fromCharCode.apply(null,a)+e,a=[]}function u(){if(r!==Zt){if(X===r)return a.push(X),n(),!0}else if(o){if(X===Pn)return!0}else if(X===Pn||X===Tn||X===wn||X===yn||i&&X===Fn)return!0;return X===un}}function F(e){return""!==e&&e.match(en)?e.split("."):Zt}function R(e){if(null!==e){for(var n=e.length-1;n>-1;n--){var r=void 0;if((p=e[n]).instance)r=p.instance;else{var i=p.ref.code;if(J===Zt||J[i]===Zt){if(!Z)return void b("Undefined pre-processor '"+i+"'",p.pos);if(t!==Zt){e.splice(n,1),t.undefinedPreProcessorsFound=!0;continue}}r=p.instance=J[i]()}var o={};if(p.params)for(var a=0,s=p.params;a<s.length;a++){var c=s[a];o[c.name]=c}if(p.paramsDict=o,r.setup!==Zt)try{r.setup(p.parent,p.paramsDict,T(p.ref.code,p.grandParent,p.pos))}catch(e){var d=e.message||e;if(d.match(/^XJS\:/))throw e;b("Error in "+p.ref.code+".setup(): "+d,p.pos)}}for(var l=0,u=e;l<u.length;l++){var p=u[l];U===Zt?U=[p]:U.push(p)}}}function L(e){return i(this,void 0,void 0,(function(){function t(e){e.parent=e.grandParent=e.params=e.instance=e.paramsDict=Zt}var n,r,i,a,s,c;return o(this,(function(o){switch(o.label){case 0:n=e.length,r=n-1,o.label=1;case 1:if(!(r>-1))return[3,6];if(i=e[r],(a=i.instance).process===Zt)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,a.process(i.parent,i.paramsDict,T(i.ref.code,i.grandParent,i.pos))];case 3:return o.sent(),t(i),[3,5];case 4:if(s=o.sent(),c=s.message||s,t(i),c.match(/^XJS\:/))throw s;return b("Error in "+i.ref.code+".process(): "+c,i.pos),[3,5];case 5:return r--,[3,1];case 6:return[2]}}))}))}function T(e,n,r){return q=e,Y=r,W===Zt?W={parent:n,fileId:t&&t.fileId||"",rootFragment:M,error:function(e,t){void 0===t&&(t=-1),b(q+": "+e,t>-1?t:Y)},preProcessors:J}:W.parent=n,W}var _,M,B,H,X,z,K,J,U,W,Z,q,Y;return o(this,(function(n){switch(n.label){case 0:return _=t&&"$fragment"===t.templateType,B=e.length,H=0,X=un,z=ln,K=[],J=t&&t.preProcessors||{},Z=t&&!0===t.fragmentValidationMode,q="",Y=0,B>0&&(X=e.charCodeAt(0)),function(){if(M=qn(H),_)N(M,"$fragment");else{var e=H;y(!1,!1),X===un&&b("Empty template",e),x(M)||b("Invalid $template function",e)}}(),B>0?U===Zt?[3,2]:[4,L(U)]:[3,3];case 1:n.sent(),W=Zt,U=Zt,n.label=2;case 2:X!==un&&b(),n.label=3;case 3:return[2,_?M:M.content[0]]}}))}))}function Wn(e,t,n){void 0===n&&(n=-1);var r={kind:"#tplArgument",name:t,pos:n};return e.arguments?e.arguments.push(r):e.arguments=[r],r}function Zn(e,t,n){if(void 0===n&&(n=!1),t.args||(t.args=[]),e.match(en)){var r=e.split(".");if(n){if(1!==r.length)return!1;t.args.push(e)}else t.args.push(r)}else t.args.push(n?e:[e]);return!0}function qn(e){return void 0===e&&(e=-1),{kind:"#fragment",pos:e}}function Yn(e,t){return t.content?t.content.push(e):t.content=[e],e}function Gn(e,t){return t.params?t.params.push(e):t.params=[e],"#decorator"!==t.kind&&"#preprocessor"!==t.kind||(t.isOrphan=!1),e}function Qn(e,t){return void 0===t&&(t=-1),{kind:"#expression",oneTime:!1,isBinding:!1,code:e,pos:t}}function er(e,t,n){return void 0===n&&(n=-1),{kind:"#jsStatement",name:t,code:e,pos:n}}function tr(e,t,n){return void 0===n&&(n=-1),{kind:"#jsBlock",name:t,startCode:e,endCode:"}",pos:n}}var nr,rr=void 0,ir=0,or=2,ar=/^on(\w+)$/,sr={"#textNode":"Text nodes","#element":"Element nodes","#component":"Component nodes","#fragment":"Fragment nodes","#paramNode":"Parameter nodes","#decoratorNode":"Decorator nodes","#{element}":"Dynamic element nodes","#{paramNode}":"Dynamic parameter nodes","#param":"Parameters","#property":"Properties","#label":"Labels","##label":"Forward labels","#decorator":"Decorators"},cr={"#tplFunction":"$template function","#tplArgument":"$template argument","#jsStatement":"javascript statement","#jsBlock":"javascript block","#fragment":"fragment","#element":"element","#component":"component","#paramNode":"param node","#decoratorNode":"decorator node","#textNode":"text node","#param":"param","#property":"property","#decorator":"decorator","#reference":"reference","#expression":"expression","#eventListener":"event listener","#label":"label"},dr={"#textNode":{"#param":ir,"#property":ir,"#label":ir,"##label":ir,"#decorator":ir,"@onevent":ir},"#element":{"#param":1,"#property":1,"#label":1,"##label":ir,"#decorator":3,"@onevent":1},"#component":{"#param":1,"#property":ir,"#label":1,"##label":or,"#decorator":3,"@onevent":1},"#fragment":{"#param":ir,"#property":ir,"#label":ir,"##label":ir,"#decorator":3,"@onevent":ir},"#paramNode":{"#param":1,"#property":ir,"#label":ir,"##label":ir,"#decorator":3,"@onevent":1},"#decorator":{"#param":1,"#property":ir,"#label":1,"##label":ir,"#decorator":ir,"@onevent":1},"#decoratorNode":or},lr={paramValue:{"#textNode":ir,"#element":ir,"#component":ir,"#fragment":ir,"#paramNode":1,"#decoratorNode":ir,"#{element}":ir,"#{paramNode}":ir},xmlns:{"#textNode":ir,"#element":1,"#component":1,"#fragment":1,"#paramNode":ir,"#decoratorNode":ir,"#{element}":ir,"#{paramNode}":ir},content:{"#textNode":ir,"#element":1,"#component":ir,"#fragment":1,"#paramNode":ir,"#decoratorNode":ir,"#{element}":ir,"#{paramNode}":ir}},ur={validateXjsNode:function(e,t){var n=e.kind,r=dr[n];if(r===or)t.error(sr[n]+" are not supported yet",e);else if("#cdata"===n||"#component"===n||"#decoratorNode"===n||"#element"===n||"#fragment"===n||"#paramNode"===n||"#decorator"===n){var i=e,o=void 0;if(i.params!==rr)for(var a=0,s=i.params;a<s.length;a++){var c=s[a];if("#decoratorNode"===(o=c.kind))m(n,o,c);else if("#param"===o||"#property"===o)h(n,o,c),"#property"===c.kind&&("innerHTML"===c.name&&t.error("innerHTML is not authorized (security restriction)",c),"#element"!==i.kind&&t.error("Properties can only be used on element nodes",c));else if("#preprocessor"===o)t.acceptPreProcessors||t.error("Pre-processors are not accepted in this context",c);else if("#label"===o){var d=c;d.fwdLabel?(h(n,"##label",d),d.isOrphan||"string"==typeof d.value||"object"==typeof d.value||t.error("Forward labels values must be strings or expressions",d)):(h(n,"#label",c),d.isOrphan||"boolean"==typeof d.value||"object"==typeof d.value||t.error("Labels values must be expressions or booleans",d))}else if("#decorator"===o){var l=c,u=l.ref.code,p=lr[u];if("#paramNode"!==n||"paramValue"===u||u.match(ar)?p!==rr&&p[n]===ir?t.error("@"+u+" is not supported on "+sr[n],l):u.match(ar)&&(dr[n]["@onevent"]||t.error("Event handlers are not supported on "+sr[n],l)):t.error("Only @paramValue and event listener decorators can be used on Parameter nodes",l),"content"===u){var f=i;f.content&&f.content.length?t.error("@content can only be used on empty elements or fragments",l):l.defaultPropValue&&"#expression"!==l.defaultPropValue.kind?t.error("@content value cannot be a "+typeof l.defaultPropValue,l):l.defaultPropValue&&"#expression"===l.defaultPropValue.kind&&l.defaultPropValue.oneTime&&t.error("@content expression cannot use one-time qualifier",l)}else"paramValue"===u?(i.params.length>1&&t.error("@paramValue cannot be mixed with other parameters",l),l.defaultPropValue===rr&&t.error("Incorrect value for @paramValue",l)):"async"===u&&"#fragment"!==n&&"#element"!==n&&"#component"!==n&&t.error("@async cannot be used on "+sr[n],l)}if(c.value!==rr&&"object"==typeof c.value)c.value.isBinding&&"#decorator"!==n&&"#decoratorNode"!==n&&"#component"!==n&&"#paramNode"!==n&&t.error("Binding expressions cannot be used on "+cr[n]+" "+cr[c.kind],c)}}function h(e,n,i){if(i)switch(r[n]){case ir:m(e,n,i);case or:t.error(sr[n]+" are not yet supported on "+sr[e],i)}}function m(e,n,r){t.error(sr[n]+" are not supported on "+sr[e],r)}},getShortPath:function(e){var t=e.split(/\/|\\/);return t.length>2&&(e=".../"+t[t.length-2]+"/"+t[t.length-1]),e},throwError:function(e,t,n,r,i,o,a){void 0===i&&(i="IVY"),void 0===o&&(o=0),void 0===a&&(a=0),r=this.getShortPath(r);var s=this.getLineInfo(n,t),c={kind:"#Error",origin:i,message:"",description:e,line:s.lineNbr+o,column:1===s.lineNbr?s.columnNbr+a:s.columnNbr,lineExtract:s.lineContent.trim(),file:r};throw c.message=this.getErrorMessage(c.origin,c.description,c.file,c.line,c.column,c.lineExtract),c},getErrorMessage:function(e,t,n,r,i,o){return e+":"+t+"\nFile: "+n+" - Line "+r+" / Col "+i+"\nExtract: >> "+o+" <<"},getLineInfo:function(e,t){var n=e.split("\n"),r=0,i=0,o=0;if(t>-1)for(;o<n.length;){if(!(i+(r=n[o].length)<t))return{lineNbr:o+1,lineContent:n[o],columnNbr:1+t-i};o++,i+=r+1}return{lineNbr:0,lineContent:"",columnNbr:0}},nodeName:function(e){return cr[e]||e}};!function(e){e[e.Block=1]="Block",e[e.Component=2]="Component",e[e.Async=3]="Async"}(nr||(nr={}));var pr=void 0,fr=/\"/g,hr=/\\/g,mr=/\n/g,vr=/\/\/\s*log\s*/,gr=/^on(\w+)$/,br={xhtml:"http://www.w3.org/1999/xhtml",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",mathml:"http://www.w3.org/1998/mathml"};function yr(e,t,n){return i(this,void 0,void 0,(function(){var r,i,a,s,c,d,l,u;return o(this,(function(o){switch(o.label){case 0:return n.lineOffset=n.lineOffset||0,r=!1,e===pr&&t.error("Invalid template string"),e.match(vr)&&(r=!0,e=e.replace(vr,"")),i={line1:n.lineOffset?n.lineOffset+1:1,col1:n.columnOffset?n.columnOffset+1:1,fileId:n.filePath||"",templateType:n.templateType||"$template",preProcessors:n?n.preProcessors:void 0},[4,Un(e,i)];case 1:if(a=o.sent(),t.init(e,n),s=t.process(a),r){for(l in c=s.importMap||n.importMap,d=[],c)c.hasOwnProperty(l)&&d.push(l);u="-------------------------------------------------------------------------------",console.log(u),console.log("imports: ",d.join(", ")),console.log("template: "+s.function),console.log(u)}return[2,s]}}))}))}function xr(e){return'"'+e.replace(hr,"\\\\").replace(fr,'\\"').replace(mr,"\\n")+'"'}var Nr=function(){function e(e,t,n,r,i,o,a,s){this.kind=t,this.node=n,this.idx=r,this.parentView=i,this.iFlag=o,this.nodeCount=0,this.instructions=[],this.indent="",this.prevKind="",this.nextKind="",this.instanceCounterVar="",this.blockIdx=0,this.jsVarName="ζ",this.cmVarName="ζc",this.childBlockCreated=[],this.childBlockIndexes=[],this.childViewIndexes=[],this.exprCount=0,this.expr1Count=0,this.dExpressions=[],this.hasChildNodes=!1,this.hasParamNodes=!1,this.asyncValue=0,this.cptIFlag=-1,this.cpnParentLevel=-1,this.paramInstanceVars=void 0,this.bindingsCount=0;var c=a.addViewInstruction(e,t,n,r,i,o,a,s);this.vi=c,this.gc=c.gc,this.instructions=c.instructions,this.indent=c.indent,this.nodeCount=c.nodeCount,this.jsVarName=c.jsVarName,this.cmVarName=c.cmVarName,this.hasChildNodes=c.hasChildNodes,this.childBlockIndexes=c.childBlockIndexes,this.childViewIndexes=c.childViewIndexes,this.paramInstanceVars=c.paramInstanceVars,this.asyncValue=c.asyncValue,this.exprCount=c.exprCount,this.expr1Count=c.expr1Count,this.dExpressions=c.dExpressions,this.bindingsCount=c.bindingsCount}return e.prototype.scan=function(){if("asyncBlock"===this.kind)this.generateInstruction([this.node],0,0,this.iFlag,this.prevKind,this.nextKind);else{var e=this.node.content,t=e?e.length:0;if(0===t)return;var n=0;if(t>1){for(var r=0,i=void 0,o=0;t>o&&!("#jsStatement"!==(i=e[o]).kind&&"#paramNode"!==i.kind&&++r>1);o++);r>1&&(this.nodeCount=1,this.gc.addFraInstruction(null,0,this,this.iFlag,n),n=1)}this.scanContent(e,n,this.iFlag)}this.vi.update&&this.vi.update(this.indent,this.nodeCount,this.hasChildNodes,this.asyncValue,this.exprCount,this.expr1Count,this.bindingsCount,this.paramInstanceVars)},e.prototype.scanContent=function(e,t,n){for(var r="",i="",o=e?e.length:0,a=0;o>a;a++)i=a<o-1?e[a+1].kind:"",this.generateInstruction(e,a,t,n,r,i),r=e[a].kind},e.prototype.generateInstruction=function(t,n,r,i,o,a){var s,c=t[n],d=this.nodeCount;"#jsStatement"!==c.kind&&"#paramNode"!==c.kind&&(this.nodeCount++,this.hasChildNodes=!0),ur.validateXjsNode(c,this.gc);var l="",u=-1,p=-1,f=!1;"#element"!==c.kind&&"#component"!==c.kind&&"#paramNode"!==c.kind||(u=(s=this.registerStatics(c.params))[0],p=s[1],f=s[2],u>-1&&p>-1?l=", ζs"+u+", ζs"+p:u>-1?l=", ζs"+u:p>-1&&(l=", 0, ζs"+p));var h="";switch(c.kind){case"#cdata":c.params!==pr&&c.params.length&&this.gc.error("Params, properties, decorators or labels are not supported on cdata sections",c.params[0]);case"#textNode":this.gc.addTxtInstruction(c,d,this,i,r,"0");break;case"#fragment":if(!this.processAsyncCase(c,d,r,o,a)){(h=this.retrieveXmlNs(c))&&this.gc.addXmlNsInstruction(this,i,!0,h),this.gc.addFraInstruction(c,d,this,i,r);var m=this.generateDecoratorInstructions(c,d,i);F(this,c.content),R(this,m)}break;case"#element":if(!this.processAsyncCase(c,d,r,o,a)){(h=this.retrieveXmlNs(c))&&this.gc.addXmlNsInstruction(this,i,!0,h),this.gc.addEltInstruction(c,d,this,i,r,this.generateLabelStatics(c),l),this.generateParamInstructions(c,d,i,!0,this),this.generateDynLabelInstructions(c,d,i,this);m=this.generateDecoratorInstructions(c,d,i);this.createListeners(c,d,i,this),F(this,c.content),R(this,m)}break;case"#component":if(!this.processAsyncCase(c,d,r,o,a)){var v=!(f||c.content&&c.content.length),g=this.gc.addCptInstruction(c,d,this,i,r,this.generateLabelStatics(c),v,u);f&&this.generateParamInstructions(c,d,i,!1,this);m=this.generateDecoratorInstructions(c,d,i,!1,!0);if(this.generateDynLabelInstructions(c,d,i,this),c.content&&c.content.length)($=new e(this,"cptContent",c,d,this,1,this.gc)).contentParentInstruction=g,$.cptIFlag=i,$.cpnParentLevel=r,this.hasParamNodes=!1,$.scan(),$.hasChildNodes||this.hasParamNodes||(g.callImmediately=v=!0),this.hasParamNodes=!1;this.createListeners(c,d,i,this)&&(g.callImmediately=v=!1),v||g.addEndInstruction(),R(this,m)}break;case"#paramNode":this.parentView||this.gc.error("Param nodes cannot be defined at root level",c);for(var b=this,y=0,x=0,N=c.name;b;)if(b.cptIFlag>-1&&(y=b.cptIFlag),b.cpnParentLevel>-1&&(x=b.cpnParentLevel),"asyncBlock"===b.kind)this.gc.error("Param nodes cannot be defined in @async blocks",c);else if("jsBlock"===b.kind)b=b.parentView;else{if("cptContent"===b.kind||"paramContent"===b.kind){b=b.parentView;break}if("template"===b.kind)break;this.gc.error("Param nodes cannot be defined in "+b.kind+" views",c)}var w=b.nodeCount++;b.hasParamNodes=!0;for(var k=this,I=!1,C=null;k;){if("jsBlock"!==k.kind){if("cptContent"===k.kind||"paramContent"===k.kind){C=k;break}break}I=!0,k=k.parentView}if(C||this.gc.error("Internal error: contentParentView should be defined",c),I){var P=C.contentParentInstruction.dynamicPNodeNames;P.indexOf(N)<0&&P.push(N)}b.paramInstanceVars||(b.paramInstanceVars={});var V=b.paramInstanceVars[N];V||(V="ζp"+this.gc.paramCounter++,this.gc.localVars[""+V]=1,b.paramInstanceVars[N]=V);var $,j=C.contentParentInstruction.idx,D=void 0!==c.content&&c.content.length>0,O=this.gc.addPndInstruction(this,c,w,b,y,x+1,"0",u,this.indent,j,V,D);if(this.generateParamInstructions(c,w,y,!1,b),this.createListeners(c,w,y,b),D)($=new e(this,"paramContent",c,w,b,1,this.gc)).indent=this.indent,$.contentParentInstruction=O,$.cpnParentLevel=x+1,$.scan(),O.addEndInstruction();break;case"#jsStatement":this.gc.addJsStatementsInstruction(c,this,i,o);break;case"#jsBlock":if(!this.childBlockCreated[d])for(var E=0,A=n;t.length>A&&"#jsBlock"===t[A].kind;A++)this.gc.addCntInstruction(d+E,this,this.iFlag,r,nr.Block),this.childBlockCreated[d+E]=!0,E++;this.childBlockIndexes.push(d);var S=new e(this,"jsBlock",c,d,this,this.iFlag?this.iFlag+1:0,this.gc);S.prevKind=o,S.nextKind=a,S.scan();break;case"#tplFunction":this.gc.error("$template statements are not supported yet",c)}function F(e,t){t&&(e.scanContent(t,r+1,i),h&&e.gc.addXmlNsInstruction(e,i,!1,h))}function R(e,t){if(t)for(var n=0;t.length>n;n++)t[n].addEndInstruction()}},e.prototype.retrieveXmlNs=function(e){var t="",n=e.params;if(n&&n.length)for(var r=0,i=n;r<i.length;r++){var o=i[r];if("#param"===o.kind&&"xmlns"===o.name)t?this.gc.error("xmlns cannot be defined twice",o):o.value===pr||"string"!=typeof o.value?this.gc.error("xmlns value must be a string",o):((o.isOrphan||o.value===pr)&&this.gc.error("xmlns value cannot be empty",o),t=o.value);else if("#decorator"===o.kind&&"xmlns"===o.ref.code)if(t)this.gc.error("xmlns cannot be defined twice",o);else if(o.defaultPropValue===pr||"string"!=typeof o.defaultPropValue)this.gc.error("@xmlns value must be a string",o);else{var a=o.defaultPropValue;br[a]?t=br[a]:this.gc.error('Invalid @xmlns value: must be "html", "xhtml", "svg" or "mathml"',o)}}return""===t&&"#element"===e.kind&&"svg"===e.name.toLowerCase()&&(t=br.svg),t},e.prototype.registerStatics=function(e){if(!e||!e.length)return[-1,-1,!1];for(var t,n,r=-1,i=pr,o=-1,a=pr,s="",c=!1,d=this.gc.statics,l=d.length,u=0;e.length>u;u++)s="","#param"===(n=e[u]).kind||"#property"===n.kind?(t=n.value,n.isOrphan?s="true":"object"==typeof t?c=!0:s="string"==typeof t?xr(t):""+t,s&&("#param"===n.kind?(i=i||[],r=p(n.name,s,r,i)):(a=a||[],o=p(n.name,s,o,a)))):"#decorator"!==n.kind&&"#decoratorNode"!==n.kind||(c=!0);return f(r,i),f(o,a),[r,o,c];function p(e,t,n,r){return n<0&&(n=l,l++),r.push(xr(e)),r.push(t),n}function f(e,t){t&&(d[e]="ζs"+e+" = ["+t.join(", ")+"]")}},e.prototype.generateLabelStatics=function(e){if(e.params===pr)return"0";for(var t=[],n=0,r=e.params;n<r.length;n++){var i=r[n];"#label"===i.kind&&i.isOrphan&&t.push(xr("#"+i.name))}if(!t.length)return"0";var o=this.gc.statics,a=o.length;return o[a]="ζs"+a+" = ["+t.join(", ")+"]","ζs"+a},e.prototype.generateParamInstructions=function(e,t,n,r,i){var o=e.params;if(o!==pr)for(var a="#paramNode"===e.kind,s=0,c=o;s<c.length;s++){var d=c[s];if("#param"===d.kind||"#property"===d.kind)d.value&&"#expression"===d.value.kind&&this.gc.addParamInstruction(this,d,t,i,n,r,this.indent,a);else if(a&&"#decorator"===d.kind){var l=d;"paramValue"===l.ref.code&&this.gc.addParamInstruction(this,l,t,i,n,!1,this.indent,!0)}}},e.prototype.generateDynLabelInstructions=function(e,t,n,r){if(e.params!==pr)for(var i=0,o=e.params;i<o.length;i++){var a=o[i];"#label"!==a.kind||a.isOrphan||!a.value||a.fwdLabel||this.gc.addLblInstruction(a,t,r,n,this.indent)}},e.prototype.processAsyncCase=function(t,n,r,i,o){var a=0;if(t===this.node)return!1;if(t.params)for(var s=0,c=t.params;s<c.length;s++){var d=c[s];if("#decorator"===d.kind&&"async"===d.ref.code){if(!d.hasDefaultPropValue){d.params&&this.gc.error("Async decorator doesn't accept multiple params",d),a=1;break}var l=d.defaultPropValue;"object"==typeof l?a=l:"number"==typeof l?a=l:this.gc.error("@async value must be either empty or a number or an expression",d)}}if(a){this.gc.addCntInstruction(n,this,this.iFlag,r,nr.Async);var u=new e(this,"asyncBlock",t,n,this,this.iFlag?this.iFlag+1:0,this.gc);return u.setAsync(a),u.prevKind=i,u.nextKind=o,u.scan(),!0}return!1},e.prototype.setAsync=function(e){this.asyncValue=e},e.prototype.generateDecoratorInstructions=function(e,t,n,r,i){var o;void 0===r&&(r=!0),void 0===i&&(i=!0);var a=void 0;if(e.params!==pr)for(var s=e.kind,c="",d=0,l=e.params;d<l.length;d++){var u=l[d];if("#decorator"===u.kind)if("content"===(c=u.ref?u.ref.code:""))r&&("#element"!==s&&"#fragment"!==s||this.gc.addInsInstruction(u,e,t,this,n));else{if("async"===c||"key"===c||"paramValue"===c||"xmlns"===c||c.match(gr))continue;if(i){var p,f;p=(o=this.registerStatics(u.params))[0],o[1],f=o[2];var h=this.nodeCount++,m=this.gc.addDecoInstruction(u,h,t,this,n,this.indent,p,this.generateLabelStatics(u));f&&this.generateParamInstructions(u,h,n,!1,this),this.generateDynLabelInstructions(u,h,n,this),this.createListeners(u,h,n,this),a?a.push(m):a=[m]}}}return a},e.prototype.createListeners=function(e,t,n,r){if(e.params===pr)return!1;for(var i=!1,o=0,a=e.params;o<a.length;o++){var s=a[o];"#decorator"===s.kind&&s.ref.code.match(gr)&&(this.gc.addEvtInstruction(s,RegExp.$1,r.nodeCount++,t,r,n),i=!0)}return i},e}(),wr=/\"/g,kr=/\\/g,Ir=/\n/g,Cr=/^\n*/,Pr="$",Vr="$api",$r="$api",jr="$template",Dr="$apiClassName",Or=function(){function e(){this.template="",this.indentIncrement="    ",this.templateName="",this.filePath="",this.errorPath="",this.statics=[],this.localVars={},this.blockCount=0,this.eachCount=0,this.templateArgs=[],this.paramCounter=0,this.acceptPreProcessors=!1,this.fragmentMode=!1}return e.prototype.init=function(e,t){this.template=e,this.options=t,this.imports=t.importMap||{},this.templateName=t.templateName.replace(wr,""),this.filePath=t.filePath.replace(wr,""),this.errorPath=ur.getShortPath(this.filePath)},e.prototype.error=function(e,t){var n=this.options.filePath||"",r=this.options.lineOffset||0,i=this.options.columnOffset||0;ur.throwError("Invalid "+ur.nodeName(t.kind)+" - "+e,t.pos,this.template,n,"IVY",r,i)},e.prototype.decreaseIndent=function(e){var t=this.indentIncrement.length;return e.length>t?e.substring(0,e.length-t):e},e.prototype.process=function(e){var t,n,r=this.fragmentMode="#tplFunction"!==e.kind;this.fragmentMode?(n={kind:"#tplFunction",indent:"",content:e.content,name:"[$fragment template string]",pos:0},t=this.expressionRoots={}):n=e;var i=this,o=this.options,a=[];return function(){var e=n.arguments;if(e)for(var s=0;e.length>s;s++)i.templateArgs.push(e[s].name);new Nr(null,"template",n,1,null,0,i,n.indent).scan(),i.processRoot(a);var c={};(o.function||o.body)&&(c.body=function(){for(var e=[],i=0,o=a;i<o.length;i++){var s=o[i];"string"==typeof s?e.push(s):"#expression"===s.kind?(r&&(t[Mr(s.code)]=1),e.push(s.code)):"#jsStatement"===s.kind?e.push(s.code):"#jsBlock"===s.kind&&e.push(s.startCode.replace(Cr,""))}return"\n"+e.join("")+_r(n.indent)}());o.statics&&(c.statics=i.statics);var d=[];for(var l in t)t.hasOwnProperty(l)&&d.push(l);o.function&&(c.function=function(e,t,n,r,i){var o,a=[],s="",c="",d=t.arguments,l="",u=[],p=!1;if(e=_r(e),!n&&d&&d.length){var f=[],h=void 0,m="";s=", $, $api";for(var v=0;d.length>v;v++)if(m="",h=d[v],0!==v||h.name!==Pr&&h.name!==Vr||(l=h.typeRef||""),h.name===Pr)v>0&&h.typeRef&&r.error("Template Controller class must be defined as first argument",h);else if(h.name===Vr)v>0&&h.typeRef&&r.error("Template Api class must be defined as first argument",h);else if(h.name===jr)p=!0;else if(h.name===$r);else if(l)v>0&&u.push(h.name+' = $api["'+h.name+'"]');else{switch(u.push(h.name+' = $api["'+h.name+'"]'),h.typeRef){case"string":case"number":case"boolean":o=h.typeRef;break;case"IvContent":o="any";break;default:o=h.typeRef?h.typeRef:"any"}h.defaultValue&&(m=" = "+h.defaultValue);var g=h.optional?"?":"";f.push(""+(e+r.indentIncrement)+h.name+g+": "+o+m+";")}!l&&f.length&&(l="ζParams",b="ζΔD",r.imports[b]=1,c=[e,"@ζΔD"," class ζParams {\n",f.join("\n"),"\n",e,"}"].join(""))}var b;if(r.imports["ζt"]=1,t[Dr]=l,n){s=", $, $context";var y=r.imports,x=[];for(var N in y)y.hasOwnProperty(N)&&x.push(N+"=ζr."+N);a.push("const "+x.join(",")+";")}else a.push("(function () {");r.statics.length&&a.push(e+"const "+r.statics.join(", ")+";");c&&a.push(c);p&&p&&(s+=", $template");if(a.push(e+'return ζt("'+r.templateName+'", "'+r.errorPath+'", ζs0, function (ζ'+s+") {"),i.length>0){x=[];var w=void 0;for(v=0;i.length>v;v++)w=i[v],x.push(w+'=$context["'+w+'"]');a.push("let "+x.join(", ")+";")}u.length&&a.push(e+r.indentIncrement+"let "+u.join(", ")+";");return a.join("\n")}(n.indent,n,r,i,d)+c.body+function(e,t,n){if(t){var r="";return n.length>0&&(r=', undefined, ["'+n.join('","')+'"]'),"}"+r+");\n"+_r(e.indent)}var i=e[Dr];return i?"}, "+i+");\n"+_r(e.indent)+"})()":"});\n"+_r(e.indent)+"})()"}(n,r,d));o.imports&&(c.importMap=i.imports);r&&d.length>0&&(c.contextIdentifiers=d);return c}()},e.prototype.addTxtInstruction=function(e,t,n,r,i,o){var a=!0,s='""';if(n.gc.imports["ζtxt"+Er(r)]=1,"#cdata"===e.kind)s=Ar(e.text),a=!1;else{var c=e.expressions?e.expressions.length:0;if(e.textFragments.length<=1&&0===c)s=Ar(e.textFragments[0]);else{for(var d=n.gc,l=d.statics.length,u=[],p=e.textFragments.length,f=0,h=0;p>h;h++)u.push(Ar(e.textFragments[h])),f<c&&(u.push('""'),f++);d.statics.push("ζs"+l+" = ["+u.join(", ")+"]"),s="ζs"+l}}n.instructions.push((function(c){var d,l=n,u=0;if(a&&(u=(d=e).expressions?d.expressions.length:0),c.push(""+l.indent+Sr("txt",r)+l.jsVarName+", "+l.cmVarName+", "+r+", "+t+", "+i+", "+o+", "+s+", "+u),a)for(var p=0;u>p;p++)c.push(", "),Fr(c,d.expressions[p],l,r);c.push(");\n")}))},e.prototype.addXmlNsInstruction=function(e,t,n,r){e.gc.imports["ζxmlns"+Er(t)]=1,e.instructions.push((function(i){var o=e,a="";n&&(a=', "'+r+'"'),i.push(""+o.indent+Sr("xmlns",t)+o.jsVarName+", "+t+a+");\n")}))},e.prototype.addEltInstruction=function(e,t,n,r,i,o,a){n.gc.imports["ζelt"+Er(r)]=1,n.instructions.push((function(s){var c=n,d=e.content&&e.content.length?1:0,l="0"!==o||a?", "+o+a:"";s.push(""+c.indent+Sr("elt",r)+c.jsVarName+", "+c.cmVarName+", "+t+", "+i+', "'+e.name+'", '+d+l+");\n")}))},e.prototype.addFraInstruction=function(e,t,n,r,i){n.gc.imports["ζfra"+Er(r)]=1,n.instructions.push((function(e){var o=n;e.push(""+o.indent+Sr("fra",r)+o.jsVarName+", "+o.cmVarName+", "+t+", "+i+");\n")}))},e.prototype.addParamInstruction=function(e,t,n,r,i,o,a,s){var c;void 0===s&&(s=!1),c=o?"att":"par",t&&"#property"===t.kind&&(c="pro"),r.gc.imports["ζ"+c+Er(i)]=1,e.instructions.push((function(e){var o=r,d=i?"D":"",l="0",u=!0;"#decorator"!==t.kind&&(l='"'+t.name+'"');var p=t.value;if("par"===c){if("#decorator"===t.kind)(f=t.defaultPropValue)&&(p=f);p&&p.isBinding?(Lr(e,p.code,t,o,a,i,n,o.bindingsCount,l),o.bindingsCount++,u=!1):e.push(a+"ζpar"+d+"("+o.jsVarName+", "+o.cmVarName+", "+(i?1:0)+", "+n+", "+l+", ")}else e.push(a+"ζ"+c+d+"("+o.jsVarName+", "+(i?1:0)+", "+n+", "+l+", ");if(u){var f;if("#decorator"===t.kind)(f=t.defaultPropValue)&&Rr(e,f);else s?e.push(p):Fr(e,p,o,i);e.push(");\n")}}))},e.prototype.addDecoInstruction=function(e,t,n,r,i,o,a,s){var c=0,d=Er(i);if(r.gc.imports["ζdeco"+d]=1,e.defaultPropValue)c=1;else if(void 0!==e.params)for(var l=0,u=e.params;l<u.length;l++){if("#param"===u[l].kind){c=2;break}}function p(d){var l=r,u=i?"D":"",p=e.defaultPropValue,f="0"!==s,h=p&&"#expression"===p.kind&&p.isBinding;d.push(o+"ζdeco"+u+"("+l.jsVarName+", "+l.cmVarName+", "+(i?1:0)+", "+t+", "+n+", "),d.push(Ar(e.ref.code)+", "),Rr(d,e.ref),h?d.push(", 2"):(l.bindingsCount=0,d.push(", "+c)),!h&&(p||a>-1||f)&&(d.push(", "),p?Rr(d,p):d.push("0"),a>-1?d.push(", ζs"+a):f&&d.push(", 0"),f&&d.push(", "+s)),d.push(");\n"),h&&Lr(d,p.code,e,l,o,i,t,0,0)}return p.addEndInstruction=function(){r.gc.imports["ζdecoCall"+d]=1,r.instructions.push((function(e){var n=r;e.push(n.indent+"ζdecoCall"+d+"("+n.jsVarName+", "+n.cmVarName+", "+(i?1:0)+", "+t+");\n")}))},r.instructions.push(p),p},e.prototype.addLblInstruction=function(e,t,n,r,i){n.gc.imports["ζlbl"+Er(r)]=1,n.instructions.push((function(o){var a=n,s=r?"D":"",c=e.value;o.push(i+"ζlbl"+s+"("+a.jsVarName+", "+(r?1:0)+", "+t+', "#'+e.name+'", '),Rr(o,c),o.push(");\n")}))},e.prototype.addJsStatementsInstruction=function(e,t,n,r){t.instructions.push((function(n){var r=t;"$log"===e.name&&(e.code="console."+e.code),n.push(r.indent),n.push(e),e.code.match(/\n$/)||n.push("\n")}))},e.prototype.addCntInstruction=function(e,t,n,r,i){t.gc.imports["ζcnt"+Er(n)]=1,t.instructions.push((function(o){var a=t;o.push(""+a.indent+Sr("cnt",n)+a.jsVarName+", "+a.cmVarName+", "+e+", "+r+", "+i+");\n")}))},e.prototype.addCptInstruction=function(e,t,n,r,i,o,a,s){var c=[],d="";function l(u){var p;a=l.callImmediately;var f,h=n;f=(p=Tr(n,c,s,a?o:"0"))[0],d=p[1],h.bindingsCount=0,u.push(""+h.indent+Sr("cpt",r)+h.jsVarName+", "+h.cmVarName+", "+r+", "+t+", "+i+", "),Fr(u,e.ref,h,r),u.push(", "+(a?1:0)+f+");\n")}return n.gc.imports["ζcpt"+Er(r)]=1,l.idx=t,l.dynamicPNodeNames=c,l.callImmediately=a,l.addEndInstruction=function(){var e=this;c=l.dynamicPNodeNames,n.gc.imports["ζcall"+Er(r)]=1,n.instructions.push((function(t){var i=n,a="";d?a=", 0, "+o+", "+d:"0"!==o&&(a=", 0, "+o),t.push(""+i.indent+Sr("call",r)+i.jsVarName+", "+e.idx+a+");\n")}))},n.instructions.push(l),l},e.prototype.addPndInstruction=function(e,t,n,r,i,o,a,s,c,d,l,u){var p,f=[];function h(e){var o,h,m=r;h=(o=Tr(r,f,s,u?"0":a))[0],p=o[1],e.push(c+"ζpnode("+m.jsVarName+", "+m.cmVarName+", "+i+", "+n+", "+d+', "'+t.name+'", '+l+"++"+h+");\n")}return e.gc.imports["ζpnode"]=1,h.idx=n,h.dynamicPNodeNames=f,h.addEndInstruction=function(){var t=this;e.gc.imports["ζpnEnd"]=1,e.instructions.push((function(e){var n=r,o="";p?o=", "+a+", "+p:"0"!==a&&(o=", "+a),e.push(c+"ζpnEnd("+n.jsVarName+", "+n.cmVarName+", "+i+", "+t.idx+o+");\n")}))},e.instructions.push(h),h},e.prototype.addEvtInstruction=function(e,t,n,r,i,o){i.gc.imports["ζevt"+Er(o)]=1,e.hasDefaultPropValue||e.params||i.gc.error("Missing event handler value for @"+e.ref.code,e),i.instructions.push((function(a){var s,c,d=i;if(e.defaultPropValue)"#expression"!==e.defaultPropValue.kind?d.gc.error("Event listeners must be function expressions - e.g. @onclick={e=>doSomething(e)}",e):s=e.defaultPropValue;else for(var l=0,u=e.params;l<u.length;l++){var p=u[l];"#param"===p.kind?"listener"===p.name?p.value?"#expression"!==p.value.kind?d.gc.error("listeners must be function expressions - e.g. listener={e=>doSomething(e)}",p):s=p.value:d.gc.error("listener value cannot be empty",p):"options"===p.name&&(p.value?"#expression"!==p.value.kind?d.gc.error("options value must be an expression - e.g. options={{passive:true, once:true}}",p):c=p.value:d.gc.error("options value cannot be empty",p)):d.gc.error("Invalid param on event listener",p)}if(s){var f="",h="";s.code.match(/^\s*(\=\>)|(\(\s*\)\s*\=\>)/)&&(f=", 1"),c&&(h=", "+c.code,f=f||", 0"),a.push(""+d.indent+Sr("evt",o)+d.jsVarName+", "+d.cmVarName+", "+n+", "+r+', "'+t+'", '),Rr(a,s),a.push(""+f+h+");\n")}else d.gc.error("Missing listener parameter",e)}))},e.prototype.addInsInstruction=function(e,t,n,r,i){r.gc.imports["ζins"+Er(i)]=1,r.instructions.push((function(t){var o=r,a=r.gc;!e.isOrphan&&e.defaultPropValue||a.templateArgs.indexOf("$")<0&&a.templateArgs.indexOf("$content")<0&&a.error("$ or $content must be defined as template arguments to use @content with no values",e),t.push(""+o.indent+Sr("ins",i)+o.jsVarName+", "+i+", "+n+", "),e.isOrphan||!e.defaultPropValue?t.push("$, 1);\n"):(Fr(t,e.defaultPropValue,o,i),t.push(");\n"))}))},e.prototype.addViewInstruction=function(e,t,n,r,i,o,a,s){var c,d="",l=0,u=s||"";if(i)c=i.gc,l=c.blockCount++,"cptContent"===t||"paramContent"===t?(u=i.indent,d=""):"asyncBlock"===t?(c.imports["ζasync"]=1,u=i.indent+c.indentIncrement,d=""):"jsBlock"===t&&(u=i.indent+c.indentIncrement,d="ζi"+l,c.localVars[d+" = 0"]=1,i.childViewIndexes.push(l));else{if(!a)throw new Error("ViewInstruction: either parentView or generationCtxt must be provided");l=(c=a).blockCount++,c.imports["ζinit"]=1,c.imports["ζend"]=1,c.statics[0]="ζs0 = {}"}var p={gc:c,indent:u,instructions:[],nodeCount:0,jsVarName:"ζ",cmVarName:"ζc",hasChildNodes:!1,childBlockIndexes:[],childViewIndexes:[],paramInstanceVars:void 0,asyncValue:0,exprCount:0,expr1Count:0,dExpressions:[],bindingsCount:0,update:function(e,t,n,r,a,s,d,l){p.indent=e,p.nodeCount=t,p.hasChildNodes=n,p.paramInstanceVars=l,p.asyncValue=r,p.exprCount=a,p.expr1Count=s,p.bindingsCount=d,i&&n&&(c.imports["ζview"+Er(o)]=1,c.imports["ζend"+Er(o)]=1)}};l>0&&(p.jsVarName="ζ"+l,p.cmVarName="ζc"+l,c.localVars[p.jsVarName]=1,c.localVars[p.cmVarName]=1);var f=this;function h(e){var a="#jsBlock"===n.kind;if(a){var s=n,u=s.args,h=s.name;if("$each"===h){var m;Array.isArray(u[0])?(f.fragmentMode&&(f.expressionRoots[u[0][0]]=1),m=u[0].join(".")):(m=u[0],f.fragmentMode&&(f.expressionRoots[m]=1));var v=++c.eachCount,g="let ζec"+v+"="+m+", ζl"+v+"=ζec"+v+"? ζec"+v+".length:0;",b="for (let ζx"+v+"=0;ζl"+v+">ζx"+v+";ζx"+v+"++) {",y="let "+u[1]+"=ζec"+v+"[ζx"+v+"]",x="",N="";u.length>2&&(x=", "+u[2]+"=ζx"+v),u.length>3&&(N=", "+u[3]+"=ζx"+v+"===ζl"+v+"-1"),s.startCode=g+b+y+x+N+";",s.endCode="}"}else!f.fragmentMode||"$if"!==h&&"$elseif"!==h||("$if"===h?s.startCode="if ("+s.args[0].join(".")+") {":"$elseif"===h&&(s.startCode="else if ("+s.args[0].join(".")+") {"),f.expressionRoots[u[0][0]]=1);e.push(c.decreaseIndent(p.indent)),e.push(s),s.startCode.match(/\n$/)||e.push("\n")}else if("asyncBlock"===t){var w=i;e.push(c.decreaseIndent(p.indent)),e.push(""+Sr("async",o)+w.jsVarName+", "+o+", "+r+", "),"number"==typeof p.asyncValue?e.push(""+p.asyncValue):Fr(e,p.asyncValue,w,o),e.push(", function () {\n")}if(p.instructions.length){var k="";if(p.childBlockIndexes.length){var I=c.statics,C=I.length;I.push("ζs"+C+" = ["+p.childBlockIndexes.join(", ")+"]"),k=", ζs"+C}if(p.hasChildNodes){var P="",V="ζ";if(i)p.childViewIndexes.length&&e.push(p.indent+"ζi"+p.childViewIndexes.join(" = ζi")+" = 0;\n"),V=i.jsVarName,P=d?", ++"+d:", 0";else{var $=[],j=c.localVars;for(var D in j)j.hasOwnProperty(D)&&$.push(D);$.push("ζc = ζinit(ζ, ζs0, "+p.nodeCount+")"),$.length&&e.push(p.indent+"let "+$.join(", ")+";\n")}l>0&&(e.push(""+p.indent+p.jsVarName+" = "+Sr("view",o)+V+", "+o+", "+r+", "+p.nodeCount+P+");\n"),e.push(""+p.indent+p.cmVarName+" = "+p.jsVarName+".cm;\n"))}if(void 0!==p.paramInstanceVars){$=[];for(var D in p.paramInstanceVars)p.paramInstanceVars.hasOwnProperty(D)&&$.push(p.paramInstanceVars[D]);e.push(""+p.indent+$.join(" = ")+" = 0;\n")}for(var O=0,E=p.instructions;O<E.length;O++){var A=E[O];"function"==typeof A?A(e):A.pushCode(e)}p.hasChildNodes&&e.push(""+p.indent+Sr("end",o)+p.jsVarName+", "+p.cmVarName+k+");\n")}if(a){var S=n;e.push(c.decreaseIndent(p.indent)),e.push(S.endCode),S.endCode.match(/\n$/)||e.push("\n")}else"asyncBlock"===t&&e.push(i.indent+"});\n")}return null!==e?e.instructions.push(h):this.processRoot=h,p},e}();function Er(e){return e?"D":""}function Ar(e){return'"'+e.replace(kr,"\\\\").replace(wr,'\\"').replace(Ir,"\\n")+'"'}function Sr(e,t){return t?"ζ"+e+"D(":"ζ"+e+"("}function Fr(e,t,n,r){if("string"!=typeof t&&t.oneTime){var i=r?", 1":"";e.push("ζo("+n.jsVarName+", "+n.expr1Count+++", "+n.cmVarName+"? "),e.push(t),e.push(" : ζu"+i+")"),n.gc.imports["ζo"]=1,n.gc.imports["ζu"]=1}else 0===r?(e.push("ζe("+n.jsVarName+", "+n.exprCount+++", "),e.push(t),e.push(")")):(void 0===n.dExpressions[r]?n.dExpressions[r]=0:n.dExpressions[r]++,e.push("["+n.dExpressions[r]+", "),e.push(t),e.push("]")),n.gc.imports["ζe"]=1}function Rr(e,t){"#expression"===t.kind?e.push(t):"string"==typeof t?e.push(Ar(t)):e.push(""+t)}function Lr(e,t,n,r,i,o,a,s,c,d){var l=o?"D":"",u=function(e){var t="",n="",r="";e.match(/(.*)\.([a-zA-Z_][a-zA-Z_0-9]*)$/)?(t=RegExp.$1,n='"'+RegExp.$2+'"'):r="Invalid binding expression: {="+e+"}";return{hostExp:t,propExp:n,errorMsg:r}}(t),p=u.hostExp,f=u.propExp,h=u.errorMsg;void 0!==d&&(d[Mr(p)]=1),h?r.gc.error(h,n):(r.gc.imports["ζbind"+Er(o)]=1,e.push(i+"ζbind"+l+"("+r.jsVarName+", "+r.cmVarName+", "+(o?1:0)+", "+a+", "+s+", "+c+", "+p+", "+f+");\n"))}function Tr(e,t,n,r){var i="";if(t&&t.length){for(var o=e.gc.statics.length,a=0;t.length>a;a++)t[a]=Ar(t[a]);return i="ζs"+o,e.gc.statics[o]=i+" = ["+t.join(", ")+"]",[", "+r+", "+(n>-1?"ζs"+n:"0")+", ζs"+o,i]}return n>-1?[", "+r+", ζs"+n,""]:"0"!==r?[", "+r,""]:["",""]}function _r(e){return e.length>3?e.slice(0,-4):e}function Mr(e){var t=e.indexOf(".");return t>-1?e.slice(0,t):e}var Br=function(){function e(e,t,n,r){this._defaultPrevented=!1,this._immediatePropagationStopped=!1,this._type=e,this._target=t,this._cancelable=n,this.data=r||null}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this._defaultPrevented},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"immediatePropagationStopped",{get:function(){return this._immediatePropagationStopped},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){this._cancelable&&(this._defaultPrevented=!0)},e.prototype.stopImmediatePropagation=function(){this._immediatePropagationStopped=!0},e}(),Hr=function(){function e(){this._cancelableEvents=!1,this._target=null,this._eventType=""}return e.prototype.init=function(e,t){this._eventType||(this._eventType=e,this._target=t||null)},Object.defineProperty(e.prototype,"listenerCount",{get:function(){return this._listeners?this._listeners.length:0},enumerable:!0,configurable:!0}),e.prototype.addListener=function(e){return this._listeners?this._listeners.push(e):this._listeners=[e],e},e.prototype.removeListener=function(e){var t=this._listeners;if(t)if(1===t.length&&t[0]===e)this._listeners=void 0;else{var n=t.indexOf(e);n>-1&&t.splice(n,1)}},e.prototype.removeAllListeners=function(){this._listeners=void 0},e.prototype.emit=function(e){if(this._listeners){for(var t=new Br(this._eventType,this._target,this._cancelableEvents,e||null),n=!0,r=0,i=this._listeners;r<i.length;r++){if((0,i[r])(t),t.defaultPrevented&&(n=!1),t.immediatePropagationStopped)break}return n}return!0},e}(),Xr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(Hr),zr=(function(e){function n(){var t=e.call(this)||this;return t._cancelableEvents=!0,t}t(n,e)}(Hr),void 0),Kr="$fragment",Jr="ζtemplate",Ur=function(){function e(){this.kind=Kr,this.ΔΔtemplate=""}return e.prototype.ΔDefault=function(e){switch(e){case"kind":return Kr;case"template":return""}return L},n([R(_),r("design:type",String)],e.prototype,"kind",void 0),n([R(_),r("design:type",String)],e.prototype,"template",void 0),e=n([F],e)}();function Wr(e,t,n,r){return i(this,void 0,void 0,(function(){var i,a,s;return o(this,(function(o){switch(o.label){case 0:if("$fragment"!==e.kind)throw"Invalid $fragment template";return e.createInstance!==zr&&e[Jr]===e.template?[3,2]:[4,yr(e.template,new Or,{templateName:"testTpl",filePath:"[$fragment string]",statics:!0,function:!0,templateType:"$fragment",preProcessors:r?r.preProcessors:void 0})];case 1:i=o.sent(),a=new Function("ζr",i.function||""),e.createInstance=a(_t),e[Jr]=e.template,o.label=2;case 2:return s=e.createInstance(),r&&r.doc&&(s.document=r.doc),s.attach(t),s.render(n!==zr?{context:n}:zr),[2,s]}}))}))}var Zr,qr,Yr,Gr,Qr,ei,ti,ni=Dt(function(){function e(){}return n([Ot,At,r("design:type",Object)],e.prototype,"ΔΔvalue",void 0),n([Nt(),r("design:type",Object)],e.prototype,"value",void 0),n([Nt(kt(),2),r("design:type",Object)],e.prototype,"context",void 0),n([Nt(0,2),r("design:type",Object)],e.prototype,"doc",void 0),n([At,r("design:type",Object)],e.prototype,"ΔΔ$targetElt",void 0),n([Nt(),r("design:type",Object)],e.prototype,"$targetElt",void 0),n([Nt(wt(Xr)),r("design:type",Xr)],e.prototype,"completeEmitter",void 0),e=n([Vt],e)}(),(function(e){var t,n,r=!1,a=!0,s="";return{$render:function(){return i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return a?(a=!1,void 0===e.value?[3,2]:(r=!0,[4,c(e.value)])):[3,4];case 1:return i.sent(),[3,3];case 2:throw"Missing value param";case 3:return[3,7];case 4:return r?e.value!==t||e.value.template!==s?[3,5]:(n!==zr&&n.render({context:e.context}),[3,7]):[3,7];case 5:return n&&n.dispose(),[4,c(e.value)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))}};function c(r){return i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:if(t=r,r===zr||"$fragment"!==r.kind)throw"@fragment value must be a $fragment object";return[4,Wr(r,e.$targetElt,e.context,{doc:e.doc})];case 1:return n=i.sent(),s=r.template,e.completeEmitter.emit(),[2]}}))}))}})),ri={helloClass:"blue",alert:(Zr={},qr=["class","title"],Yr=[2,3],Gr=function(){function e(){this.ΔΔtype=""}return e.prototype.ΔDefault=function(e){switch(e){case"type":return""}return Pt},n([Nt(),r("design:type",Object)],e.prototype,"type",void 0),n([Nt(),r("design:type",Object)],e.prototype,"$content",void 0),n([Nt(),r("design:type",Object)],e.prototype,"title",void 0),e=n([xt],e)}(),Se("alert",".../fragment1/fragment1.ts",Zr,(function(e,t,n){var r,i,o=n.type,a=(n.$content,n.title),s=0,c=0,d=Re(e,0,5);Ke(e,d,0,0,"div",1),it(e,0,0,"class",Ze(e,0,"alert "+o)),Ke(e,d,1,1,"span",1,0,qr),Ge(e,d,2,2,1),Ge(e,d,3,2,1),a?(Ye(r=Le(e,0,2,1,++s),r.cm,0,0),gt(r,0,0,Ze(r,0,a)),ze(r)):(We(i=Le(e,0,3,1,++c),i.cm,0,0,0,0," Warning: ",0),ze(i)),Ye(e,d,4,1),gt(e,0,4,t,1),ze(e,0,Yr)}),Gr))};(function(){var e={},t=["class","output"],i=function(){function e(){}return n([Nt(),r("design:type",Object)],e.prototype,"frg",void 0),e=n([xt],e)}();return Se("main",".../fragment1/fragment1.ts",e,(function(e,n,r){var i=r.frg,o=Re(e,0,9);Ye(e,o,0,0),Ke(e,o,1,1,"div",1),We(e,o,0,2,2,0," Enter some text: ",0),Ke(e,o,3,1,"textarea",0),ut(e,o,0,4,3,"value",Kt,2),dt(e,o,0,4,0,0,i,"template"),mt(e,o,0,4),Ke(e,o,5,1,"div",1,0,t),We(e,o,0,6,2,0," Output: ",0),Ke(e,o,7,1,"div",0),ut(e,o,0,8,7,"fragment",ni,2),at(e,o,0,8,"value",Ze(e,0,i)),at(e,o,0,8,"context",Ze(e,1,ri)),mt(e,o,0,8),ze(e)}),i)})()().attach(document.body).render({frg:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=new Ur;if(0===t.length)return r.template=e[0],r;for(var i=[],o=e.length,a=t.length,s=0;o>s;s++)i.push(e[s]),s<a&&i.push(t[s].kind===Kr?t[s].template:t[s]);return r.template=i.join(""),r}(ti||(Qr=["<!> <div class={helloClass}> Hello <b> World </></><*alert type='warning'><.title><b> Achtung !!! </>: </> Some important message... </></>"],ei=["<!>\\ <div class={helloClass}> Hello <b> World </></><*alert type='warning'><.title><b> Achtung !!! </>: </> Some important message... </></>"],Object.defineProperty?Object.defineProperty(Qr,"raw",{value:ei}):Qr.raw=ei,ti=Qr))})}();
