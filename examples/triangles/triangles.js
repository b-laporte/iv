!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function e(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function t(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var n="ΔTrackable",i="ΔChangeVersion",o="ΔDefFactories",r="ΔΔProxy",a="ΔIsProxy",s="ΔDefault",d="ΔnewItem",l="Δjson",c=!1;function f(e){return e&&e.ΔTrackable?e.ΔMd?e.ΔMd:e.ΔMd={parents:void 0,refreshCtxt:void 0,watchers:void 0}:null}var u=Array.isArray;function v(e,t){e&&(u(e)&&!e[a]?e.forEach(t):t(e))}function p(e,t){if(e&&t){if(e===t)return;if(u(e)){var n=e;if(1===n.length){if(n[0]===t)return}else{var i=n.indexOf(t);if(i>-1)return n.splice(i,1),1===n.length?n[0]:n}}}return e}function h(e,t){return e?u(e)&&!e[a]?(e.push(t),e):[e,t]:t}function m(e){return e&&!0===e[n]?e[i]:0}function g(e,t){return!(!e||"object"!=typeof e)&&"ΔΔ"+t in e}function w(e){return!(!e||!0!==e[n])}function b(e){return m(e)%2==1}function x(e,t){var n=f(e);return n&&t?(n.watchers=h(n.watchers,t),b(e)&&z.register(e),t):null}function N(e,t){var n=e?e.ΔMd:void 0;n&&t&&(n.watchers=p(n.watchers,t))}function y(e,t){if(e&&t){var n=e[s];if(n){var i=n(t);if(i!==k)return e[t]=i}var r=e[o],a=r?r[t]:null;if(a)return e[t]=a()}}function C(e,t){var n,i;t&&function(e,t){if(w(e)){var n=e.constructor.prototype["ΔDefFactories"];for(var i in n)n.hasOwnProperty(i)&&t(i,e["ΔΔ"+i],n[i])}}(e,(function(o,r,a){var s=a===E;if(n=t[o],i="ΔΔ"+o,void 0===n)s&&(e[i]=void 0);else{var f=typeof n;if(null===n)(s||a===j)&&(e[i]=null);else if("object"===f){var u=function(e,t){if(e&&void 0!==t){if(e[d])return e[d](t);c=!0;var n=e[t];return c=!1,n}}(e,o);u?u[l]=n:s&&(e[i]=n)}else"string"===f?(s||a===A)&&(e[i]=n):"number"===f?(s||a===V)&&(e[i]=n):"boolean"===f?(s||a===O)&&(e[i]=n):s&&(e[i]=n)}}));e[l]=void 0}var k={};function D(){return""}D["ΔIsFactory"]=!0;var A=D;function I(){return 0}I["ΔIsFactory"]=!0;var V=I;function R(){return!1}R["ΔIsFactory"]=!0;var O=R;function P(){return null}P["ΔIsFactory"]=!0;var j=P;function $(){}$["ΔIsFactory"]=!0;var E=$;function S(e,t){if(t){var n=f(t);n&&(n.parents=h(n.parents,e))}}var F=0,T=function(){function e(){this.id=++F}return e.prototype.register=function(e){var t=this,n=f(e);n&&!n.refreshCtxt&&(this.objects?this.objects.push(e):(this.objects=[e],Promise.resolve().then((function(){t.refresh()}))),n.refreshCtxt=this)},e.prototype.refresh=function(e){void 0===e&&(e=!0);var t=this.objects,n=t?t.length:0;if(n){K();for(var i,o,r=[],a=0;n>a;a++)(o=(i=t[a]).ΔMd).refreshCtxt&&(i.ΔChangeVersion%2&&(i.ΔChangeVersion+=1),o.refreshCtxt&&o.watchers&&r.push({dataNode:i,watchers:o.watchers})),o.refreshCtxt=void 0;this.objects=void 0,r.length&&(e?X(r):Promise.resolve().then((function(){X(r)})))}},e}();function X(e){for(var t=function(e){v(e.watchers,(function(t){t(e.dataNode)}))},n=0,i=e;n<i.length;n++){t(i[n])}}var z=new T;function K(){z.objects&&(z=new T)}var M=0,H={log:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,arguments)},error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,arguments)}};function L(e,t){for(var n=e,i=[];n;){if(n.template){var o=n.template;i.push('\n>> Template: "'+o.templateName+'" - File: "'+o.filePath+'"')}n=n.parentView}H.error("IVY: "+t+i.join(""))}var W=void 0,q=11,_=/^ΔΔ(\w+)Emitter$/,B=/^ΔΔ(.+)$/,U="ΔIsAPI",Y="ΔIsController",Z=0,G=function(){function e(e,t,n,i,o){this.templateName=e,this.filePath=t,this.staticCache=n,this.renderFn=i,this.$Class=o,this._uid=++Z,this.tplApi=void 0,this.tplCtl=void 0,this.forceRefresh=!1,this.activeWatch=!1,this.lastRefreshVersion=0,this.processing=!1,this.rendering=!1,this.initialized=!1,this.labels=void 0,this.hasCtlClass=!1,this.view=ne(null,null,1,this);var r=this;this.watchCb=function(){r.notifyChange()},this.watchCb.$templateId=this._uid,this.$Class!==W&&(je(this.$Class,Y)?this.hasCtlClass=!0:je(this.$Class,U)||w(this.$Class.prototype)||L(this.view,"Type of $ argument must be either a @Controller, an @API or a @Data class"))}return e.prototype.dispose=function(e){void 0===e&&(e=!1);var t=this.view;this.disconnectObserver(),Q(t,this.tplCtl,"$dispose",this.templateName),e&&t&&t.nodes&&t.nodes.length&&Ae(t,t.nodes[0])},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.view.doc},set:function(e){this.view.doc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){if(!this.tplApi)if(this.hasCtlClass){var e=this.controller;e&&e.$api&&(this.tplApi=e.$api)}else this.$Class&&(this.tplApi=new this.$Class,J(this.view,this.tplApi,this.staticCache));return this.tplApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){if(!this.tplCtl&&this.hasCtlClass){var e=this.tplCtl=new this.$Class;if(g(e,"$template")&&(e.$template=this),g(e,"$logger")){var t=this.view;e.$logger={log:H.log,error:function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];L(t,e+(n.length?" "+n.join(" "):""))}}}e.$api&&J(this.view,e.$api,this.staticCache)}return this.tplCtl},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){if(this.view.rootDomNode)L(this.view,"Template host cannot be changed once set");else{var t=this.view;if(!t.doc)throw new Error("[iv] Template.document must be defined before calling Template.attach()");t.rootDomNode=e,t.anchorNode=t.doc.createComment("template anchor"),$e(t.anchorNode,e)}return this},e.prototype.registerLabel=function(e,t){this.labels||(this.labels={});var n=this.labels[e];n?n.push(t):n=this.labels[e]=[t]},e.prototype.query=function(e,t){if(void 0===t&&(t=!1),this.rendering)return null;for(var n=[],i=0,o=e.split(";");i<o.length;i++){var r=o[i];if(r&&"#"!==r.charAt(0))return L(this.view,"[$template.query()] Invalid label argument: '"+r+"' (labels must start with #)"),null;var a=this.labels&&this.labels[r]||null;if(a&&a.length){if(!t)return a[0];n=n.concat(a)}}return n.length?n:null},e.prototype.notifyChange=function(){this.render()},e.prototype.disconnectObserver=function(){this.activeWatch&&(N(this.api,this.watchCb),N(this.controller,this.watchCb),this.activeWatch=!1)},e.prototype.render=function(e,t){if(void 0===t&&(t=!1),this.processing)return this;t&&(this.forceRefresh=!0),this.processing=!0;var n=this.api,i=this.controller,o=this.view;if(i&&!w(i)&&(L(o,"Template controller must be a @Controller Object - please check: "+this.$Class.name),this.tplCtl=this.$Class=void 0),n&&e)for(var r in b(n)||K(),this.disconnectObserver(),e)e.hasOwnProperty(r)&&(n[r]=e[r]);var a=!this.forceRefresh,s=o.nodes;if(s&&s[0]&&s[0].attached||(a=!1),a&&m(n)+m(i)>this.lastRefreshVersion&&(a=!1),!a){i&&(this.initialized||(Q(o,i,"$init","controller"),this.initialized=!0),Q(o,i,"$beforeRender","controller")),this.rendering=!0,this.labels=void 0,o.lastRefresh++,o.instructions=void 0;try{this.renderFn(o,this.hasCtlClass?i:n,n,this)}catch(e){L(o,"Template execution error\n"+(e.message||e))}this.rendering=!1,i&&Q(o,i,"$afterRender","controller"),function(e,t){if(void 0===t&&(t=!1),e){var n=e.ΔMd;n&&n.refreshCtxt?n.refreshCtxt.refresh(!0):t&&K()}}(n),this.forceRefresh=!1,this.lastRefreshVersion=m(n)+m(i)}return this.activeWatch||(x(n,this.watchCb),i&&x(i,this.watchCb),this.activeWatch=!0),this.processing=!1,this},e}();function J(e,t,n){var i=n.events;if(void 0===i){var o=void 0;for(var r in t)if(r.match(_)){var a=RegExp.$1;o||(o=[]),"function"!=typeof t[a+"Emitter"].init?L(e,"Invalid EventEmitter: "+a+"Emitter"):(o.push(a+"Emitter"),o.push(a),t[a+"Emitter"].init(a,t))}n.events=o||null}else if(null!==i)for(var s=i.length,d=0;s>d;d+=2)t[i[d]].init(i[d+1],t)}function Q(e,t,n,i){if(t&&"function"==typeof t[n])try{t[n]()}catch(t){L(e,i+" "+n+" hook execution error\n"+(t.message||t))}}function ee(e,t){return(t=t||this.namespace)?this.doc.createElementNS(t,e):this.doc.createElement(e)}function te(){return function(e){if(e!==W&&null!==e){var t=!0;return function e(t,n,i){if(t!==W&&null!==t){if(!i(t))return!1;if(null!==t.nodes&&t.nodes.length)for(var o=0,r=t.nodes;o<r.length;o++){if(!a(r[o]))return!1}}return!0;function a(t){var o=t.kind;if("#fragment"===o)return!!i(t)&&e(t.contentView,n,i);if("#container"!==o)return i(t);if(!i(t))return!1;var r=t,a=r.subKind;if("##block"===a){var s=r.views;if(null!==s)for(var d=0,l=s;d<l.length;d++){var c=l[d];if(!e(c,n,i))return!1}if(n&&r.viewPool)for(var f=0,u=r.viewPool;f<u.length;f++){var v=u[f];if(!e(v,n,i))return!1}}else if("##cpt"===a){var p=r.template;if(null!==p)return e(p.view,n,i)}else"##async"===a&&console.log("TODO: support scanNode for @async block");return!0}}(e,!1,(function(e){if(!t)return!1;var n=e.kind;if("#view"===n){var i=e;if(i.cm){var o=i.doc.createDocumentFragment();i.domNode=o,i.cmAppends=[function(e){e.domNode?$e(e.domNode,o):e.domNode=o}]}!function(e){if(e.instructions){var t=e.instructions.slice(0),n=t.length;if(e.instructions.splice(0,n),e.instructions=void 0,n)for(var i=0;n>i;i+=2)t[i].apply(null,t[i+1])}}(i)}else if("#element"===n||"#text"===n)return t=!1;return!0})),t}return!0}(this)}function ne(e,t,n,i){var o={kind:"#view",uid:"view"+ ++M,attached:!1,nodes:null,namespace:void 0,namespaces:void 0,doc:null,parentView:e,cm:!0,cmAppends:null,lastRefresh:0,container:null,projectionHost:null,template:i,rootDomNode:null,anchorNode:null,expressions:void 0,oExpressions:void 0,instructions:void 0,paramNode:void 0,createElement:ee,isEmpty:te};return e?oe(o,e,t):o.doc="undefined"!=typeof document?document:null,o}function ie(e,t,n){if(n){var i=function(e){var t=e;for(;t&&!t.template;)t=t.parentView;return t}(e);if(i!==W&&null!==i)for(var o=i.template,r=n.length,a=0;r>a;a++)o.registerLabel(n[a],t)}}function oe(e,t,n){if(e.parentView=t,e.doc=t.doc,e.container=n,e.rootDomNode=t.rootDomNode,t.namespace){var i=t.namespace;e.namespace=i,e.namespaces=[i]}}function re(e,t,n,i,o){return function(){return new G(e,t,n,i,o)}}var ae=[];function se(e,t,n){var i=e.cm;return i?(e.nodes=new Array(n),e.cmAppends||(e.cmAppends=[],e.anchorNode&&(e.cmAppends[0]=function(t,n){t.domNode?Ee(t.domNode,e.anchorNode,e.rootDomNode):t.domNode=e.rootDomNode}))):e.cmAppends=null,i}function de(e,t,n,i,o){var r,a=e.nodes[n];if(a&&a.attached||L(e,"Invalid ζview call: container must be attached ("+(a?a.uid:"XX")+") - pview: "+e.uid+" containerIdx: "+n),"#container"===a.kind)if("##block"===a.subKind){var s=(d=a).views;1===o&&(d.insertFn=null),1===o&&d.views.length>1?(d.previousNbrOfViews=s.length,r=s.shift(),d.viewPool.length?d.viewPool=s.concat(d.viewPool):d.viewPool=s,d.views=[r]):(r=d.views[o-1])||(d.viewPool.length>0?(d.insertFn||(d.insertFn=le(e,d)),fe((r=s[o-1]=d.viewPool.shift()).nodes[0],d.insertFn),r.attached=!0):((r=s[o-1]=ne(e,d)).nodes=new Array(i),e.cm&&d.cmAppend?r.cmAppends=[d.cmAppend]:e.cm||(r.cmAppends=[le(e,d)]))),d.lastRefresh=r.lastRefresh=e.lastRefresh}else{var d;(r=(d=a).contentView)||((r=d.contentView=ne(e,d)).nodes=new Array(i)),r.lastRefresh=e.lastRefresh}else if("#param"===a.kind){var l=a;(r=l.contentView)||(r=l.contentView=ne(e,null),l.viewPool&&(l.viewPool[l.viewInstanceIdx]=r),r.nodes=new Array(i),r.paramNode=l),r.lastRefresh=e.lastRefresh}return r}function le(e,t){var n=function e(t,n){for(;;){if(n||L(t,"Internal error - findNextSiblingDomNd: nd cannot be undefined"),0===n.idx){if(!n.attached)return{position:"defer",parentDomNd:void 0};if(n.domNode.nodeType===q)return{position:"lastChild",parentDomNd:n.domNode};var i=t.parentView;if(i){if(t.projectionHost){var o=t.projectionHost.hostNode;return"#element"===o.kind?{position:"lastChild",parentDomNd:o.domNode}:e(t.projectionHost.view,o)}if(t.container&&"##block"===t.container.subKind){var r=t.container,a=r.views.indexOf(t);if(a>-1)for(var s=void 0,d=void 0,l=a+1;l<r.views.length;l++)if((s=r.views[l]).nodes&&s.nodes.length&&(d=m(s,s.nodes[0],r.domNode)))return d;for(var c=r.viewPool,f=void 0,u=0,v=c;u<v.length;u++){if((s=v[u]).nodes&&s.nodes.length&&s.attached&&(f=m(s,s.nodes[0],r.domNode)))return f}}return e(i,t.container)}return{position:"lastOnRoot",parentDomNd:t.rootDomNode,nextDomNd:t.anchorNode}}if(!n.nextSibling){var p=t.nodes[n.parentIdx];return"#element"===p.kind?{position:"lastChild",parentDomNd:De(t,n)}:e(t,p)}var h=m(t,n.nextSibling,De(t,n));if(h)return h;n=n.nextSibling}function m(e,t,n){if(!t)return null;if("#element"===t.kind||"#text"===t.kind)return{position:"beforeChild",nextDomNd:t.domNode,parentDomNd:n};if("#fragment"===t.kind){for(var i=void 0,o=t.firstChild;o;){if(i=m(e,o,n))return i;o=o.nextSibling}if(t.contentView){var r=t.contentView;if(r.nodes)return m(r,r.nodes[0],n)}return null}if("#container"===t.kind){var a=t;i=null;if("##block"===a.subKind)for(var s=a.views,d=s.length,l=0;d>l&&!(i=m(s[l],s[l].nodes[0],n));l++);else if("##cpt"===a.subKind){var c=a.template.view;i=m(c,c.nodes[0],n)}return i||null}throw new Error("TODO findFirstDomNd: "+t.kind)}}(e,t),i=n.position,o=n.nextDomNd,r=n.parentDomNd;return"beforeChild"===i||"lastOnRoot"===i?function(e,t){e.domNode?Ee(e.domNode,o,r):e.domNode=r}:"lastChild"===i?function(e,t){e.domNode?$e(e.domNode,r):e.domNode=r}:function(){console.warn("TODO: VALIDATE VIEW APPEND: ",i),function(e,t,n){void 0===t&&(t="");n&&e.uid!==n||(console.log(""),console.log(Se),t&&console.log(t+":"),function e(t,n){void 0===n&&(n="");if(!t.nodes)return void console.log(""+n+t.uid+" - no nodes");var i=t.parentView?t.parentView.uid:"XX",o=t.projectionHost,r=o?" >>> projection host: "+o.hostNode.uid+" in "+o.view.uid:"";console.log(n+"*"+t.uid+"* cm:"+t.cm+" isTemplate:"+(void 0!==t.template)+" parentView:"+i+r);for(var a,s=t.nodes.length,d="",l=0;s>l;l++)if(a=t.nodes[l])if(d=a.uid.length<5?["     ","    ","   ","  "," "][a.uid.length]:"","#container"===a.kind){var c=a,f=c.domNode?c.domNode.uid:"XX";if(console.log(n+"["+l+"] "+a.uid+d+" "+f+" attached:"+(a.attached?1:0)+" parent:"+C(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")),"##block"===c.subKind){var u=c,v=u.views.length;if(v)for(var p=0;v>p;p++)if(u.views[p]){var h=u.views[p];f=h.rootDomNode?h.rootDomNode.$uid:"XX",console.log(n+"  - view #"+p),e(u.views[p],"    "+n)}else console.log(n+"  - view #"+p+" UNDEFINED");else console.log(n+"  - no child views")}else if("##cpt"===c.subKind){var m=c,g=m.template,w=m.contentView;w?(console.log(n+"  - light DOM:"),e(w,"    "+n)):console.log(n+"  - light DOM: none"),g?(console.log(n+"  - shadow DOM:"),e(g.view,"    "+n)):console.log(n+"  - no template")}else console.log(n+"  - "+c.subKind+" container")}else{f=a.domNode?a.domNode.uid:"XX";var b="";if(a.domNode&&"#text"===a.kind)b=" text=#"+a.domNode._textContent+"#";else if("#fragment"===a.kind||"#element"===a.kind){for(var x=[],N=a.firstChild;N;)x.push(N.uid),N=N.nextSibling;b=" children:["+x.join(", ")+"]";var y=a.contentView;y&&(b+=" >>> content view: "+y.uid)}console.log(n+"["+a.idx+"] "+a.uid+d+" "+f+" attached:"+(a.attached?1:0)+" parent:"+C(a.parentIdx)+" nextSibling:"+(a.nextSibling?a.nextSibling.uid:"X")+b)}else console.log(n+"["+l+"] XX");function C(e){return e<0?"X":e}}(e))}(e,"getViewInsertFunction for "+t.uid)}}function ce(e,t,n){var i=e.nodes[t];if(i&&"##block"===i.subKind){var o=i,r=o.lastRefresh;if(n||r===e.lastRefresh){var a=o.views.length;if(!n){if(a!==o.previousNbrOfViews)for(var s=o.viewPool,d=s.length,l=void 0,c=0;d>c;c++)Ae(l=s[c],l.nodes[0]),l.attached=!1;o.previousNbrOfViews=a}}else Ae(e,o)}}function fe(e,t,n){if(!e.attached){if(t(e,!0),e.attached=!0,"#fragment"===e.kind)for(var i=e.firstChild;i;)fe(i,t),i=i.nextSibling;else if("#container"===e.kind){var o=e.subKind;if("##cpt"===o){var r=e.template,a=r?r.view.nodes[0]:null;r&&(r.forceRefresh=!0),a&&(fe(a,t),r.view.attached=!0)}else if("##block"===o)for(var s=e.views,d=0;s.length>d;d++)fe(s[d].nodes[0],t),s[d].attached=!0}if("#fragment"===e.kind||"#element"===e.kind){var l=e.contentView;l&&(fe(l.nodes[0],t),l.attached=!0)}}}function ue(e,t,n){if(n)for(var i=n.length,o=0;i>o;o++)ce(e,n[o],e.cm);e.cm&&(e.cm=!1,e.cmAppends=null)}function ve(e,t,n,i,o,r,a,s,d){if(t){var l=e.createElement(o);if(s)for(var c=s.length,f=0;c>f;f+=2)l.setAttribute(s[f],s[f+1]);if(d){c=d.length;for(var u=0;c>u;u+=2)l[d[u]]=d[u+1]}var v={kind:"#element",uid:"elt"+ ++M,idx:n,parentIdx:-1,ns:"",domNode:l,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=v,ie(e,l,a),e.cmAppends[i](v,!1),r&&(e.cmAppends[i+1]=function(e,t){e.domNode?$e(e.domNode,l):e.domNode=l,t||pe(v,e)})}else a&&ie(e,e.nodes[n].domNode,a)}function pe(e,t){e.firstChild?(e.lastChild.nextSibling=t,e.lastChild=t):(e.firstChild=e.lastChild=t,t.nextSibling=void 0),t.parentIdx=e.idx}function he(e,t,n,i,o,r,a,s){for(var d,l=[],c=8;c<arguments.length;c++)l[c-8]=arguments[c];if(s){var f=void 0,u=void 0,v=!1;f=t?a.slice(0):(d=e.nodes[i]).pieces;for(var p=0;s>p;p++)(u=ge(e,n,l[p]))!==ae&&(v=!0,f[1+2*p]=null==u?"":u);if(!t)return v&&(d.domNode.textContent=f.join("")),void ie(e,d.domNode,r);d=h(e.doc.createTextNode(f.join("")),f),ie(e,d.domNode,r)}else{if(!t)return void(r&&ie(e,e.nodes[i].domNode,r));d=h(e.doc.createTextNode(a),void 0),ie(e,d.domNode,r)}function h(e,t){return{kind:"#text",uid:"txt"+ ++M,domNode:e,attached:!0,idx:i,parentIdx:-1,pieces:t,nextSibling:void 0}}e.nodes[i]=d,e.cmAppends[o](d,!1)}function me(e,t,n){if(e.expressions){var i=e.expressions;if(i.length>t&&i[t]===n)return ae;i[t]=n}else e.expressions=[],e.expressions[t]=n;return n}function ge(e,t,n){if(t){if(n[2]){var i=e.oExpressions;return i[2*n[0]]?ae:(i[2*n[0]]=1,n[1])}return me(e,n[0],n[1])}return n}function we(e,t,n,i){if(t){var o={kind:"#fragment",uid:"fra"+ ++M,idx:n,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=o;var r=e.cmAppends[i];r(o,!1),e.cmAppends[i+1]=function(e,t){r(e,!0),t||pe(o,e)}}}function be(e,t,n,i,o){if(t){var r=function(e,t,n){var i;if(1===n)i={kind:"#container",subKind:"##block",uid:"cnb"+ ++M,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,views:[],viewPool:[],cmAppend:t,lastRefresh:0,previousNbrOfViews:0,insertFn:null};else{if(2!==n)return console.warn("TODO: new cnt type"),null;i={kind:"#container",subKind:"##cpt",uid:"cnc"+ ++M,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,cmAppend:t,cptRef:null,template:null,data:null,contentView:null,dynamicParams:void 0}}return i}(n,null,o);return e.nodes[n]=r,function(e,t,n){if(e.cmAppends){var i=e.cmAppends[n];i?(t.cmAppend=function(e,t){i(e,!0)},i(t,!1)):console.log("ERROR?",i===W)}}(e,r,i),r}}function xe(e,t,n,i,o,r,a,s,d,l){var c;n=n||0,t?c=e.nodes[i]||be(e,t,i,o,2):(c=e.nodes[i]).lists&&(c.lists.sizes={});var f=ge(e,n,r);if(c.template){if(f!==ae&&c.cptRef!==f){var u=c.data;c.template.dispose(!0),m();var v=c.data;for(var p in u)if(u.hasOwnProperty(p)&&p.match(B)){var h=RegExp.$1;g(v,h)&&(v[h]=u[h])}}}else{if(f===ae)return void L(e,"Invalid component ref");m()}function m(){var t=c.template=f();c.cptRef=f,oe(t.view,e,c),t.disconnectObserver(),c.data=t.api,function(t){if(d){var n=d.length;if(!t&&n)L(e,"Invalid parameter: "+d[0]);else for(var i=0;n>i;i+=2)g(t,d[i])?t[d[i]]=d[i+1]:L(e,"Invalid parameter: "+d[i])}}(t.api)}l&&(c.dynamicParams={}),0===n&&a&&Ne(e,i,c,s,l)}function Ne(e,t,n,i,o){var r=(n=n||e.nodes[t])?n.template:void 0;if(void 0!==r){if(r.view.lastRefresh=e.lastRefresh-1,function(e){if(e.lists)for(var t=e.lists,n=t.listNames,i=void 0,o=void 0,r=void 0,a=void 0,s=0;n.length>s;s++)i=n[s],o=t.sizes[i]||0,r=e.data[i],a=r.length,o<a&&r.splice(o,a-o)}(n),n.contentView){r.api.$content=n.contentView;var a=n.contentView.instructions;a&&a.length&&(r.forceRefresh=!0)}if(r.view.cm)r.view.cmAppends=[n.cmAppend];else{if(o)for(var s=o.length,d=(n?n.dynamicParams:{})||{},l=r.api,c=0;s>c;c++)d[o[c]]||y(l,o[c]);var f=r.view.nodes[0];if(!f.attached)r.forceRefresh=!0,fe(f,le(e,n))}i&&ie(e,r.api,i),r.render()}}function ye(e,t,n,i,o){if(o!==ae){var r=ge(e,t,o);if(r!==ae){var a=e.nodes[n].domNode;void 0===r?a.removeAttribute(i):a.setAttribute(i,r)}}}function Ce(e,t,n,i,o,r){if(r!==ae){var a=ge(e,n,r);if(a!==ae){var s=e.nodes[i],d=s.kind;if("#container"===d){var l=s.data;(function(e,t,n,i,o){if(i&&(!e.cm||g(i,o)))return!0;var r="";n.template&&(r=" on <*"+n.template.templateName+"/>");return L(e,"Invalid parameter '"+o+"'"+r),!1})(e,0,s,l,o)&&(l[o]=a)}else if("#param"===d)!function(e,t,n,i,o){if(0===o){if(n.dataHolder)return n.dataHolder[n.dataName]=i,n.dataHolder}else{if(n.data)return t&&!g(n.data,o)&&L(e,"Invalid param node parameter: "+o),n.data[o]=i,n.data;L(e,"Invalid param node parameter: "+o)}}(e,t,s,a,o);else if("#decorator"===d){var c=s;t&&!function(e,t,n){if(!g(t.api,n))return L(e,"Invalid decorator parameter '"+n+"' on "+t.refName),!1;return!0}(e,c,o)||(c.api[o]=a)}}}}function ke(e,t,n,i,o,r,a,s){if(t){var d=e.nodes[i];if("#element"===d.kind){var l=d.domNode;if(!l)return void L(e,"Cannot set "+o+" event listener: undefined DOM node");var c=v(l);a&&!1!==(s=s||{}).passive&&(s.passive=!0),l.addEventListener(o,(function(e){c.callback&&c.callback(e)}),s)}else if("#container"===d.kind){var f=d.template;f?u(f.api,!1):L(e,"Cannot set "+o+" event listener: undefined component template")}else"#param"===d.kind?u(d.data,!0):"#decorator"===d.kind&&u(d.api,!0)}else e.nodes[n].callback=r;function u(t,n){if(t&&g(t,o+"Emitter")){var i=t[o+"Emitter"];if(i.addListener&&"function"==typeof i.addListener){var r=v(null);i.addListener((function(e){r.callback&&r.callback(e)})),n&&"function"==typeof i.init&&i.init(o,t)}else L(e,"Invalid event emitter for: "+o)}else L(e,"Unsupported event: "+o)}function v(t){var o={kind:"#listener",uid:"evt"+ ++M,idx:n,parentIdx:i,nextSibling:void 0,domNode:t,attached:!0,callback:r};return e.nodes[n]=o,o}}function De(e,t){if(0===t.idx&&e.projectionHost){if(!t.attached)return null;var n=e.projectionHost.hostNode;return"#element"===n.kind?n.domNode:De(e.projectionHost.view,n)}return 0===t.idx?e.parentView?De(e.parentView,e.container):e.rootDomNode:e.nodes[t.parentIdx].domNode}function Ae(e,t){if(t&&t.attached)if("#text"===t.kind||"#element"===t.kind){var n=De(e,t);t.attached=!1,n?n.removeChild(t.domNode):L(e,"Internal error - parent not found for: "+t.uid)}else if("#container"===t.kind){if("##block"===t.subKind){for(var i=t,o=i.views,r=o.length,a=void 0,s=0;r>s;s++)a=o[s].nodes[0],Ae(o[s],a),o[s].attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0);i.views=[],i.previousNbrOfViews=0,i.viewPool=o.concat(i.viewPool)}else if("##cpt"===t.subKind){var d=t.template;a=d.view.nodes[0];Ae(d.view,a),d.view.attached=a.attached=!1,"#container"!==a.kind&&"#fragment"!==a.kind||(a.domNode=void 0)}}else if("#fragment"===t.kind){var l=t;if(l.attached=!1,l.contentView)Ae(l.contentView,l.contentView.nodes[0]);else if(l.firstChild)for(var c=l.firstChild;c;)Ae(e,c),c=c.nextSibling;l.domNode=void 0}else"#param"===t.kind?console.warn("TODO removeFromDom for param nodes"):console.warn("RemoveFromDom for "+t.kind)}var Ie=function(e){var t=e.prototype;t[n]=!0,t[i]=0},Ve=function(e,t){return e||(e=P,t=3),function(n,i){var a="ΔΔ"+i,s=n[o];s||(s=n[o]={}),s[i]=t?1===t?P:$:e,n[a]=void 0,function(e,t,n,i){i&&delete e[t]&&Object.defineProperty(e,t,i)}(n,i,0,{get:function(){return function(e,t,n,i,o){e.ΔComputeDependencies&&(e.ΔComputeDependencies[n]=!0);!c&&e[l]&&C(e,e[l]);var r=e[t];(void 0===r||c&&null===r)&&(r=e[t]=!c&&o?o>1?void 0:null:i(),S(e,r));return r}(this,a,i,e,t)},set:function(t){!function(e,t,n,i,o,a){var s=w(i),d=o===E;if(e.ΔComputeDependencies)return void console.error("[Trax] @computed properties must not mutate the Data object when calculated");i&&!s&&o.ΔCreateProxy&&(i=o.ΔCreateProxy(i)||i,s=w(i));var l=!1,c=a[n];b(e)?l=c!==i:c!==i&&(!function e(t){if(!w(t))return;var n=!0;b(t)?n=!1:t.ΔChangeVersion+=1;if(z.register(t),n){var i=t.ΔMd;i&&i.parents&&v(i.parents,(function(t){e(t)}))}}(e),l=!0);l&&(s&&void 0===i&&(i=null),(s||c&&w(c))&&function(e,t,n,i){(function(e,t){if(t){var n=t.ΔMd;n&&n.parents&&(n.parents=p(n.parents,e))}})(e,t),i||S(e,n)}(e,c,i,d),a[n]=i,function(e,t,n,i,o){var a=e?e.ΔMd:void 0;if(a&&a.trackers){var s=e[r]||e;v(a.trackers,(function(e){e(s,t,n,i,o)}))}}(e,"set",t,c,i))}(this,i,a,t,e,this)},enumerable:!0,configurable:!0})}},Re=A,Oe=O,Pe=V;function je(e,t){return!0===e.prototype[t]}function $e(e,t,n){t.appendChild(e)}function Ee(e,t,n,i){n.insertBefore(e,t)}var Se="-------------------------------------------------------------------------------";var Fe,Te,Xe,ze,Ke=(Fe={},Te=["size",25],Xe=[1,2],ze=function(){function n(){}return e([Ve(Pe),t("design:type",Number)],n.prototype,"x",void 0),e([Ve(Pe),t("design:type",Number)],n.prototype,"y",void 0),e([Ve(Pe),t("design:type",Number)],n.prototype,"size",void 0),e([Ve(Pe),t("design:type",Number)],n.prototype,"seconds",void 0),n=e([Ie],n)}(),re("triangle",".../triangles/triangles.ts",Fe,(function(e,t,n){var i,o,r,a,s=n.x,d=n.y,l=n.size,c=n.seconds,f=0,u=0,v=se(e,0,3);if(we(e,v,0,0),be(e,v,1,1,1),be(e,v,2,1,1),l<=25)xe(i=de(e,0,1,1,++f),o=i.cm,0,0,0,me(i,0,Me),0,0,Te),Ce(i,o,0,0,"x",me(i,1,s-12.5)),Ce(i,o,0,0,"y",me(i,2,d-12.5)),Ce(i,o,0,0,"text",me(i,3,c)),Ne(i,0),ue(i);else{we(r=de(e,0,2,4,++u),a=r.cm,0,0);var p=l/2,h=p/2;xe(r,a,0,1,1,me(r,0,Ke),0),Ce(r,a,0,1,"x",me(r,1,s)),Ce(r,a,0,1,"y",me(r,2,d-h)),Ce(r,a,0,1,"size",me(r,3,p)),Ce(r,a,0,1,"seconds",me(r,4,c)),Ne(r,1),xe(r,a,0,2,1,me(r,5,Ke),0),Ce(r,a,0,2,"x",me(r,6,s-p)),Ce(r,a,0,2,"y",me(r,7,d+h)),Ce(r,a,0,2,"size",me(r,8,p)),Ce(r,a,0,2,"seconds",me(r,9,c)),Ne(r,2),xe(r,a,0,3,1,me(r,10,Ke),0),Ce(r,a,0,3,"x",me(r,11,s+p)),Ce(r,a,0,3,"y",me(r,12,d+h)),Ce(r,a,0,3,"size",me(r,13,p)),Ce(r,a,0,3,"seconds",me(r,14,c)),Ne(r,3),ue(r)}ue(e,0,Xe)}),ze)),Me=function(){var n={},i=["class","dot"],o=[" **","","** "],r=[" ",""," "],a=[3,4],s=function(){function n(){}return e([Ve(Pe),t("design:type",Number)],n.prototype,"x",void 0),e([Ve(Pe),t("design:type",Number)],n.prototype,"y",void 0),e([Ve(Pe),t("design:type",Number)],n.prototype,"size",void 0),e([Ve(Re),t("design:type",String)],n.prototype,"text",void 0),e([Ve(Oe),t("design:type",Boolean)],n.prototype,"hover",void 0),n=e([Ie],n)}();return re("dot",".../triangles/triangles.ts",n,(function(e,t,n){var s,d,l=n.x,c=n.y,f=n.size,u=n.text,v=n.hover,p=0,h=0,m=se(e,0,5);ve(e,m,0,0,"div",1,0,i),ye(e,0,0,"style",me(e,0,function(e,t,n,i){void 0===i&&(i=!1);var o=1.3*n;return"background-color:"+(i?"#ff0":"#61dafb")+";position:absolute;font:normal 15px sans-serif;text-align:center;cursor:pointer;        width:"+o+"px;height:"+o+"px;left:"+e+"px;top:"+t+"px;border-radius:"+o/2+"px;line-height:"+o+"px;"}(l,c,f,v))),ke(e,m,1,0,"mouseenter",(function(e){return t.hover=!0})),ke(e,m,2,0,"mouseleave",(function(e){return t.hover=!1})),be(e,m,3,1,1),be(e,m,4,1,1),v?(he(s=de(e,0,3,1,++p),s.cm,0,0,0,0,o,1,me(s,0,u)),ue(s)):(he(d=de(e,0,4,1,++h),d.cm,0,0,0,0,r,1,me(d,0,u)),ue(d)),ue(e,0,a)}),s)}();var He,Le,We=function(){var n={},i=["href","https://stencil-fiber-demo.firebaseapp.com"],o=["id","main"],r=["x",0,"y",0],a=function(){function n(){}return e([Ve(),t("design:type",Object)],n.prototype,"seconds",void 0),e([Ve(),t("design:type",Object)],n.prototype,"elapsed",void 0),n=e([Ie],n)}();return re("page",".../triangles/triangles.ts",n,(function(e,t,n){var a=n.seconds,s=n.elapsed,d=se(e,0,15);we(e,d,0,0),he(e,d,0,1,1,0," This page demonstrates 3 types of parallel updates: ",0),ve(e,d,2,1,"ul",1),ve(e,d,3,2,"li",1),he(e,d,0,4,3,0," a general scale transformation applied on the main triangle every animation frame ",0),ve(e,d,5,2,"li",1),he(e,d,0,6,3,0," text node updates every second (the number in the blue dots) ",0),ve(e,d,7,2,"li",1),he(e,d,0,8,3,0," text node update on user input (you need to hover one of the blue dots) ",0),ve(e,d,9,1,"i",1),he(e,d,0,10,2,0," code derived from the ",0),ve(e,d,11,2,"a",1,0,i),he(e,d,0,12,3,0," stencil fiber demo ",0),ve(e,d,13,1,"div",1,0,o),ye(e,0,13,"style",me(e,0,function(e){var t=e/1e3%10;return"position:absolute;transform-original:0 0;left:50%;top:50%;width:10px;height:10px;    background:#eee;transform:scaleX("+(1+(t>5?10-t:t)/10)/2.1+") scaleY(0.7) translateZ(0.1px)"}(s))),xe(e,d,0,14,2,me(e,1,Ke),0,0,r),Ce(e,d,0,14,"size",me(e,2,1e3)),Ce(e,d,0,14,"seconds",me(e,3,a)),Ne(e,14),ue(e)}),a)}();He=Date.now(),Le=We().attach(document.getElementById("main")),requestAnimationFrame((function e(){var t=Date.now()-He,n=Math.floor(t/1e3)%10+1;Le.render({seconds:n,elapsed:t}),requestAnimationFrame(e)}))}();
