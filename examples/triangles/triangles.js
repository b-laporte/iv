!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function e(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function t(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var n="ΔTrackable",i="ΔChangeVersion",o="ΔDefFactories",r="ΔIsFactory",s="ΔΔProxy",a="ΔIsProxy",d="ΔDefault",l="ΔCreateProxy",c="ΔnewItem",f="Δdispose",u="Δjson",v=!1;function h(e){return e&&e.ΔTrackable?e.ΔMd?e.ΔMd:e.ΔMd={parents:void 0,refreshCtxt:void 0,watchers:void 0}:null}var p=Array.isArray;function m(e,t){e&&(p(e)&&!e[a]?e.forEach(t):t(e))}function g(e,t){if(e&&t){if(e===t)return;if(p(e)){var n=e;if(1===n.length){if(n[0]===t)return}else{var i=n.indexOf(t);if(i>-1)return n.splice(i,1),1===n.length?n[0]:n}}}return e}function w(e,t){return e?p(e)&&!e[a]?(e.push(t),e):[e,t]:t}function b(e){return e&&!0===e[n]?e[i]:0}function y(e,t){if(void 0===t&&(t=!1),C(e)){e[f]?e[f](t):x(e,(function(n,i){L(e,i),e["ΔΔ"+n]=void 0,t&&y(i,!0)}));var n=e.ΔMd;if(n){var i=[];m(n.parents,(function(e){i.push(e)}));for(var o=function(t){x(t,(function(n,i){i===e&&(L(t,e),t["ΔΔ"+n]=void 0)})),H(t)},r=0,s=i;r<s.length;r++){o(s[r])}}}}function x(e,t){if(C(e)){var n=e.constructor.prototype["ΔDefFactories"];for(var i in n)n.hasOwnProperty(i)&&t(i,e["ΔΔ"+i],n[i])}}function N(e,t){return!(!e||"object"!=typeof e)&&"ΔΔ"+t in e}function C(e){return!(!e||!0!==e[n])}function D(e){return b(e)%2==1}function k(e,t){var n=h(e);return n&&t?(n.watchers=w(n.watchers,t),D(e)&&B.register(e),t):null}function I(e,t){var n=e?e.ΔMd:void 0;n&&t&&(n.watchers=g(n.watchers,t))}function P(e,t){if(e&&t){var n=e[d];if(n){var i=n(t);if(i!==j)return e[t]=i}var r=e[o],s=r?r[t]:null;if(s)return e[t]=s()}}var A=function(){var e,t,n=[],i=[],o={getDefaultConversion:function(){return r(e,o)},getPreviousConversion:function(){return e.ΔtoJsResult}};function r(e,n){var i=n.getPreviousConversion();if(i)return i;var o=void 0;if(e.Δconvert)o=e.Δconvert(t);else{if(e["Δjson"])return e["Δjson"];o={},x(e,(function(e,n){C(n)&&(n=s(n,t)),void 0!==n&&(o[e]=n)}))}return o}function s(s,a){var d=0===n.length,l=s;if(s&&C(s)&&(n.push(s),l=void 0,i.push(s),e=s,a?(t=a,l=a(s,o)):l=r(s,o),s.ΔtoJsResult=l,i.pop(),e=i[i.length-1]),d){for(var c=n.length;c--;)n[c]["ΔtoJsResult"]=void 0;e=null,n=[],t=void 0}return l}return s}();function O(e,t){var n,i;t&&x(e,(function(o,r,s){var a=s===X;if(n=t[o],i="ΔΔ"+o,void 0===n)a&&(e[i]=void 0);else{var d=typeof n;if(null===n)(a||s===z)&&(e[i]=null);else if("object"===d){var l=function(e,t){if(e&&void 0!==t){if(e[c])return e[c](t);v=!0;var n=e[t];return v=!1,n}}(e,o);l?l[u]=n:a&&(e[i]=n)}else"string"===d?(a||s===V)&&(e[i]=n):"number"===d?(a||s===S)&&(e[i]=n):"boolean"===d?(a||s===F)&&(e[i]=n):a&&(e[i]=n)}}));e[u]=void 0}var j={};function R(){return""}R[r]=!0;var V=R;function $(){return 0}$[r]=!0;var S=$;function E(){return!1}E[r]=!0;var F=E;function T(){return null}T[r]=!0;var z=T;function M(){}M[r]=!0;var X=M;function K(e,t,n,i,o,r){var a=C(i),d=o===X;if(!e.ΔComputeDependencies){i&&!a&&o.ΔCreateProxy&&(a=C(i=o.ΔCreateProxy(i)||i));var l=!1,c=r[n];return D(e)?l=c!==i:c!==i&&(H(e),l=!0),l&&(a&&void 0===i&&(i=null),(a||c&&C(c))&&function(e,t,n,i){L(e,t),i||W(e,n)}(e,c,i,d),r[n]=i,function(e,t,n,i,o){var r=e?e.ΔMd:void 0;if(r&&r.trackers){var a=e[s]||e;m(r.trackers,(function(e){e(a,t,n,i,o)}))}}(e,"set",t,c,i)),i}console.error("[Trax] @computed properties must not mutate the Data object when calculated")}function H(e){if(C(e)){var t=!0;if(D(e)?t=!1:e.ΔChangeVersion+=1,B.register(e),t){var n=e.ΔMd;n&&n.parents&&m(n.parents,(function(e){H(e)}))}}}function L(e,t){if(t){var n=t.ΔMd;n&&n.parents&&(n.parents=g(n.parents,e))}}function W(e,t){if(t){var n=h(t);n&&(n.parents=w(n.parents,e))}}var J=0,q=function(){function e(){this.id=++J}return e.prototype.register=function(e){var t=this,n=h(e);n&&!n.refreshCtxt&&(this.objects?this.objects.push(e):(this.objects=[e],Promise.resolve().then((function(){t.refresh()}))),n.refreshCtxt=this)},e.prototype.refresh=function(e){void 0===e&&(e=!0);var t=this.objects,n=t?t.length:0;if(n){U();for(var i,o,r=[],s=0;n>s;s++)(o=(i=t[s]).ΔMd).refreshCtxt&&(i.ΔChangeVersion%2&&(i.ΔChangeVersion+=1),o.refreshCtxt&&o.watchers&&r.push({dataNode:i,watchers:o.watchers})),o.refreshCtxt=void 0;this.objects=void 0,r.length&&(e?_(r):Promise.resolve().then((function(){_(r)})))}},e}();function _(e){for(var t=function(e){m(e.watchers,(function(t){t(e.dataNode)}))},n=0,i=e;n<i.length;n++){t(i[n])}}var B=new q;function U(){B.objects&&(B=new q)}var Y=/^\Δ/,Z=function(){function e(e){this.ΔTrackable=!0,this.ΔDataFactory=!0,this.ΔChangeVersion=0,this.ΔMd=void 0,this.ΔΔSelf=this,this.ΔIsProxy=!1,this.ΔItemFactory=e}return e.ΔNewProxy=function(t){var n=new Proxy({},new e(t));return n[s]=n,n},e.ΔCreateProxy=function(t,n){if("object"==typeof t){var i=new Proxy(t,new e(n));for(var o in H(i),t)t.hasOwnProperty(o)&&W(i,t[o]);return i}return null},e.prototype.ΔnewItem=function(e){var t=this.ΔItemFactory();return K(this.ΔΔSelf,e,e,t,this.ΔItemFactory,this.ΔΔDict)},e.prototype.Δdispose=function(e){void 0===e&&(e=!1);var t,n=this.ΔΔDict;for(var i in n)n.hasOwnProperty(i)&&(t=n[i],L(this.ΔΔSelf,t),n[i]=void 0,e&&y(t,!0));return n},e.prototype.Δconvert=function(e){var t={},n=this.ΔΔDict;for(var i in n)n.hasOwnProperty(i)&&(t[i]=A(n[i],e));return t},e.prototype.ΔinitFromJson=function(){var e=this["Δjson"];if(e){if(e.constructor!==Object)console.error("[Trax] Invalid json type: Dictionaries can only be initialized from Objects");else{var t=this.ΔΔDict,n=void 0,i=void 0;for(var o in e)if(e.hasOwnProperty(o))if(i=n=e[o],n){var r=this.ΔItemFactory();C(r)&&(r["Δjson"]=n,i=r),t[o]=i}else null===n&&(t[o]=null)}this["Δjson"]=void 0}},e.prototype.ΔToString=function(){return"Trax Dict {...}"},e.prototype.set=function(e,t,n){return this.ΔΔDict||(this.ΔΔDict=e),t.match(Y)?this[t]=n:K(this.ΔΔSelf,t,t,n,this.ΔItemFactory,this.ΔΔDict),!0},e.prototype.get=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),t===a||(this["Δjson"]&&this.ΔinitFromJson(),t===Symbol.iterator?this.ΔΔDict[Symbol.iterator]:"string"===typeof t?t.match(Y)?this[t]:this.ΔΔDict[t]:this[t])},e.prototype.deleteProperty=function(e,t){return this.ΔΔDict||(this.ΔΔDict=e),!t.match(Y)&&(K(this.ΔΔSelf,t,t,null,this.ΔItemFactory,this.ΔΔDict),delete this.ΔΔDict[t],!0)},e}();function G(e){function t(){return Z.ΔNewProxy(e)}return e=e||z,t[r]=!0,t[l]=function(t){return Z.ΔCreateProxy(t,e)},t}var Q=0,ee={log:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,arguments)},error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,arguments)}};function te(e,t){for(var n=e,i=[];n;){if(n.template){var o=n.template;i.push('\n>> Template: "'+o.templateName+'" - File: "'+o.filePath+'"')}n=n.parentView}ee.error("IVY: "+t+i.join(""))}var ne=void 0,ie=11,oe=/^ΔΔ(\w+)Emitter$/,re=/^ΔΔ(.+)$/,se="ΔIsAPI",ae="ΔIsController",de=0,le=function(){function e(e,t,n,i,o,r){this.templateName=e,this.filePath=t,this.staticCache=n,this.renderFn=i,this.$Class=o,this.$contextIdentifiers=r,this.kind="$template",this._uid=++de,this.tplApi=void 0,this.tplCtl=void 0,this.forceRefresh=!1,this.activeWatch=!1,this.lastRefreshVersion=0,this.processing=!1,this.rendering=!1,this.initialized=!1,this.labels=void 0,this.hasCtlClass=!1,this.$contextInitialized=!1,this.view=he(null,null,1,this);var s=this;this.watchCb=function(){s.notifyChange()},this.watchCb.$templateId=this._uid,this.$Class!==ne&&(We(this.$Class,ae)?this.hasCtlClass=!0:We(this.$Class,se)||C(this.$Class.prototype)||te(this.view,"Type of $ argument must be either a @Controller, an @API or a @Data class"))}return e.prototype.dispose=function(e){void 0===e&&(e=!0);var t=this.view;this.disconnectObserver(),fe(t,this.tplCtl,"$dispose",this.templateName),e&&t&&t.nodes&&t.nodes.length&&(ze(t,t.nodes[0]),t.anchorNode&&(t.rootDomNode.removeChild(t.anchorNode),t.anchorNode=null))},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.view.doc},set:function(e){this.view.doc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){if(!this.tplApi)if(this.hasCtlClass){var e=this.controller;e&&e.$api&&(this.tplApi=e.$api)}else this.$Class?(this.tplApi=new this.$Class,ce(this.view,this.tplApi,this.staticCache)):this.$contextIdentifiers?this.tplApi=function(e){return void 0!==e?(t[r]=!0,G(t)()):G()();function t(){return new e}}():this.tplApi={};return this.tplApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){if(!this.tplCtl&&this.hasCtlClass){var e=this.tplCtl=new this.$Class;if(N(e,"$template")&&(e.$template=this),N(e,"$logger")){var t=this.view;e.$logger={log:ee.log,error:function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];te(t,e+(n.length?" "+n.join(" "):""))}}}e.$api&&ce(this.view,e.$api,this.staticCache)}return this.tplCtl},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){if(this.view.rootDomNode)te(this.view,"Template host cannot be changed once set");else{var t=this.view;if(!t.doc)throw new Error("[iv] Template.document must be defined before calling Template.attach()");t.rootDomNode=e,t.anchorNode=t.doc.createComment("template anchor"),Je(t.anchorNode,e)}return this},e.prototype.registerLabel=function(e,t){this.labels||(this.labels={});var n=this.labels[e];n?n.push(t):n=this.labels[e]=[t]},e.prototype.query=function(e,t){if(void 0===t&&(t=!1),this.rendering)return null;for(var n=[],i=0,o=e.split(";");i<o.length;i++){var r=o[i];if(r&&"#"!==r.charAt(0))return te(this.view,"[$template.query()] Invalid label argument: '"+r+"' (labels must start with #)"),null;var s=this.labels&&this.labels[r]||null;if(s&&s.length){if(!t)return s[0];n=n.concat(s)}}return n.length?n:null},e.prototype.notifyChange=function(){this.render()},e.prototype.disconnectObserver=function(){this.activeWatch&&(I(this.api,this.watchCb),I(this.controller,this.watchCb),this.activeWatch=!1)},e.prototype.render=function(e,t){if(void 0===t&&(t=!1),this.processing)return this;t&&(this.forceRefresh=!0),this.processing=!0;var n=this.api,i=this.controller,o=this.view,r=this.$contextIdentifiers;i&&!C(i)&&(te(o,"Template controller must be a @Controller Object - please check: "+this.$Class.name),this.tplCtl=this.$Class=void 0);var s=!1;if(n&&e)if(r!==ne){var a=e.context;a!==ne&&"object"==typeof a&&(s=!0)}else for(var d in D(n)||U(),this.disconnectObserver(),e)e.hasOwnProperty(d)&&(n[d]=e[d]);if(this.$contextInitialized&&(s=!0),s){var l="",c=(e?e.context:null)||n.$context;if(c){for(var f=0;r.length>f;f++)n[l=r[f]]=c[l];n.$context=c,this.$contextInitialized=!0}}r===ne||this.$contextInitialized||te(o,"Missing $fragment context");var u=!this.forceRefresh,v=o.nodes;if(v&&v[0]&&v[0].attached||(u=!1),u&&b(n)+b(i)>this.lastRefreshVersion&&(u=!1),!u){i&&(this.initialized||(fe(o,i,"$init","controller"),this.initialized=!0),fe(o,i,"$beforeRender","controller")),this.rendering=!0,this.labels=void 0,o.lastRefresh++,o.instructions=void 0;try{this.renderFn(o,this.hasCtlClass?i:n,n,this)}catch(e){te(o,"Template execution error\n"+(e.message||e))}this.rendering=!1,i&&fe(o,i,"$afterRender","controller"),function(e,t){if(void 0===t&&(t=!1),e){var n=e.ΔMd;n&&n.refreshCtxt?n.refreshCtxt.refresh(!0):t&&U()}}(n),this.forceRefresh=!1,this.lastRefreshVersion=b(n)+b(i)}return this.activeWatch||(k(n,this.watchCb),i&&k(i,this.watchCb),this.activeWatch=!0),this.processing=!1,this},e}();function ce(e,t,n){var i=n.events;if(void 0===i){var o=void 0;for(var r in t)if(r.match(oe)){var s=RegExp.$1;o||(o=[]),"function"!=typeof t[s+"Emitter"].init?te(e,"Invalid EventEmitter: "+s+"Emitter"):(o.push(s+"Emitter"),o.push(s),t[s+"Emitter"].init(s,t))}n.events=o||null}else if(null!==i)for(var a=i.length,d=0;a>d;d+=2)t[i[d]].init(i[d+1],t)}function fe(e,t,n,i){if(t&&"function"==typeof t[n]){var o=void 0;try{void 0!==(o=t[n]())&&"function"==typeof o.catch&&o.catch((function(t){te(e,i+" "+n+" hook execution error\n"+(t.message||t))}))}catch(t){te(e,i+" "+n+" hook execution error\n"+(t.message||t))}}}function ue(e,t){return(t=t||this.namespace)?this.doc.createElementNS(t,e):this.doc.createElement(e)}function ve(){return function(e){if(e!==ne&&null!==e){var t=!0;return function e(t,n,i){if(t!==ne&&null!==t){if(!i(t))return!1;if(null!==t.nodes&&t.nodes.length)for(var o=0,r=t.nodes;o<r.length;o++){if(!s(r[o]))return!1}}return!0;function s(t){var o=t.kind;if("#fragment"===o)return!!i(t)&&e(t.contentView,n,i);if("#container"!==o)return i(t);if(!i(t))return!1;var r=t,s=r.subKind;if("##block"===s){var a=r.views;if(null!==a)for(var d=0,l=a;d<l.length;d++){var c=l[d];if(!e(c,n,i))return!1}if(n&&r.viewPool)for(var f=0,u=r.viewPool;f<u.length;f++){var v=u[f];if(!e(v,n,i))return!1}}else if("##cpt"===s){var h=r.template;if(null!==h)return e(h.view,n,i)}else"##async"===s&&console.log("TODO: support scanNode for @async block");return!0}}(e,!1,(function(e){if(!t)return!1;var n=e.kind;if("#view"===n){var i=e;if(i.cm){var o=i.doc.createDocumentFragment();i.domNode=o,i.cmAppends=[function(e){e.domNode?Je(e.domNode,o):e.domNode=o}]}!function(e){if(e.instructions){var t=e.instructions.slice(0),n=t.length;if(e.instructions.splice(0,n),e.instructions=void 0,n)for(var i=0;n>i;i+=2)t[i].apply(null,t[i+1])}}(i)}else if("#element"===n||"#text"===n)return t=!1;return!0})),t}return!0}(this)}function he(e,t,n,i){var o={kind:"#view",uid:"view"+ ++Q,attached:!1,nodes:null,namespace:void 0,namespaces:void 0,doc:null,parentView:e,cm:!0,cmAppends:null,lastRefresh:0,container:null,projectionHost:null,template:i,rootDomNode:null,anchorNode:null,expressions:void 0,oExpressions:void 0,instructions:void 0,paramNode:void 0,createElement:ue,isEmpty:ve};return e?me(o,e,t):o.doc="undefined"!=typeof document?document:null,o}function pe(e,t,n){if(n){var i=function(e){var t=e;for(;t&&!t.template;)t=t.parentView;return t}(e);if(i!==ne&&null!==i)for(var o=i.template,r=n.length,s=0;r>s;s++)o.registerLabel(n[s],t)}}function me(e,t,n){if(e.parentView=t,e.doc=t.doc,e.container=n,e.rootDomNode=t.rootDomNode,t.namespace){var i=t.namespace;e.namespace=i,e.namespaces=[i]}}function ge(e,t,n,i,o,r){return function(){return new le(e,t,n,i,o,r)}}var we=[];function be(e,t,n){var i=e.cm;return i?(e.nodes=new Array(n),e.cmAppends||(e.cmAppends=[],e.anchorNode&&(e.cmAppends[0]=function(t,n){t.domNode?qe(t.domNode,e.anchorNode,e.rootDomNode):t.domNode=e.rootDomNode}))):e.cmAppends=null,i}function ye(e,t,n,i,o){var r,s=e.nodes[n];if(s&&s.attached||te(e,"Invalid ζview call: container must be attached ("+(s?s.uid:"XX")+") - pview: "+e.uid+" containerIdx: "+n),"#container"===s.kind)if("##block"===s.subKind){var a=(d=s).views;1===o&&(d.insertFn=null),1===o&&d.views.length>1?(d.previousNbrOfViews=a.length,r=a.shift(),d.viewPool.length?d.viewPool=a.concat(d.viewPool):d.viewPool=a,d.views=[r]):(r=d.views[o-1])||(d.viewPool.length>0?(d.insertFn||(d.insertFn=xe(e,d)),Ce((r=a[o-1]=d.viewPool.shift()).nodes[0],d.insertFn),r.attached=!0):((r=a[o-1]=he(e,d)).nodes=new Array(i),e.cm&&d.cmAppend?r.cmAppends=[d.cmAppend]:e.cm||(r.cmAppends=[xe(e,d)]))),d.lastRefresh=r.lastRefresh=e.lastRefresh}else{var d;(r=(d=s).contentView)||((r=d.contentView=he(e,d)).nodes=new Array(i)),r.lastRefresh=e.lastRefresh}else if("#param"===s.kind){var l=s;(r=l.contentView)||(r=l.contentView=he(e,null),l.viewPool&&(l.viewPool[l.viewInstanceIdx]=r),r.nodes=new Array(i),r.paramNode=l),r.lastRefresh=e.lastRefresh}return r}function xe(e,t){var n=function e(t,n){for(;;){if(n||te(t,"Internal error - findNextSiblingDomNd: nd cannot be undefined"),0===n.idx){if(!n.attached)return{position:"defer",parentDomNd:void 0};if(n.domNode.nodeType===ie)return{position:"lastChild",parentDomNd:n.domNode};var i=t.parentView;if(i){if(t.projectionHost){var o=t.projectionHost.hostNode;return"#element"===o.kind?{position:"lastChild",parentDomNd:o.domNode}:e(t.projectionHost.view,o)}if(t.container&&"##block"===t.container.subKind){var r=t.container,s=r.views.indexOf(t);if(s>-1)for(var a=void 0,d=void 0,l=s+1;l<r.views.length;l++)if((a=r.views[l]).nodes&&a.nodes.length&&(d=m(a,a.nodes[0],r.domNode)))return d;for(var c=r.viewPool,f=void 0,u=0,v=c;u<v.length;u++){if((a=v[u]).nodes&&a.nodes.length&&a.attached&&(f=m(a,a.nodes[0],r.domNode)))return f}}return e(i,t.container)}return{position:"lastOnRoot",parentDomNd:t.rootDomNode,nextDomNd:t.anchorNode}}if(!n.nextSibling){var h=t.nodes[n.parentIdx];return"#element"===h.kind?{position:"lastChild",parentDomNd:Te(t,n)}:e(t,h)}var p=m(t,n.nextSibling,Te(t,n));if(p)return p;n=n.nextSibling}function m(e,t,n){if(!t)return null;if("#element"===t.kind||"#text"===t.kind)return{position:"beforeChild",nextDomNd:t.domNode,parentDomNd:n};if("#fragment"===t.kind){for(var i=void 0,o=t.firstChild;o;){if(i=m(e,o,n))return i;o=o.nextSibling}if(t.contentView){var r=t.contentView;if(r.nodes)return m(r,r.nodes[0],n)}return null}if("#container"===t.kind){var s=t;i=null;if("##block"===s.subKind)for(var a=s.views,d=a.length,l=0;d>l&&!(i=m(a[l],a[l].nodes[0],n));l++);else if("##cpt"===s.subKind){var c=s.template.view;i=m(c,c.nodes[0],n)}return i||null}throw new Error("TODO findFirstDomNd: "+t.kind)}}(e,t),i=n.position,o=n.nextDomNd,r=n.parentDomNd;return"beforeChild"===i||"lastOnRoot"===i?function(e,t){e.domNode?qe(e.domNode,o,r):e.domNode=r}:"lastChild"===i?function(e,t){e.domNode?Je(e.domNode,r):e.domNode=r}:function(){console.warn("TODO: VALIDATE VIEW APPEND: ",i),function(e,t,n){void 0===t&&(t="");n&&e.uid!==n||(console.log(""),console.log(_e),t&&console.log(t+":"),function e(t,n){void 0===n&&(n="");if(!t.nodes)return void console.log(""+n+t.uid+" - no nodes");var i=t.parentView?t.parentView.uid:"XX",o=t.projectionHost,r=o?" >>> projection host: "+o.hostNode.uid+" in "+o.view.uid:"";console.log(n+"*"+t.uid+"* cm:"+t.cm+" isTemplate:"+(void 0!==t.template)+" parentView:"+i+r);for(var s,a=t.nodes.length,d="",l=0;a>l;l++)if(s=t.nodes[l])if(d=s.uid.length<5?["     ","    ","   ","  "," "][s.uid.length]:"","#container"===s.kind){var c=s,f=c.domNode?c.domNode.uid:"XX";if(console.log(n+"["+l+"] "+s.uid+d+" "+f+" attached:"+(s.attached?1:0)+" parent:"+C(s.parentIdx)+" nextSibling:"+(s.nextSibling?s.nextSibling.uid:"X")),"##block"===c.subKind){var u=c,v=u.views.length;if(v)for(var h=0;v>h;h++)if(u.views[h]){var p=u.views[h];f=p.rootDomNode?p.rootDomNode.$uid:"XX",console.log(n+"  - view #"+h),e(u.views[h],"    "+n)}else console.log(n+"  - view #"+h+" UNDEFINED");else console.log(n+"  - no child views")}else if("##cpt"===c.subKind){var m=c,g=m.template,w=m.contentView;w?(console.log(n+"  - light DOM:"),e(w,"    "+n)):console.log(n+"  - light DOM: none"),g?(console.log(n+"  - shadow DOM:"),e(g.view,"    "+n)):console.log(n+"  - no template")}else console.log(n+"  - "+c.subKind+" container")}else{f=s.domNode?s.domNode.uid:"XX";var b="";if(s.domNode&&"#text"===s.kind)b=" text=#"+s.domNode._textContent+"#";else if("#fragment"===s.kind||"#element"===s.kind){for(var y=[],x=s.firstChild;x;)y.push(x.uid),x=x.nextSibling;b=" children:["+y.join(", ")+"]";var N=s.contentView;N&&(b+=" >>> content view: "+N.uid)}console.log(n+"["+s.idx+"] "+s.uid+d+" "+f+" attached:"+(s.attached?1:0)+" parent:"+C(s.parentIdx)+" nextSibling:"+(s.nextSibling?s.nextSibling.uid:"X")+b)}else console.log(n+"["+l+"] XX");function C(e){return e<0?"X":e}}(e))}(e,"getViewInsertFunction for "+t.uid)}}function Ne(e,t,n){var i=e.nodes[t];if(i&&"##block"===i.subKind){var o=i,r=o.lastRefresh;if(n||r===e.lastRefresh){var s=o.views.length;if(!n){if(s!==o.previousNbrOfViews)for(var a=o.viewPool,d=a.length,l=void 0,c=0;d>c;c++)ze(l=a[c],l.nodes[0]),l.attached=!1;o.previousNbrOfViews=s}}else ze(e,o)}}function Ce(e,t,n){if(!e.attached){if(t(e,!0),e.attached=!0,"#fragment"===e.kind)for(var i=e.firstChild;i;)Ce(i,t),i=i.nextSibling;else if("#container"===e.kind){var o=e.subKind;if("##cpt"===o){var r=e.template,s=r?r.view.nodes[0]:null;r&&(r.forceRefresh=!0),s&&(Ce(s,t),r.view.attached=!0)}else if("##block"===o)for(var a=e.views,d=0;a.length>d;d++)Ce(a[d].nodes[0],t),a[d].attached=!0}if("#fragment"===e.kind||"#element"===e.kind){var l=e.contentView;l&&(Ce(l.nodes[0],t),l.attached=!0)}}}function De(e,t,n){if(n)for(var i=n.length,o=0;i>o;o++)Ne(e,n[o],e.cm);e.cm&&(e.cm=!1,e.cmAppends=null)}function ke(e,t,n,i,o,r,s,a,d){if(t){var l=e.createElement(o);if(a)for(var c=a.length,f=0;c>f;f+=2)l.setAttribute(a[f],a[f+1]);if(d){c=d.length;for(var u=0;c>u;u+=2)l[d[u]]=d[u+1]}var v={kind:"#element",uid:"elt"+ ++Q,idx:n,parentIdx:-1,ns:"",domNode:l,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=v,pe(e,l,s),e.cmAppends[i](v,!1),r&&(e.cmAppends[i+1]=function(e,t){e.domNode?Je(e.domNode,l):e.domNode=l,t||Ie(v,e)})}else s&&pe(e,e.nodes[n].domNode,s)}function Ie(e,t){e.firstChild?(e.lastChild.nextSibling=t,e.lastChild=t):(e.firstChild=e.lastChild=t,t.nextSibling=void 0),t.parentIdx=e.idx}function Pe(e,t,n,i,o,r,s,a){for(var d,l=[],c=8;c<arguments.length;c++)l[c-8]=arguments[c];if(a){var f=void 0,u=void 0,v=!1;f=t?s.slice(0):(d=e.nodes[i]).pieces;for(var h=0;a>h;h++)(u=Oe(e,n,l[h]))!==we&&(v=!0,f[1+2*h]=null==u?"":u);if(!t)return v&&(d.domNode.textContent=f.join("")),void pe(e,d.domNode,r);d=p(e.doc.createTextNode(f.join("")),f),pe(e,d.domNode,r)}else{if(!t)return void(r&&pe(e,e.nodes[i].domNode,r));d=p(e.doc.createTextNode(s),void 0),pe(e,d.domNode,r)}function p(e,t){return{kind:"#text",uid:"txt"+ ++Q,domNode:e,attached:!0,idx:i,parentIdx:-1,pieces:t,nextSibling:void 0}}e.nodes[i]=d,e.cmAppends[o](d,!1)}function Ae(e,t,n){if(e.expressions){var i=e.expressions;if(i.length>t&&i[t]===n)return we;i[t]=n}else e.expressions=[],e.expressions[t]=n;return n}function Oe(e,t,n){if(t){if(n[2]){var i=e.oExpressions;return i[2*n[0]]?we:(i[2*n[0]]=1,n[1])}return Ae(e,n[0],n[1])}return n}function je(e,t,n,i){if(t){var o={kind:"#fragment",uid:"fra"+ ++Q,idx:n,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,firstChild:void 0,lastChild:void 0,contentView:null};e.nodes[n]=o;var r=e.cmAppends[i];r(o,!1),e.cmAppends[i+1]=function(e,t){r(e,!0),t||Ie(o,e)}}}function Re(e,t,n,i,o){if(t){var r=function(e,t,n){var i;if(1===n)i={kind:"#container",subKind:"##block",uid:"cnb"+ ++Q,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,views:[],viewPool:[],cmAppend:t,lastRefresh:0,previousNbrOfViews:0,insertFn:null};else{if(2!==n)return console.warn("TODO: new cnt type"),null;i={kind:"#container",subKind:"##cpt",uid:"cnc"+ ++Q,idx:e,parentIdx:-1,ns:"",domNode:void 0,attached:!0,nextSibling:void 0,cmAppend:t,cptRef:null,template:null,data:null,contentView:null,dynamicParams:void 0}}return i}(n,null,o);return e.nodes[n]=r,function(e,t,n){if(e.cmAppends){var i=e.cmAppends[n];i?(t.cmAppend=function(e,t){i(e,!0)},i(t,!1)):console.log("ERROR?",i===ne)}}(e,r,i),r}}function Ve(e,t,n,i,o,r,s,a,d,l){var c;n=n||0,t?c=e.nodes[i]||Re(e,t,i,o,2):(c=e.nodes[i]).lists&&(c.lists.sizes={});var f=Oe(e,n,r);if(c.template){if(f!==we&&c.cptRef!==f){var u=c.data;c.template.dispose(!0),m();var v=c.data;for(var h in u)if(u.hasOwnProperty(h)&&h.match(re)){var p=RegExp.$1;N(v,p)&&(v[p]=u[p])}}}else{if(f===we)return void te(e,"Invalid component ref");m()}function m(){var t=c.template=f();c.cptRef=f,me(t.view,e,c),t.disconnectObserver(),c.data=t.api,function(t){if(d){var n=d.length;if(!t&&n)te(e,"Invalid parameter: "+d[0]);else for(var i=0;n>i;i+=2)N(t,d[i])?t[d[i]]=d[i+1]:te(e,"Invalid parameter: "+d[i])}}(t.api)}l&&(c.dynamicParams={}),0===n&&s&&$e(e,i,c,a,l)}function $e(e,t,n,i,o){var r=(n=n||e.nodes[t])?n.template:void 0;if(void 0!==r){if(r.view.lastRefresh=e.lastRefresh-1,function(e){if(e.lists)for(var t=e.lists,n=t.listNames,i=void 0,o=void 0,r=void 0,s=void 0,a=0;n.length>a;a++)i=n[a],o=t.sizes[i]||0,r=e.data[i],s=r.length,o<s&&r.splice(o,s-o)}(n),n.contentView){r.api.$content=n.contentView;var s=n.contentView.instructions;s&&s.length&&(r.forceRefresh=!0)}if(r.view.cm)r.view.cmAppends=[n.cmAppend];else{if(o)for(var a=o.length,d=(n?n.dynamicParams:{})||{},l=r.api,c=0;a>c;c++)d[o[c]]||P(l,o[c]);var f=r.view.nodes[0];if(!f.attached)r.forceRefresh=!0,Ce(f,xe(e,n))}i&&pe(e,r.api,i),r.render()}}function Se(e,t,n,i,o){if(o!==we){var r=Oe(e,t,o);if(r!==we){var s=e.nodes[n].domNode;void 0===r?s.removeAttribute(i):s.setAttribute(i,r)}}}function Ee(e,t,n,i,o,r){if(r!==we){var s=Oe(e,n,r);if(s!==we){var a=e.nodes[i],d=a.kind;if("#container"===d){var l=a.data;(function(e,t,n,i,o){if(i&&(!e.cm||N(i,o)))return!0;var r="";n.template&&(r=" on <*"+n.template.templateName+"/>");return te(e,"Invalid parameter '"+o+"'"+r),!1})(e,0,a,l,o)&&(l[o]=s)}else if("#param"===d)!function(e,t,n,i,o){if(0===o){if(n.dataHolder)return n.dataHolder[n.dataName]=i,n.dataHolder}else{if(n.data)return t&&!N(n.data,o)&&te(e,"Invalid param node parameter: "+o),n.data[o]=i,n.data;te(e,"Invalid param node parameter: "+o)}}(e,t,a,s,o);else if("#decorator"===d){var c=a;t&&!function(e,t,n){if(!N(t.api,n))return te(e,"Invalid decorator parameter '"+n+"' on "+t.refName),!1;return!0}(e,c,o)||(c.api[o]=s)}}}}function Fe(e,t,n,i,o,r,s,a){if(t){var d=e.nodes[i];if("#element"===d.kind){var l=d.domNode;if(!l)return void te(e,"Cannot set "+o+" event listener: undefined DOM node");var c=v(l);s&&!1!==(a=a||{}).passive&&(a.passive=!0),l.addEventListener(o,(function(e){c.callback&&c.callback(e)}),a)}else if("#container"===d.kind){var f=d.template;f?u(f.api,!1):te(e,"Cannot set "+o+" event listener: undefined component template")}else"#param"===d.kind?u(d.data,!0):"#decorator"===d.kind&&u(d.api,!0)}else e.nodes[n].callback=r;function u(t,n){if(t&&N(t,o+"Emitter")){var i=t[o+"Emitter"];if(i.addListener&&"function"==typeof i.addListener){var r=v(null);i.addListener((function(e){r.callback&&r.callback(e)})),n&&"function"==typeof i.init&&i.init(o,t)}else te(e,"Invalid event emitter for: "+o)}else te(e,"Unsupported event: "+o)}function v(t){var o={kind:"#listener",uid:"evt"+ ++Q,idx:n,parentIdx:i,nextSibling:void 0,domNode:t,attached:!0,callback:r};return e.nodes[n]=o,o}}function Te(e,t){if(0===t.idx&&e.projectionHost){if(!t.attached)return null;var n=e.projectionHost.hostNode;return"#element"===n.kind?n.domNode:Te(e.projectionHost.view,n)}return 0===t.idx?e.parentView?Te(e.parentView,e.container):e.rootDomNode:e.nodes[t.parentIdx].domNode}function ze(e,t){if(t&&t.attached)if("#text"===t.kind||"#element"===t.kind){var n=Te(e,t);t.attached=!1,n?n.removeChild(t.domNode):te(e,"Internal error - parent not found for: "+t.uid)}else if("#container"===t.kind){if("##block"===t.subKind){for(var i=t,o=i.views,r=o.length,s=void 0,a=0;r>a;a++)s=o[a].nodes[0],ze(o[a],s),o[a].attached=s.attached=!1,"#container"!==s.kind&&"#fragment"!==s.kind||(s.domNode=void 0);i.views=[],i.previousNbrOfViews=0,i.viewPool=o.concat(i.viewPool)}else if("##cpt"===t.subKind){var d=t.template;s=d.view.nodes[0];ze(d.view,s),d.view.attached=s.attached=!1,"#container"!==s.kind&&"#fragment"!==s.kind||(s.domNode=void 0)}}else if("#fragment"===t.kind){var l=t;if(l.attached=!1,l.contentView)ze(l.contentView,l.contentView.nodes[0]);else if(l.firstChild)for(var c=l.firstChild;c;)ze(e,c),c=c.nextSibling;l.domNode=void 0}else"#param"===t.kind?console.warn("TODO removeFromDom for param nodes"):console.warn("RemoveFromDom for "+t.kind)}var Me=function(e){var t=e.prototype;t[n]=!0,t[i]=0},Xe=function(e,t){return e||(e=T,t=3),function(n,i){var r="ΔΔ"+i,s=n[o];s||(s=n[o]={}),s[i]=t?1===t?T:M:e,n[r]=void 0,function(e,t,n,i){i&&delete e[t]&&Object.defineProperty(e,t,i)}(n,i,0,{get:function(){return function(e,t,n,i,o){e.ΔComputeDependencies&&(e.ΔComputeDependencies[n]=!0);!v&&e[u]&&O(e,e[u]);var r=e[t];(void 0===r||v&&null===r)&&(r=e[t]=!v&&o?o>1?void 0:null:i(),W(e,r));return r}(this,r,i,e,t)},set:function(t){K(this,i,r,t,e,this)},enumerable:!0,configurable:!0})}},Ke=V,He=F,Le=S;function We(e,t){return!0===e.prototype[t]}function Je(e,t,n){t.appendChild(e)}function qe(e,t,n,i){n.insertBefore(e,t)}var _e="-------------------------------------------------------------------------------";var Be,Ue,Ye,Ze,Ge=(Be={},Ue=["size",25],Ye=[1,2],Ze=function(){function n(){}return e([Xe(Le),t("design:type",Number)],n.prototype,"x",void 0),e([Xe(Le),t("design:type",Number)],n.prototype,"y",void 0),e([Xe(Le),t("design:type",Number)],n.prototype,"size",void 0),e([Xe(Le),t("design:type",Number)],n.prototype,"seconds",void 0),n=e([Me],n)}(),ge("triangle",".../triangles/triangles.ts",Be,(function(e,t,n){var i,o,r,s,a=n.x,d=n.y,l=n.size,c=n.seconds,f=0,u=0,v=be(e,0,3);if(je(e,v,0,0),Re(e,v,1,1,1),Re(e,v,2,1,1),l<=25)Ve(i=ye(e,0,1,1,++f),o=i.cm,0,0,0,Ae(i,0,Qe),0,0,Ue),Ee(i,o,0,0,"x",Ae(i,1,a-12.5)),Ee(i,o,0,0,"y",Ae(i,2,d-12.5)),Ee(i,o,0,0,"text",Ae(i,3,c)),$e(i,0),De(i);else{je(r=ye(e,0,2,4,++u),s=r.cm,0,0);var h=l/2,p=h/2;Ve(r,s,0,1,1,Ae(r,0,Ge),0),Ee(r,s,0,1,"x",Ae(r,1,a)),Ee(r,s,0,1,"y",Ae(r,2,d-p)),Ee(r,s,0,1,"size",Ae(r,3,h)),Ee(r,s,0,1,"seconds",Ae(r,4,c)),$e(r,1),Ve(r,s,0,2,1,Ae(r,5,Ge),0),Ee(r,s,0,2,"x",Ae(r,6,a-h)),Ee(r,s,0,2,"y",Ae(r,7,d+p)),Ee(r,s,0,2,"size",Ae(r,8,h)),Ee(r,s,0,2,"seconds",Ae(r,9,c)),$e(r,2),Ve(r,s,0,3,1,Ae(r,10,Ge),0),Ee(r,s,0,3,"x",Ae(r,11,a+h)),Ee(r,s,0,3,"y",Ae(r,12,d+p)),Ee(r,s,0,3,"size",Ae(r,13,h)),Ee(r,s,0,3,"seconds",Ae(r,14,c)),$e(r,3),De(r)}De(e,0,Ye)}),Ze)),Qe=function(){var n={},i=["class","dot"],o=[" **","","** "],r=[" ",""," "],s=[3,4],a=function(){function n(){}return e([Xe(Le),t("design:type",Number)],n.prototype,"x",void 0),e([Xe(Le),t("design:type",Number)],n.prototype,"y",void 0),e([Xe(Le),t("design:type",Number)],n.prototype,"size",void 0),e([Xe(Ke),t("design:type",String)],n.prototype,"text",void 0),e([Xe(He),t("design:type",Boolean)],n.prototype,"hover",void 0),n=e([Me],n)}();return ge("dot",".../triangles/triangles.ts",n,(function(e,t,n){var a,d,l=n.x,c=n.y,f=n.size,u=n.text,v=n.hover,h=0,p=0,m=be(e,0,5);ke(e,m,0,0,"div",1,0,i),Se(e,0,0,"style",Ae(e,0,function(e,t,n,i){void 0===i&&(i=!1);var o=1.3*n;return"background-color:"+(i?"#ff0":"#61dafb")+";position:absolute;font:normal 15px sans-serif;text-align:center;cursor:pointer;        width:"+o+"px;height:"+o+"px;left:"+e+"px;top:"+t+"px;border-radius:"+o/2+"px;line-height:"+o+"px;"}(l,c,f,v))),Fe(e,m,1,0,"mouseenter",(function(e){return t.hover=!0})),Fe(e,m,2,0,"mouseleave",(function(e){return t.hover=!1})),Re(e,m,3,1,1),Re(e,m,4,1,1),v?(Pe(a=ye(e,0,3,1,++h),a.cm,0,0,0,0,o,1,Ae(a,0,u)),De(a)):(Pe(d=ye(e,0,4,1,++p),d.cm,0,0,0,0,r,1,Ae(d,0,u)),De(d)),De(e,0,s)}),a)}();var et,tt,nt=function(){var n={},i=["href","https://stencil-fiber-demo.firebaseapp.com"],o=["id","main"],r=["x",0,"y",0],s=function(){function n(){}return e([Xe(),t("design:type",Object)],n.prototype,"seconds",void 0),e([Xe(),t("design:type",Object)],n.prototype,"elapsed",void 0),n=e([Me],n)}();return ge("page",".../triangles/triangles.ts",n,(function(e,t,n){var s=n.seconds,a=n.elapsed,d=be(e,0,15);je(e,d,0,0),Pe(e,d,0,1,1,0," This page demonstrates 3 types of parallel updates: ",0),ke(e,d,2,1,"ul",1),ke(e,d,3,2,"li",1),Pe(e,d,0,4,3,0," a general scale transformation applied on the main triangle every animation frame ",0),ke(e,d,5,2,"li",1),Pe(e,d,0,6,3,0," text node updates every second (the number in the blue dots) ",0),ke(e,d,7,2,"li",1),Pe(e,d,0,8,3,0," text node update on user input (you need to hover one of the blue dots) ",0),ke(e,d,9,1,"i",1),Pe(e,d,0,10,2,0," code derived from the ",0),ke(e,d,11,2,"a",1,0,i),Pe(e,d,0,12,3,0," stencil fiber demo ",0),ke(e,d,13,1,"div",1,0,o),Se(e,0,13,"style",Ae(e,0,function(e){var t=e/1e3%10;return"position:absolute;transform-original:0 0;left:50%;top:50%;width:10px;height:10px;    background:#eee;transform:scaleX("+(1+(t>5?10-t:t)/10)/2.1+") scaleY(0.7) translateZ(0.1px)"}(a))),Ve(e,d,0,14,2,Ae(e,1,Ge),0,0,r),Ee(e,d,0,14,"size",Ae(e,2,1e3)),Ee(e,d,0,14,"seconds",Ae(e,3,s)),$e(e,14),De(e)}),s)}();et=Date.now(),tt=nt().attach(document.getElementById("main")),requestAnimationFrame((function e(){var t=Date.now()-et,n=Math.floor(t/1e3)%10+1;tt.render({seconds:n,elapsed:t}),requestAnimationFrame(e)}))}();
